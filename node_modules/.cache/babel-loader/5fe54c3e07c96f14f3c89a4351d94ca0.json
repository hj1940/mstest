{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\19065019\\\\react-test\\\\src\\\\components\\\\App\\\\index.js\";\nimport React, { Component } from 'react';\nimport './index.css';\nimport ItemListing from '../ItemListing';\nimport EquippedItems from '../EquippedItems';\nimport _ from 'lodash';\nimport CharacterList from '../CharacterList';\nimport 'react-notifications/lib/notifications.css';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport RenderCanvas from '../RenderCanvas';\nimport axios from 'axios';\nimport VirtualizedSelect from 'react-virtualized-select';\nimport createFilterOptions from 'react-select-fast-filter-options';\nimport Slider from 'rc-slider';\nimport RcTooltip from 'rc-tooltip';\nimport { SketchPicker } from 'react-color';\nimport Localization from '../../const/localize';\nimport Localize from '../../const/localize';\nimport { Tooltip } from 'react-tippy';\nimport FontAwesome from 'react-fontawesome';\nimport 'rc-slider/assets/index.css';\nimport 'rc-tooltip/assets/bootstrap.css';\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle';\nimport Sidebar from \"react-sidebar\";\nconst mql = window.matchMedia(`(min-width: 800px)`);\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS';\n  localStorage['version'] = '328';\n  localStorage['initialized'] = '2';\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr';else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp';else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch';else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl';else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br';else localStorage['language'] = 'en';\n}\n\nvar creatingId = null;\n\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, {\n  leading: true\n});\n\nlet mapsIndexed = null;\nlet versions = {\n  GMS: [{\n    region: \"GMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  KMS: [{\n    region: \"KMS\",\n    MapleVersionId: \"328\",\n    IsReady: true\n  }],\n  TMS: [{\n    region: \"TMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  CMS: [{\n    region: \"CMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  JMS: [{\n    region: \"JMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  SEA: [{\n    region: \"SEA\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }]\n};\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value;\n\n  if (o instanceof Array) {\n    return o.map(function (value) {\n      if (typeof value === \"object\") {\n        value = toCamel(value);\n      }\n\n      return value;\n    });\n  } else {\n    newO = {};\n\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString();\n        value = o[origKey];\n\n        if (value instanceof Array || value !== null && value.constructor === Object) {\n          value = toCamel(value);\n        }\n\n        newO[newKey] = value;\n      }\n    }\n  }\n\n  return newO;\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`).then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return _objectSpread({}, wzEntry, {\n      region: wzEntry.region\n    });\n  });\n\n  versions = _.groupBy(WZs, 'region');\n  let region = localStorage['region'],\n      version = localStorage['version'];\n\n  if (!region || version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1) {\n    localStorage['region'] = 'KMS';\n    localStorage['version'] = '328';\n    window.location.reload();\n  }\n\n  console.log(versions);\n  return versions;\n});\nlet maps = [];\nlet mapsFilter = null;\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n  maps = _.map(response.data, map => {\n    return {\n      label: [map.streetName, map.name].join(' - '),\n      value: map.id\n    };\n  });\n  mapsFilter = createFilterOptions({\n    options: maps\n  });\n});\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    let isOpen = (localStorage || {})['hideModal'] !== 'true';\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined') isOpen = true; // Try to recover any existing state\n\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {\n        x: 0,\n        y: 0\n      },\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\n        \"hsl\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"l\": 0,\n          \"a\": 0\n        },\n        \"hex\": \"transparent\",\n        \"rgb\": {\n          \"r\": 0,\n          \"g\": 0,\n          \"b\": 0,\n          \"a\": 0\n        },\n        \"hsv\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"v\": 0,\n          \"a\": 0\n        },\n        \"oldHue\": 0,\n        \"source\": \"rgb\"\n      },\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarDocked: mql.matches,\n      sidebarOpen: false,\n      versions\n    };\n    if (versions.KMS.length > 1) this.state.versions = versions;else wzPromise.then(ver => this.setState({\n      versions\n    }));\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex; // If we have a legacy character, upgrade to latest now\n\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      };\n      if (this.state.characters[0] === false) this.state.characters[0] = currentCharacter;else this.state.characters.push(currentCharacter);\n    } // If we have no characters at all, gen a new shell\n\n\n    if (this.state.characters[0] === false) this.state.characters[0] = this.getNewCharacter();\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter']);\n      delete localStorage['currentCharacter'];\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state]);\n      this.state['characters'] = [...this.state.characters, this.state];\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1);\n      character.type = 'character';\n      character.action = character.action || 'stand1';\n      character.frame = character.frame || 0;\n      character.zoom = character.zoom || 1;\n      character.emotion = character.emotion || 'default';\n      character.skin = character.skin || 2000;\n      character.mercEars = character.mercEars || false;\n      character.illiumEars = character.illiumEars || false;\n      character.selectedItems = character.selectedItems || [];\n      character.visible = character.visible || false;\n      character.position = character.position || {\n        x: 0,\n        y: 0\n      };\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground;\n\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region'];\n        if (!item.version) item.version = localStorage['version'];\n        return item;\n      });\n\n      character.selectedItems = _.keyBy(characterItems, item => item.typeInfo.subCategory);\n      delete character.characters;\n      delete character.otherCharacters;\n      delete character.allCharacters;\n    });\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1);\n      pet.type = 'pet';\n      pet.position = pet.position || {\n        x: 0,\n        y: 0\n      };\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`;\n    });\n    if (this.state.selectedIndex + 1 > this.state.characters.length + this.state.pets.length || !this.state.characters.length) this.state.selectedIndex = false;\n    document.addEventListener(\"click\", this.handleClick.bind(this));\n    if (maps.length) this.state.mapsLoaded = true;else mapPromise.then(() => setTimeout(() => this.setState({\n      mapsLoaded: true\n    }), 250));\n    this.mediaQueryChanged = this.mediaQueryChanged.bind(this);\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n  }\n\n  componentWillMount() {\n    mql.addListener(this.mediaQueryChanged);\n  }\n\n  componentWillUnmount() {\n    mql.removeListener(this.mediaQueryChanged);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({\n      sidebarOpen: open\n    });\n  }\n\n  mediaQueryChanged() {\n    this.setState({\n      sidebarDocked: mql.matches,\n      sidebarOpen: false\n    });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region;\n    localStorage['version'] = version; // Much easier than trying to reload everything here :D\n\n    window.location.reload();\n  }\n\n  handleClick(e) {\n    let element = e.target;\n    let found = false;\n\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;else {\n        found = true;\n        console.log('found bg-color-picker-container');\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({\n      colorPickerOpen: false\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          characters = _this$state.characters,\n          pets = _this$state.pets,\n          selectedIndex = _this$state.selectedIndex,\n          isModalOpen = _this$state.isModalOpen,\n          zoom = _this$state.zoom,\n          summary = _this$state.summary,\n          selectedMap = _this$state.selectedMap,\n          focusRenderable = _this$state.focusRenderable,\n          backgroundColor = _this$state.backgroundColor,\n          colorPickerOpen = _this$state.colorPickerOpen,\n          language = _this$state.language,\n          music = _this$state.music;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    const renderables = characters.concat(pets);\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, selectedIndex !== false ? React.createElement(Sidebar, {\n      sidebar: React.createElement(ItemListing, {\n        target: renderables[selectedIndex],\n        onItemSelected: this.userSelectedItem.bind(this),\n        localized: localized,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }),\n      open: this.state.sidebarOpen,\n      docked: this.state.sidebarDocked,\n      onSetOpen: this.onSetSidebarOpen,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }) : '', React.createElement(RenderCanvas, {\n      backgroundColor: bgColorText,\n      zoom: zoom,\n      mapId: selectedMap,\n      renderables: renderables,\n      selectedRenderable: selectedIndex,\n      focusRenderable: focusRenderable === undefined ? selectedIndex : focusRenderable,\n      onUpdateRenderable: this.updateRenderable.bind(this),\n      onClick: this.clickCanvas.bind(this),\n      localized: localized,\n      onClickRenderable: this.userUpdateSelectedRenderable.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }), React.createElement(CharacterList, {\n      renderables: renderables,\n      selectedIndex: selectedIndex,\n      onAddCharacter: this.addCharacter.bind(this),\n      onAddPet: this.addPet.bind(this),\n      onImportCharacter: this.importCharacter.bind(this),\n      onDeleteCharacter: this.removeCharacter.bind(this),\n      onCloneCharacter: this.cloneCharacter.bind(this),\n      onDeletePet: this.removePet.bind(this),\n      localized: localized,\n      onUpdateSelectedCharacter: function (renderable) {\n        this.userUpdateSelectedRenderable(renderable, () => {\n          this.setState({\n            focusRenderable: this.state.selectedIndex\n          });\n        });\n      }.bind(this),\n      onUpdateCharacter: this.userUpdateCharacter.bind(this),\n      onUpdatePet: this.userUpdatePet.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }), selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ? React.createElement(EquippedItems, {\n      equippedItems: renderables[selectedIndex].selectedItems,\n      onRemoveItem: this.userRemovedItem.bind(this),\n      name: renderables[selectedIndex].name,\n      skinId: renderables[selectedIndex].skin,\n      onUpdateItem: this.updateItem.bind(this),\n      localized: localized,\n      onRemoveItems: this.userRemovedItems.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }) : '', React.createElement(\"div\", {\n      className: \"disclaimer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, localized.prototype)), React.createElement(NotificationContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    }), music ? React.createElement(\"audio\", {\n      src: `//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`,\n      autoPlay: true,\n      loop: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }) : '');\n  }\n\n  renderSettings() {\n    const _this$state2 = this.state,\n          characters = _this$state2.characters,\n          pets = _this$state2.pets,\n          selectedIndex = _this$state2.selectedIndex,\n          isModalOpen = _this$state2.isModalOpen,\n          zoom = _this$state2.zoom,\n          summary = _this$state2.summary,\n          selectedMap = _this$state2.selectedMap,\n          focusRenderable = _this$state2.focusRenderable,\n          backgroundColor = _this$state2.backgroundColor,\n          colorPickerOpen = _this$state2.colorPickerOpen,\n          language = _this$state2.language;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    return React.createElement(\"div\", {\n      className: \"settings-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"bg-color-picker-container\",\n      onClick: this.openColorPicker.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, \"Background color\", React.createElement(\"div\", {\n      className: \"bg-color-picker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"bg-color-grid\",\n      style: {\n        backgroundColor: bgColorText\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372\n      },\n      __self: this\n    })), colorPickerOpen ? React.createElement(SketchPicker, {\n      color: bgColorText,\n      onChange: this.onChangeColor.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    }) : ''), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377\n      },\n      __self: this\n    }, localized.zoom), React.createElement(Slider, {\n      value: zoom || 1,\n      min: 0.25,\n      max: 2,\n      step: 0.25,\n      handle: handle,\n      onChange: this.changeZoom.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, localized.language), React.createElement(\"select\", {\n      value: this.state.language,\n      onChange: this.changeLanguage.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"en\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 389\n      },\n      __self: this\n    }, \"English\"), React.createElement(\"option\", {\n      value: \"jp\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390\n      },\n      __self: this\n    }, \"Japanese\"), React.createElement(\"option\", {\n      value: \"kr\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391\n      },\n      __self: this\n    }, \"Korean\"), React.createElement(\"option\", {\n      value: \"ch\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    }, \"Chinese (Traditional)\"), React.createElement(\"option\", {\n      value: \"nl\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    }, \"Dutch\"), React.createElement(\"option\", {\n      value: \"br\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }, \"Portuguese (Brazil)\"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"map-select-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398\n      },\n      __self: this\n    }, React.createElement(VirtualizedSelect, {\n      filterOptions: mapsFilter,\n      isLoading: maps.length === 0,\n      name: \"map-selection\",\n      searchable: true,\n      clearable: true,\n      simpleValue: true,\n      value: selectedMap,\n      onChange: this.selectMap.bind(this),\n      options: maps,\n      maxHeight: 400,\n      styles: {\n        menuList: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        },\n        menu: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399\n      },\n      __self: this\n    }))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428\n      },\n      __self: this\n    }, localized.region), React.createElement(\"select\", {\n      value: this.state.region,\n      onChange: e => this.changeRegionVersion(e.target.value, \"328\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429\n      },\n      __self: this\n    }, _.keys(this.state.versions).map(versionName => React.createElement(\"option\", {\n      value: versionName,\n      key: versionName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430\n      },\n      __self: this\n    }, versionName)))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434\n      },\n      __self: this\n    }, localized.version), React.createElement(\"select\", {\n      value: this.state.version,\n      onChange: e => this.changeRegionVersion(this.state.region, e.target.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435\n      },\n      __self: this\n    }, this.state.versions[this.state.region].map(({\n      mapleVersionId\n    }) => React.createElement(\"option\", {\n      value: mapleVersionId,\n      key: mapleVersionId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436\n      },\n      __self: this\n    }, mapleVersionId)), React.createElement(\"option\", {\n      value: \"328\",\n      key: \"328\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437\n      },\n      __self: this\n    }, \"328\"))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441\n      },\n      __self: this\n    }, localized.playMusic), React.createElement(Toggle, {\n      onChange: this.toggleMusic.bind(this),\n      checked: this.state.music,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 446\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      onClick: this.exportAllCharacters.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447\n      },\n      __self: this\n    }, \"Export All Characters\")));\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    });\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a');\n      a.style = 'display: none;';\n      document.body.appendChild(a);\n      const payload = JSON.stringify(character, null, 2),\n            blob = new Blob([payload], {\n        type: 'octet/stream'\n      }),\n            url = window.URL.createObjectURL(blob);\n      a.href = url;\n      if (character.name) a.download = character.name + '-data.json';else a.download = 'character-data.json';\n      a.click();\n      window.URL.revokeObjectURL(url);\n      a.remove();\n    });\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    });\n    localStorage['language'] = e.target.value;\n  }\n\n  changeZoom(newZoom) {\n    this.setState({\n      zoom: newZoom\n    });\n    localStorage['zoom'] = newZoom;\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    });\n    localStorage['selectedMap'] = mapId;\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps);\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps);\n  }\n\n  clickCanvas(e) {\n    if (e.target === e.currentTarget && this.state.characters.length + this.state.pets.length > 1) {\n      this.setState({\n        selectedIndex: false\n      });\n      localStorage['selectedIndex'] = 'false';\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()];\n    this.setState({\n      pets,\n      selectedIndex: this.state.characters.length + this.state.pets.length\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet);\n    this.setState({\n      pets,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any pet in case we delete the last pet\n\n    localStorage['pets'] = JSON.stringify(pets);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005];\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)];\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: {\n        x: 0,\n        y: 0\n      }\n    };\n  }\n\n  importCharacter(e) {\n    let target = e.target;\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase();\n\n        if (extension != 'json') {\n          console.warn('Not valid JSON file');\n          return;\n        }\n\n        let reader = new FileReader();\n\n        reader.onload = function (ev) {\n          let payload = ev.target.result;\n          let data = JSON.parse(payload);\n          res();\n          if (!data.id || data.type != 'character' || !data.selectedItems) return;\n          data.id = Date.now();\n          let characters = [...this.state.characters, data];\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          });\n          localStorage['characters'] = JSON.stringify(characters);\n        }.bind(this);\n\n        reader.readAsText(file, 'UTF8');\n      });\n    });\n    Promise.all(importAll).then(() => {\n      target.value = '';\n    });\n  }\n\n  addCharacter() {\n    var characters = [...this.state.characters, this.getNewCharacter()];\n    this.setState({\n      characters,\n      selectedIndex: this.state.characters.length\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character);\n    this.setState({\n      characters,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any character in case we delete the last character\n\n    localStorage['characters'] = JSON.stringify(characters);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  cloneCharacter(character) {\n    let characters = [...this.state.characters];\n    let indexOfCharacter = characters.indexOf(character);\n    characters.splice(indexOfCharacter + 1, 0, _objectSpread({}, character, {\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    }));\n    let newCharacterIndex = indexOfCharacter + 1;\n    this.setState({\n      characters,\n      selectedIndex: newCharacterIndex,\n      focusRenderable: newCharacterIndex + 1\n    });\n    localStorage['selectedIndex'] = newCharacterIndex;\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable);\n\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable);\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length;\n    }\n\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback);\n    localStorage['selectedIndex'] = selectedIndex;\n    localStorage['zoom'] = 1;\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const pets = [...this.state.pets];\n    const petIndex = pets.indexOf(pet);\n\n    const currentPet = pets[petIndex] = _objectSpread({}, pet, {}, newProps);\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`;\n    this.setState({\n      pets: pets\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const characters = [...this.state.characters];\n    const characterIndex = characters.indexOf(character);\n\n    const currentCharacter = characters[characterIndex] = _objectSpread({}, character, {}, newProps);\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n      var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id;\n      if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n      return itemEntry;\n    });\n\n    const backgroundColor = this.state.backgroundColor;\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    this.setState({\n      characters: characters\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {\n        x: 0,\n        y: 0\n      },\n      fhSnap: true\n    };\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex + 1 > this.state.characters.length) this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props);else this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props);\n  }\n\n  setModalOpen(isModalOpen) {\n    this.setState({\n      isModalOpen\n    });\n  }\n\n  userSelectedItem(item) {\n    let selectedRenderable = null;\n    if (this.state.selectedIndex + 1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length];else selectedRenderable = this.state.characters[this.state.selectedIndex];\n    item.region = localStorage['region'];\n    item.version = localStorage['version'];\n\n    let selectedItems = _objectSpread({}, selectedRenderable.selectedItems);\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top'];\n        delete selectedItems['Bottom'];\n      }\n    }\n\n    if (item.similar) {\n      item = _objectSpread({}, item);\n      delete item['similar'];\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item;\n    }\n\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItem(item) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    delete selectedItems[item.typeInfo.subCategory];\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems() {\n    let selectedItems = {};\n    this.updateItems(selectedItems);\n  }\n\n  updateItem(item, newProps) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    selectedItems[item.typeInfo.subCategory] = _objectSpread({}, item, {}, newProps);\n    this.updateItems(selectedItems);\n  }\n\n  updateItems(selectedItems) {\n    console.log('New Items: ', selectedItems);\n    this.updateSelectedRenderable({\n      selectedItems\n    });\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id;\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n        return itemEntry;\n      });\n\n      return _objectSpread({}, character);\n    });\n    this.setState({\n      backgroundColor,\n      characters\n    });\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor);\n  }\n\n  openColorPicker() {\n    this.setState({\n      colorPickerOpen: true\n    });\n  }\n\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = props => {\n  const value = props.value,\n        dragging = props.dragging,\n        index = props.index,\n        restProps = _objectWithoutProperties(props, [\"value\", \"dragging\", \"index\"]);\n\n  return React.createElement(RcTooltip, {\n    prefixCls: \"rc-slider-tooltip\",\n    overlay: value,\n    visible: dragging,\n    placement: \"top\",\n    style: {\n      border: \"solid 2px hsl(\" + value + \", 53%, 53%)\"\n    },\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 808\n    },\n    __self: this\n  }, React.createElement(Handle, Object.assign({\n    value: value\n  }, restProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 816\n    },\n    __self: this\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/19065019/react-test/src/components/App/index.js"],"names":["React","Component","ItemListing","EquippedItems","_","CharacterList","NotificationContainer","NotificationManager","RenderCanvas","axios","VirtualizedSelect","createFilterOptions","Slider","RcTooltip","SketchPicker","Localization","Localize","Tooltip","FontAwesome","Toggle","Sidebar","mql","window","matchMedia","localStorage","navigator","language","startsWith","creatingId","throttledErrorNotification","throttle","error","bind","leading","mapsIndexed","versions","GMS","region","MapleVersionId","IsReady","KMS","TMS","CMS","JMS","SEA","toCamel","o","newO","origKey","newKey","value","Array","map","hasOwnProperty","charAt","toLowerCase","slice","toString","constructor","Object","wzPromise","get","then","response","WZs","data","filter","wzEntry","isReady","groupBy","version","findIndex","ver","mapleVersionId","location","reload","console","log","maps","mapsFilter","mapPromise","label","streetName","name","join","id","options","App","props","isOpen","undefined","state","isModalOpen","characters","JSON","parse","pets","selectedIndex","selectedMap","zoom","mapPosition","x","y","backgroundColor","colorPickerOpen","music","sidebarDocked","matches","sidebarOpen","length","setState","focusRenderable","isEmpty","selectedItems","currentCharacter","skin","push","getNewCharacter","stringify","forEach","character","index","Date","now","type","action","frame","emotion","mercEars","illiumEars","visible","position","flipX","includeBackground","characterItems","values","item","keyBy","typeInfo","subCategory","otherCharacters","allCharacters","pet","summary","petId","animation","document","addEventListener","handleClick","mapsLoaded","setTimeout","mediaQueryChanged","onSetSidebarOpen","componentWillMount","addListener","componentWillUnmount","removeListener","open","changeRegionVersion","e","element","target","found","parentElement","className","render","localized","getLocalized","bgColorText","rgb","r","g","b","a","renderables","concat","userSelectedItem","updateRenderable","clickCanvas","userUpdateSelectedRenderable","addCharacter","addPet","importCharacter","removeCharacter","cloneCharacter","removePet","renderable","userUpdateCharacter","userUpdatePet","userRemovedItem","updateItem","userRemovedItems","prototype","renderSettings","openColorPicker","onChangeColor","handle","changeZoom","changeLanguage","selectMap","menuList","styles","height","menu","keys","versionName","playMusic","toggleMusic","exportAllCharacters","createElement","style","body","appendChild","payload","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","remove","newZoom","mapId","newProps","currentTarget","getNewPet","c","andysFavePetIds","Math","floor","random","fhSnap","importAll","call","files","file","Promise","res","rej","extension","substr","lastIndexOf","warn","reader","FileReader","onload","ev","result","readAsText","all","indexOfCharacter","indexOf","splice","newCharacterIndex","callback","locked","petIndex","currentPet","characterIndex","itemsWithEmotion","itemEntry","hue","updateSelectedRenderable","setModalOpen","selectedRenderable","similar","updateItems","event","createSliderWithTooltip","Range","Handle","dragging","restProps","border"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport './index.css'\nimport ItemListing from '../ItemListing'\nimport EquippedItems from '../EquippedItems'\nimport _ from 'lodash'\nimport CharacterList from '../CharacterList'\nimport 'react-notifications/lib/notifications.css'\nimport {NotificationContainer, NotificationManager} from 'react-notifications'\nimport RenderCanvas from '../RenderCanvas'\nimport axios from 'axios'\nimport VirtualizedSelect from 'react-virtualized-select'\n\nimport createFilterOptions from 'react-select-fast-filter-options'\nimport Slider from 'rc-slider'\nimport RcTooltip from 'rc-tooltip'\nimport { SketchPicker } from 'react-color'\nimport Localization from '../../const/localize'\nimport Localize from '../../const/localize'\nimport { Tooltip } from 'react-tippy'\nimport FontAwesome from 'react-fontawesome'\nimport 'rc-slider/assets/index.css'\nimport 'rc-tooltip/assets/bootstrap.css'\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle'\nimport Sidebar from \"react-sidebar\";\nconst mql = window.matchMedia(`(min-width: 800px)`);\n\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS'\n  localStorage['version'] = '328'\n  localStorage['initialized'] = '2'\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr'\n  else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp'\n  else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch'\n  else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl'\n  else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br'\n  else localStorage['language'] = 'en'\n}\n\nvar creatingId = null\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, { leading:true })\nlet mapsIndexed = null\nlet versions = {\n  GMS: [{region: \"GMS\", MapleVersionId: \"latest\", IsReady: true}],\n  KMS: [{region: \"KMS\", MapleVersionId: \"328\", IsReady: true}],\n  TMS: [{region: \"TMS\", MapleVersionId: \"latest\", IsReady: true}],\n  CMS: [{region: \"CMS\", MapleVersionId: \"latest\", IsReady: true}],\n  JMS: [{region: \"JMS\", MapleVersionId: \"latest\", IsReady: true}],\n  SEA: [{region: \"SEA\", MapleVersionId: \"latest\", IsReady: true}]\n}\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value\n  if (o instanceof Array) {\n    return o.map(function(value) {\n        if (typeof value === \"object\") {\n          value = toCamel(value)\n        }\n        return value\n    })\n  } else {\n    newO = {}\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString()\n        value = o[origKey]\n        if (value instanceof Array || (value !== null && value.constructor === Object)) {\n          value = toCamel(value)\n        }\n        newO[newKey] = value\n      }\n    }\n  }\n  return newO\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`)\n.then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return {\n      ...wzEntry,\n      region: wzEntry.region\n    }\n  })\n  versions = _.groupBy(WZs, 'region')\n\n  let region = localStorage['region'], version = localStorage['version']\n\n  if (!region || (version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1)) {\n    localStorage['region'] = 'KMS'\n    localStorage['version'] = '328'\n    window.location.reload()\n  }\n\n  console.log(versions);\n  return versions;\n})\n\nlet maps = []\nlet mapsFilter = null\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n      maps = _.map(response.data, map => {\n        return {\n          label: [map.streetName, map.name].join(' - '),\n          value: map.id\n        }\n      });\n      mapsFilter = createFilterOptions({options: maps})\n    });\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    let isOpen = (localStorage || {})['hideModal'] !== 'true'\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined')\n      isOpen = true\n\n    // Try to recover any existing state\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {x: 0, y: 0},\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\"hsl\":{\"h\":0,\"s\":0,\"l\":0,\"a\":0},\"hex\":\"transparent\",\"rgb\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0},\"hsv\":{\"h\":0,\"s\":0,\"v\":0,\"a\":0},\"oldHue\":0,\"source\":\"rgb\"},\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarDocked: mql.matches,\n      sidebarOpen: false,\n      versions\n    }\n\n    if (versions.KMS.length > 1)\n      this.state.versions = versions\n    else\n      wzPromise.then(ver => this.setState({versions}))\n\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex\n\n    // If we have a legacy character, upgrade to latest now\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      }\n      if (this.state.characters[0] === false)\n        this.state.characters[0] = currentCharacter;\n      else\n        this.state.characters.push(currentCharacter)\n    }\n\n    // If we have no characters at all, gen a new shell\n    if (this.state.characters[0] === false)\n      this.state.characters[0] = this.getNewCharacter()\n\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter'])\n      delete localStorage['currentCharacter']\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state])\n      this.state['characters'] = [...this.state.characters, this.state]\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1)\n      character.type = 'character'\n      character.action = character.action || 'stand1'\n      character.frame = character.frame || 0\n      character.zoom = character.zoom || 1\n      character.emotion = character.emotion || 'default'\n      character.skin = character.skin || 2000\n      character.mercEars = character.mercEars || false\n      character.illiumEars = character.illiumEars || false\n      character.selectedItems = character.selectedItems || []\n      character.visible = character.visible || false\n      character.position = character.position || {x:0,y:0}\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region']\n        if (!item.version) item.version = localStorage['version']\n        return item\n      })\n      character.selectedItems = _.keyBy(characterItems, (item) => item.typeInfo.subCategory)\n      delete character.characters\n      delete character.otherCharacters\n      delete character.allCharacters\n    })\n\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1)\n      pet.type = 'pet'\n      pet.position = pet.position || { x: 0, y: 0}\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`\n    })\n\n    if ((this.state.selectedIndex + 1) > (this.state.characters.length + this.state.pets.length) || !this.state.characters.length)\n      this.state.selectedIndex = false;\n\n\n    document.addEventListener(\"click\", this.handleClick.bind(this))\n\n    if (maps.length) this.state.mapsLoaded = true\n    else mapPromise.then(() => setTimeout(() => this.setState({mapsLoaded : true}), 250))\n    this.mediaQueryChanged = this.mediaQueryChanged.bind(this);\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n  }\n\n  componentWillMount() {\n    mql.addListener(this.mediaQueryChanged);\n  }\n\n  componentWillUnmount() {\n    mql.removeListener(this.mediaQueryChanged);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({ sidebarOpen: open });\n  }\n\n  mediaQueryChanged() {\n    this.setState({ sidebarDocked: mql.matches, sidebarOpen: false });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region\n    localStorage['version'] = version\n\n    // Much easier than trying to reload everything here :D\n    window.location.reload()\n  }\n\n  handleClick(e) {\n    let element = e.target\n    let found = false\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;\n      else {\n        found = true;\n        console.log('found bg-color-picker-container')\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({ colorPickerOpen: false })\n  }\n\n\n  render() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language,\n      music\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n\n    const renderables = characters.concat(pets)\n\n    return (\n      <div className={\"App\"}>\n      { (selectedIndex !== false) ?\n        <Sidebar\n          sidebar={<ItemListing\n            target={renderables[selectedIndex]}\n            onItemSelected={this.userSelectedItem.bind(this)}\n            localized={localized} />}\n            open={this.state.sidebarOpen}\n          docked={this.state.sidebarDocked}\n          onSetOpen={this.onSetSidebarOpen}\n\n        ></Sidebar> : '' }\n        <RenderCanvas\n          backgroundColor={bgColorText}\n          zoom={zoom}\n          mapId={selectedMap}\n          renderables={renderables}\n          selectedRenderable={selectedIndex}\n          focusRenderable={focusRenderable === undefined ? selectedIndex : focusRenderable}\n          onUpdateRenderable={this.updateRenderable.bind(this)}\n          onClick={this.clickCanvas.bind(this)}\n          localized={localized}\n          onClickRenderable={this.userUpdateSelectedRenderable.bind(this)}/>\n\n        <CharacterList\n          renderables={renderables}\n          selectedIndex={selectedIndex}\n          onAddCharacter={this.addCharacter.bind(this)}\n          onAddPet={this.addPet.bind(this)}\n          onImportCharacter={this.importCharacter.bind(this)}\n          onDeleteCharacter={this.removeCharacter.bind(this)}\n          onCloneCharacter={this.cloneCharacter.bind(this)}\n          onDeletePet={this.removePet.bind(this)}\n          localized={localized}\n          onUpdateSelectedCharacter={function (renderable) {\n            this.userUpdateSelectedRenderable(renderable, () => {\n              this.setState({\n                focusRenderable: this.state.selectedIndex\n              })\n            })\n          }.bind(this)}\n          onUpdateCharacter={this.userUpdateCharacter.bind(this)}\n          onUpdatePet={this.userUpdatePet.bind(this) }/>\n        {\n          (selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ? <EquippedItems\n            equippedItems={renderables[selectedIndex].selectedItems}\n            onRemoveItem={this.userRemovedItem.bind(this)}\n            name={renderables[selectedIndex].name}\n            skinId={renderables[selectedIndex].skin}\n            onUpdateItem={this.updateItem.bind(this)}\n            localized={localized}\n            onRemoveItems={this.userRemovedItems.bind(this)} /> : '')\n        }\n        <div className=\"disclaimer\"><div>{localized.prototype}</div></div>\n\n        <NotificationContainer />\n        { music ? <audio src={`//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`} autoPlay={true} loop={true} /> : '' }\n      </div>\n    )\n  }\n\n  renderSettings() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n    return (\n      <div className='settings-container'>\n        <label className='bg-color-picker-container' onClick={this.openColorPicker.bind(this)}>\n        Background color\n          <div className='bg-color-picker'>\n            <div className='bg-color-grid' style={{ backgroundColor: bgColorText }}></div>\n          </div>\n          { colorPickerOpen ? <SketchPicker color={bgColorText} onChange={this.onChangeColor.bind(this)} /> : '' }\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.zoom}</span>\n          <Slider\n            value={zoom || 1}\n            min={0.25}\n            max={2}\n            step={0.25}\n            handle={handle}\n            onChange={this.changeZoom.bind(this)} />\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.language}</span>\n          <select value={this.state.language} onChange={this.changeLanguage.bind(this)}>\n            <option value='en'>English</option>\n            <option value='jp'>Japanese</option>\n            <option value='kr'>Korean</option>\n            <option value='ch'>Chinese (Traditional)</option>\n            <option value='nl'>Dutch</option>\n            <option value='br'>Portuguese (Brazil)</option>\n          </select>\n        </label>\n        <div>\n          <div className='map-select-container'>\n            <VirtualizedSelect\n              filterOptions={mapsFilter}\n              isLoading={maps.length === 0}\n              name='map-selection'\n              searchable\n              clearable\n              simpleValue\n              value={selectedMap}\n              onChange={this.selectMap.bind(this)}\n              options={maps}\n              maxHeight={400}\n              styles={{\n                menuList: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                },\n                menu: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                }\n              }}\n              />\n          </div>\n        </div>\n        <label>\n          <span>{localized.region}</span>\n          <select value={this.state.region} onChange={(e) => this.changeRegionVersion(e.target.value, \"328\")}>\n            { _.keys(this.state.versions).map(versionName => <option value={versionName} key={versionName}>{versionName}</option>) }\n          </select>\n        </label>\n        <label>\n          <span>{localized.version}</span>\n          <select value={this.state.version} onChange={(e) => this.changeRegionVersion(this.state.region, e.target.value)}>\n            { this.state.versions[this.state.region].map(({mapleVersionId}) => <option value={mapleVersionId} key={mapleVersionId}>{mapleVersionId}</option>) }\n            <option value='328' key='328'>328</option>\n          </select>\n        </label>\n        <label>\n          <span>{localized.playMusic}</span>\n          <Toggle\n            onChange={this.toggleMusic.bind(this)}\n            checked={this.state.music} />\n        </label>\n        <label>\n          <a href='#' onClick={this.exportAllCharacters.bind(this)}>Export All Characters</a>\n        </label>\n      </div>\n    )\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    })\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a')\n      a.style = 'display: none;'\n      document.body.appendChild(a)\n\n      const payload = JSON.stringify(character, null, 2),\n        blob = new Blob([payload], {type: 'octet/stream'}),\n        url = window.URL.createObjectURL(blob)\n      a.href = url\n      if (character.name)\n        a.download = character.name + '-data.json'\n      else\n        a.download = 'character-data.json'\n      a.click()\n\n      window.URL.revokeObjectURL(url)\n      a.remove()\n    })\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    })\n    localStorage['language'] = e.target.value\n  }\n\n  changeZoom(newZoom) {\n    this.setState({ zoom: newZoom })\n    localStorage['zoom'] = newZoom\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    })\n    localStorage['selectedMap'] = mapId\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps)\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps)\n  }\n\n  clickCanvas(e) {\n    if (e.target === e.currentTarget && (this.state.characters.length + this.state.pets.length) > 1) {\n      this.setState({ selectedIndex: false })\n      localStorage['selectedIndex'] = 'false'\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()]\n    this.setState({pets, selectedIndex: this.state.characters.length + this.state.pets.length})\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet)\n    this.setState({ pets, selectedIndex: false, zoom: 1 }) // Unselect any pet in case we delete the last pet\n    localStorage['pets'] = JSON.stringify(pets)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005]\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)]\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: { x:0, y:0 }\n    }\n  }\n\n  importCharacter(e) {\n    let target = e.target\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase()\n        if (extension != 'json') {\n          console.warn('Not valid JSON file')\n          return\n        }\n\n        let reader = new FileReader()\n        reader.onload = function (ev) {\n          let payload = ev.target.result\n          let data = JSON.parse(payload)\n\n          res()\n          if (!data.id || data.type != 'character' || !data.selectedItems) return\n\n          data.id = Date.now()\n\n          let characters = [\n            ...this.state.characters,\n            data\n          ]\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          })\n          localStorage['characters'] = JSON.stringify(characters)\n        }.bind(this)\n\n        reader.readAsText(file, 'UTF8')\n      })\n    })\n\n    Promise.all(importAll).then(() => {\n      target.value = ''\n    })\n  }\n\n  addCharacter() {\n    var characters = [ ...this.state.characters, this.getNewCharacter() ]\n    this.setState({ characters, selectedIndex: this.state.characters.length })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character)\n    this.setState({ characters, selectedIndex: false, zoom: 1 }) // Unselect any character in case we delete the last character\n    localStorage['characters'] = JSON.stringify(characters)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  cloneCharacter(character) {\n    let characters = [\n      ...this.state.characters\n    ]\n\n    let indexOfCharacter = characters.indexOf(character)\n    characters.splice(indexOfCharacter + 1, 0, {\n      ...character,\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    })\n    let newCharacterIndex = indexOfCharacter + 1\n\n    this.setState({ characters, selectedIndex: newCharacterIndex, focusRenderable: newCharacterIndex + 1 })\n    localStorage['selectedIndex'] = newCharacterIndex\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable)\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable)\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length\n    }\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback)\n    localStorage['selectedIndex'] = selectedIndex\n    localStorage['zoom'] = 1\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const pets = [...this.state.pets]\n    const petIndex = pets.indexOf(pet)\n\n    const currentPet = pets[petIndex] = {\n      ...pet,\n      ...newProps\n    }\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`\n\n    this.setState({\n        pets: pets\n    })\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const characters = [...this.state.characters]\n    const characterIndex = characters.indexOf(character)\n\n    const currentCharacter = characters[characterIndex] = {\n      ...character,\n      ...newProps\n    }\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n    const { backgroundColor } = this.state\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    this.setState({\n        characters: characters\n    })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {x: 0, y: 0},\n      fhSnap: true\n    }\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex+1 > this.state.characters.length)\n      this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props)\n    else\n      this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props)\n  }\n\n  setModalOpen (isModalOpen) {\n    this.setState({ isModalOpen })\n  }\n\n  userSelectedItem (item) {\n    let selectedRenderable = null\n    if (this.state.selectedIndex+1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length]\n    else selectedRenderable = this.state.characters[this.state.selectedIndex]\n\n    item.region = localStorage['region']\n    item.version = localStorage['version']\n\n    let selectedItems = {\n      ...selectedRenderable.selectedItems,\n    }\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top']\n        delete selectedItems['Bottom']\n      }\n    }\n\n    if (item.similar) {\n      item = { ...item }\n      delete item['similar']\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item\n    }\n    this.updateItems(selectedItems)\n  }\n\n  userRemovedItem (item) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    delete selectedItems[item.typeInfo.subCategory]\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems () {\n    let selectedItems = {}\n    this.updateItems(selectedItems);\n  }\n\n  updateItem (item, newProps) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    selectedItems[item.typeInfo.subCategory] = {\n      ...item,\n      ...newProps\n    }\n    this.updateItems(selectedItems);\n  }\n\n  updateItems (selectedItems) {\n    console.log('New Items: ', selectedItems)\n    this.updateSelectedRenderable({\n      selectedItems\n    })\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n      return {\n        ...character\n      }\n    });\n\n    this.setState({ backgroundColor, characters })\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor)\n  }\n\n  openColorPicker() {\n    this.setState({ colorPickerOpen: true })\n  }\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = (props) => {\n  const { value, dragging, index, ...restProps } = props;\n  return (\n    <RcTooltip\n      prefixCls=\"rc-slider-tooltip\"\n      overlay={value}\n      visible={dragging}\n      placement=\"top\"\n      style={{border: \"solid 2px hsl(\"+value+\", 53%, 53%)\"}}\n      key={index}\n    >\n      <Handle value={value} {...restProps} />\n    </RcTooltip>\n  );\n};\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}