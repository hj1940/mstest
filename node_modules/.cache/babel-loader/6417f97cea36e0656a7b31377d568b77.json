{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\19065019\\\\react-test\\\\src\\\\components\\\\ItemListing\\\\index.js\";\nimport React, { Component } from 'react';\nimport './index.css';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport { CellMeasurer, CellMeasurerCache, createMasonryCellPositioner, Masonry, AutoSizer } from 'react-virtualized'; // Black list for individual sub categories\n\nconst blacklistSubcategories = [\"Monster Battle\", \"Skill Effect\", \"Pet Use\", \"Test Armor\", \"Test Weapon\", \"Shovel\", \"Pickaxe\", \"Totem\"]; // White list for categories\n\nconst applicableCategories = {\n  character: ['Character', 'Armor', 'Accessory', 'Mount', 'One-Handed Weapon', 'Two-Handed Weapon'],\n  pet: ['Other']\n}; // White list for individual sub categories\n\nconst applicableSubcategories = {\n  pet: ['Pet Equipment']\n};\nlet cellMeasurerCache = null;\nconst region = !localStorage['region'] ? 'KMS' : localStorage['region'];\nconst version = !localStorage['version'] ? '328' : localStorage['version'];\nconst itemListPromise = axios.get(`https://maplestory.io/api/KMS/328/item/category/equip`);\nconst chairListPromise = axios.get(`https://maplestory.io/api/KMS/328/item/category/setup`);\n\nclass MyComponent extends Component {\n  constructor(props) {\n    super(props);\n    this.addActiveClass = this.addActiveClass.bind(this);\n    this.state = {\n      active: false\n    };\n  }\n\n  toggleClass() {\n    const currentState = this.state.active;\n    this.setState({\n      active: !currentState\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: this.state.active ? 'your_className' : null,\n      onClick: this.toggleClass,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, this.props.text));\n  }\n\n}\n\nclass ItemListing extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: [],\n      categories: {},\n      categoryNames: {},\n      selectedCategory: null,\n      search: '',\n      gutterSize: 6,\n      columnWidth: 32,\n      categoryNameSelected: '',\n      selectedGender: '',\n      cashItemsOnly: false,\n      similarItems: null\n    };\n    this._cache = cellMeasurerCache = new CellMeasurerCache({\n      defaultHeight: 32,\n      defaultWidth: 32,\n      fixedWidth: true,\n      fixedHeight: true\n    });\n    Promise.all([itemListPromise, chairListPromise]).then(responses => {\n      if (!_.every(responses, res => res.status === 200)) return;\n      const setupData = responses[1].data;\n      const chairData = setupData.filter(item => Math.floor(item.id / 10000) === 301).map(chair => {\n        chair.typeInfo.category = \"Character\"; // That way it shows up as part of the character section\n\n        return chair;\n      });\n      const itemData = responses[0].data || [] || [];\n\n      const groupedHair = _.map(_.groupBy(itemData.filter(item => item.id >= 30000 && item.id <= 60000), item => Math.floor(item.id / 10)), itemGrouping => {\n        const firstItem = itemGrouping[0];\n        firstItem.similar = itemGrouping;\n        return firstItem;\n      });\n\n      const groupedFaces = _.map(_.groupBy(itemData.filter(item => item.id >= 10000 && item.id < 30000), item => item.id % 100 + (item.id - item.id % 1000)), itemGrouping => {\n        const firstItem = itemGrouping[0];\n        firstItem.similar = itemGrouping;\n        return firstItem;\n      });\n\n      const categories = _.mapValues(_.groupBy(itemData.filter(item => item.id < 10000 || item.id > 50000).concat(groupedHair).concat(groupedFaces).concat(chairData), item => item.typeInfo.category), items => _.groupBy(items, item => item.typeInfo.subCategory));\n\n      const categoryNames = _.mapValues(categories, _.keys);\n\n      const categoryNamesKeys = _.keys(categoryNames).filter(categoryName => categoryName != 'Character');\n\n      categoryNamesKeys.unshift('Character');\n      this.setState({\n        items: itemData,\n        categories,\n        categoryNames,\n        categoryNamesKeys\n      });\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          categoryNames = _this$state.categoryNames,\n          categoryNamesKeys = _this$state.categoryNamesKeys,\n          selectedCategory = _this$state.selectedCategory,\n          items = _this$state.items,\n          categoryNameSelected = _this$state.categoryNameSelected,\n          cashItemsOnly = _this$state.cashItemsOnly,\n          selectedGender = _this$state.selectedGender,\n          similarItems = _this$state.similarItems;\n    const search = this.state.search.toLowerCase();\n    const localized = this.props.localized;\n    if (search) console.log(`Searching for ${search}`);\n    const selectedType = this.props.target.type || 'character';\n    const applicableItems = (items || []).filter(item => {\n      return applicableCategories[selectedType].indexOf(item.typeInfo.category) !== -1 && blacklistSubcategories.indexOf(item.typeInfo.subCategory) === -1 && (!applicableSubcategories[selectedType] || applicableSubcategories[selectedType].indexOf(item.typeInfo.subCategory) !== -1);\n    });\n    this.showIcons = !search ? selectedCategory || applicableItems : applicableItems.filter((item, i) => {\n      return (item.name || '').toLowerCase().indexOf(search) !== -1 || item.id.toString().toLowerCase().indexOf(search) !== -1 || (item.desc || '').toLowerCase().indexOf(search) !== -1;\n    });\n    if (cashItemsOnly) this.showIcons = this.showIcons.filter(item => item.isCash);\n    if (selectedGender) this.showIcons = this.showIcons.filter(c => c.requiredGender == selectedGender);\n    this.showIcons = this.showIcons.filter(item => item && item.id);\n    return React.createElement(\"div\", {\n      className: \"item-listing\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item-listing-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"search\",\n      value: search,\n      onChange: this.search.bind(this),\n      placeholder: \"Search..\",\n      className: \"item-search\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"item-span\",\n      onClick: this.toggleClass,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"\\u261A\")), React.createElement(\"div\", {\n      className: \"filters\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      onChange: this.toggleCashItems.bind(this),\n      checked: this.cashItemsOnly,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), localized.isCashFilter), React.createElement(\"select\", {\n      onChange: this.changeGender.bind(this),\n      value: this.selectedGender,\n      className: \"gender-select\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, localized.genderFilter), React.createElement(\"option\", {\n      value: \"0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, localized.male), React.createElement(\"option\", {\n      value: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, localized.female), React.createElement(\"option\", {\n      value: \"2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, localized.universal))), React.createElement(\"div\", {\n      className: \"item-listing-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item-listing-categories\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, _.map((categoryNamesKeys || []).filter(categoryName => applicableCategories[selectedType].indexOf(categoryName) !== -1), category => {\n      const subCategories = categoryNames[category];\n      return React.createElement(\"li\", {\n        key: category,\n        onClick: this.selectPrimaryCategory.bind(this, category),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: 'category' + (category === categoryNameSelected ? ' active' : ''),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, category), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, subCategories.filter(categoryName => blacklistSubcategories.indexOf(categoryName) === -1 && (!applicableSubcategories[selectedType] || applicableSubcategories[selectedType].indexOf(categoryName) !== -1)).map(subCategory => React.createElement(\"li\", {\n        key: subCategory,\n        className: subCategory === categoryNameSelected ? 'active' : '',\n        onClick: this.selectChildCategory.bind(this, category, subCategory),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, subCategory))));\n    }))), React.createElement(\"div\", {\n      className: \"item-listing-icons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, similarItems && React.createElement(\"div\", {\n      className: \"similar-items\",\n      style: {\n        left: similarItems.x - 5,\n        top: similarItems.y - 5,\n        width: similarItems.item.similar.length * 36\n      },\n      onMouseLeave: this.mouseOutSimilar.bind(this),\n      onWheel: this.onSimilarScroll.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, similarItems.item.similar.map(item => this.containedItemIcon(item, true))), this._renderAutoSizer({\n      height: 32\n    }))));\n  }\n\n  onSimilarScroll(e) {\n    var masonry = document.getElementsByClassName(\"ReactVirtualized__Masonry\")[0];\n    masonry.scrollTop += e.deltaY;\n    this.mouseOutSimilar();\n  }\n\n  mouseOutSimilar() {\n    this.setState({\n      similarItems: null\n    });\n  }\n\n  toggleCashItems(e) {\n    this.setState({\n      cashItemsOnly: e.target.checked\n    });\n  }\n\n  changeGender(e) {\n    this.setState({\n      selectedGender: e.target.value\n    });\n  }\n\n  _renderAutoSizer({\n    height\n  }) {\n    this._height = height || 32;\n    return React.createElement(AutoSizer, {\n      onResize: this._onResize.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, this._renderMasonry.bind(this));\n  }\n\n  _renderMasonry({\n    height,\n    width\n  }) {\n    this._width = width;\n    this._height = height;\n\n    this._calculateColumnCount();\n\n    this._initCellPositioner();\n\n    return React.createElement(Masonry, {\n      cellCount: this.showIcons.length - 1,\n      cellMeasurerCache: cellMeasurerCache,\n      cellPositioner: this._cellPositioner,\n      cellRenderer: this.cellRenderer.bind(this),\n      ref: this._setMasonryRef.bind(this),\n      width: width,\n      height: this._height,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    });\n  }\n\n  _calculateColumnCount() {\n    const _this$state2 = this.state,\n          columnWidth = _this$state2.columnWidth,\n          gutterSize = _this$state2.gutterSize;\n    this._columnCount = Math.floor(this._width / (columnWidth + gutterSize));\n  }\n\n  _initCellPositioner() {\n    if (typeof this._cellPositioner === 'undefined') {\n      const _this$state3 = this.state,\n            columnWidth = _this$state3.columnWidth,\n            gutterSize = _this$state3.gutterSize;\n      this._cellPositioner = createMasonryCellPositioner({\n        cellMeasurerCache: this._cache,\n        columnCount: this._columnCount,\n        columnWidth,\n        spacer: gutterSize\n      });\n    }\n  }\n\n  _onResize({\n    height,\n    width\n  }) {\n    this._width = width;\n    this._columnHeights = {};\n\n    this._calculateColumnCount();\n\n    this._resetCellPositioner();\n\n    this._masonry.recomputeCellPositions();\n  }\n\n  _resetCellPositioner() {\n    const _this$state4 = this.state,\n          columnWidth = _this$state4.columnWidth,\n          gutterSize = _this$state4.gutterSize;\n\n    this._cellPositioner.reset({\n      columnCount: this._columnCount,\n      columnWidth,\n      spacer: gutterSize\n    });\n  }\n\n  _setMasonryRef(ref) {\n    this._masonry = ref;\n  }\n\n  cellRenderer({\n    index,\n    key,\n    parent,\n    style\n  }) {\n    const item = this.showIcons[index];\n    const showSimilarTo = this.state.showSimilarTo;\n    if (!item) return;\n    return React.createElement(CellMeasurer, {\n      cache: cellMeasurerCache,\n      index: index,\n      key: item.id,\n      parent: parent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item-img-container\",\n      style: _objectSpread({}, style, {\n        width: 32,\n        height: 32\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, this.itemIcon(item, this.state.search)));\n  }\n\n  containedItemIcon(item, hideSimilar) {\n    return React.createElement(\"div\", {\n      onWheel: !hideSimilar ? this.onSimilarScroll.bind(this) : false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    }, this.itemIcon(item, hideSimilar));\n  }\n\n  itemIcon(item, hideSimilar) {\n    return React.createElement(\"img\", {\n      src: `https://maplestory.io/api/KMS/328/item/${item.id}/icon`,\n      onClick: this.selectItem.bind(this, item),\n      alt: item.name,\n      title: item.name,\n      id: item.id,\n      key: item.id,\n      onMouseOver: !hideSimilar && item.similar ? this.showSimilar.bind(this, item) : false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363\n      },\n      __self: this\n    });\n  }\n\n  showSimilar(item) {\n    const iconImg = document.getElementById(item.id).parentElement;\n    const masonryContainer = document.getElementsByClassName(\"ReactVirtualized__Masonry\")[0];\n    this.setState({\n      similarItems: {\n        item,\n        x: iconImg.offsetLeft + masonryContainer.offsetLeft,\n        y: iconImg.offsetTop + masonryContainer.offsetTop - iconImg.parentElement.parentElement.scrollTop\n      }\n    });\n  }\n\n  search(e) {\n    this.setState({\n      search: e.target.value\n    });\n  }\n\n  selectPrimaryCategory(primaryCategory, proxy, e) {\n    const selectedCategory = _.flatMap(_.values(this.state.categories[primaryCategory], a => a));\n\n    this.selectCategory(selectedCategory, primaryCategory);\n    proxy.preventDefault();\n    proxy.stopPropagation();\n  }\n\n  selectChildCategory(primaryCategory, childCategory, proxy, e) {\n    const selectedCategory = this.state.categories[primaryCategory][childCategory];\n    this.selectCategory(selectedCategory, childCategory);\n    proxy.preventDefault();\n    proxy.stopPropagation();\n  }\n\n  selectCategory(selectedCategory, categoryNameSelected) {\n    console.log(`Selected category: ${categoryNameSelected}`);\n    this.setState({\n      selectedCategory,\n      categoryNameSelected,\n      search: ''\n    });\n  }\n\n  selectItem(item) {\n    this.props.onItemSelected(item);\n  }\n\n}\n\nexport default ItemListing;","map":{"version":3,"sources":["C:/Users/19065019/react-test/src/components/ItemListing/index.js"],"names":["React","Component","axios","_","CellMeasurer","CellMeasurerCache","createMasonryCellPositioner","Masonry","AutoSizer","blacklistSubcategories","applicableCategories","character","pet","applicableSubcategories","cellMeasurerCache","region","localStorage","version","itemListPromise","get","chairListPromise","MyComponent","constructor","props","addActiveClass","bind","state","active","toggleClass","currentState","setState","render","text","ItemListing","items","categories","categoryNames","selectedCategory","search","gutterSize","columnWidth","categoryNameSelected","selectedGender","cashItemsOnly","similarItems","_cache","defaultHeight","defaultWidth","fixedWidth","fixedHeight","Promise","all","then","responses","every","res","status","setupData","data","chairData","filter","item","Math","floor","id","map","chair","typeInfo","category","itemData","groupedHair","groupBy","itemGrouping","firstItem","similar","groupedFaces","mapValues","concat","subCategory","keys","categoryNamesKeys","categoryName","unshift","toLowerCase","localized","console","log","selectedType","target","type","applicableItems","indexOf","showIcons","i","name","toString","desc","isCash","c","requiredGender","toggleCashItems","isCashFilter","changeGender","genderFilter","male","female","universal","subCategories","selectPrimaryCategory","selectChildCategory","left","x","top","y","width","length","mouseOutSimilar","onSimilarScroll","containedItemIcon","_renderAutoSizer","height","e","masonry","document","getElementsByClassName","scrollTop","deltaY","checked","value","_height","_onResize","_renderMasonry","_width","_calculateColumnCount","_initCellPositioner","_cellPositioner","cellRenderer","_setMasonryRef","_columnCount","columnCount","spacer","_columnHeights","_resetCellPositioner","_masonry","recomputeCellPositions","reset","ref","index","key","parent","style","showSimilarTo","itemIcon","hideSimilar","selectItem","showSimilar","iconImg","getElementById","parentElement","masonryContainer","offsetLeft","offsetTop","primaryCategory","proxy","flatMap","values","a","selectCategory","preventDefault","stopPropagation","childCategory","onItemSelected"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport './index.css'\nimport axios from 'axios'\nimport _ from 'lodash'\nimport {\n  CellMeasurer,\n  CellMeasurerCache,\n  createMasonryCellPositioner,\n  Masonry,\n  AutoSizer\n} from 'react-virtualized';\n\n// Black list for individual sub categories\nconst blacklistSubcategories = [\n  \"Monster Battle\",\n  \"Skill Effect\",\n  \"Pet Use\",\n  \"Test Armor\",\n  \"Test Weapon\",\n  \"Shovel\",\n  \"Pickaxe\",\n  \"Totem\"\n]\n\n// White list for categories\nconst applicableCategories = {\n  character: ['Character', 'Armor', 'Accessory', 'Mount', 'One-Handed Weapon', 'Two-Handed Weapon'],\n  pet: ['Other']\n}\n\n// White list for individual sub categories\nconst applicableSubcategories = { pet: ['Pet Equipment'] }\n\nlet cellMeasurerCache = null\n\nconst region = !localStorage['region'] ? 'KMS' : localStorage['region']\nconst version = !localStorage['version'] ? '328' : localStorage['version']\n\nconst itemListPromise = axios.get(`https://maplestory.io/api/KMS/328/item/category/equip`);\nconst chairListPromise = axios.get(`https://maplestory.io/api/KMS/328/item/category/setup`);\n\n  class MyComponent extends Component {\n      constructor(props) {\n          super(props);\n          this.addActiveClass= this.addActiveClass.bind(this);\n          this.state = {\n              active: false,\n          };\n      }\n      toggleClass() {\n          const currentState = this.state.active;\n          this.setState({ active: !currentState });\n      };\n\n      render() {\n          return (\n              <div\n                  className={this.state.active ? 'your_className': null}\n                  onClick={this.toggleClass}\n              >\n                  <p>{this.props.text}</p>\n              </div>\n          )\n    }\n  }\n\n\nclass ItemListing extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: [],\n      categories: {},\n      categoryNames: {},\n      selectedCategory: null,\n      search: '',\n      gutterSize: 6,\n      columnWidth: 32,\n      categoryNameSelected: '',\n      selectedGender: '',\n      cashItemsOnly: false,\n      similarItems: null\n    }\n\n    this._cache = cellMeasurerCache = new CellMeasurerCache({\n      defaultHeight: 32,\n      defaultWidth: 32,\n      fixedWidth: true,\n      fixedHeight: true\n    });\n\n    Promise.all([itemListPromise, chairListPromise]).then(responses => {\n      if(!_.every(responses, res => res.status === 200)) return;\n      const setupData = responses[1].data\n      const chairData = setupData.filter(item => Math.floor(item.id / 10000) === 301).map(chair => {\n        chair.typeInfo.category = \"Character\" // That way it shows up as part of the character section\n        return chair\n      })\n      const itemData = (responses[0].data || []) || []\n      const groupedHair = _.map(\n        _.groupBy(\n          itemData.filter(item => item.id >= 30000 && item.id <= 60000),\n          item => Math.floor(item.id / 10)\n        ), itemGrouping => {\n          const firstItem = itemGrouping[0]\n          firstItem.similar = itemGrouping\n          return firstItem\n        }\n      )\n      const groupedFaces = _.map(\n        _.groupBy(\n          itemData.filter(item => item.id >= 10000 && item.id < 30000),\n          item => (item.id % 100) + (item.id - (item.id % 1000))\n        ), itemGrouping => {\n          const firstItem = itemGrouping[0]\n          firstItem.similar = itemGrouping\n          return firstItem\n        }\n      )\n      const categories = _.mapValues(\n        _.groupBy(\n          itemData\n            .filter(item => item.id < 10000 || item.id > 50000)\n            .concat(groupedHair)\n            .concat(groupedFaces)\n            .concat(chairData),\n          item => item.typeInfo.category),\n        items => _.groupBy(items, item => item.typeInfo.subCategory)\n      );\n\n      const categoryNames = _.mapValues(categories, _.keys);\n      const categoryNamesKeys = _.keys(categoryNames).filter((categoryName) => categoryName != 'Character');\n      categoryNamesKeys.unshift('Character');\n\n      this.setState({\n        items: itemData,\n        categories,\n        categoryNames,\n        categoryNamesKeys\n      })\n    })\n  }\n\n  render() {\n    const { categoryNames, categoryNamesKeys, selectedCategory, items, categoryNameSelected, cashItemsOnly, selectedGender, similarItems } = this.state\n    const search = this.state.search.toLowerCase()\n    const { localized } = this.props\n\n    if (search) console.log(`Searching for ${search}`)\n\n    const selectedType = this.props.target.type || 'character'\n    const applicableItems = (items || []).filter(item => {\n      return applicableCategories[selectedType].indexOf(item.typeInfo.category) !== -1 && blacklistSubcategories.indexOf(item.typeInfo.subCategory) === -1 && (!applicableSubcategories[selectedType] || applicableSubcategories[selectedType].indexOf(item.typeInfo.subCategory) !== -1)\n    })\n\n    this.showIcons = !search ? (selectedCategory || applicableItems) : applicableItems.filter((item, i) => {\n      return (item.name || '').toLowerCase().indexOf(search) !== -1 ||\n        item.id.toString().toLowerCase().indexOf(search) !== -1 ||\n        (item.desc || '').toLowerCase().indexOf(search) !== -1\n    })\n\n    if (cashItemsOnly)\n      this.showIcons = this.showIcons.filter(item => item.isCash)\n\n    if (selectedGender)\n      this.showIcons = this.showIcons.filter(c => c.requiredGender == selectedGender);\n\n    this.showIcons = this.showIcons.filter(item => item && item.id)\n\n    return (\n      <div className='item-listing'>\n        <div className='item-listing-header'>\n          <input type=\"search\" value={search} onChange={this.search.bind(this)} placeholder=\"Search..\" className=\"item-search\"/>\n          <span className=\"item-span\" onClick={this.toggleClass}>&#9754;</span>\n        </div>\n        <div className='filters'>\n          <label>\n            <input type=\"checkbox\" onChange={this.toggleCashItems.bind(this)} checked={this.cashItemsOnly} />\n            {localized.isCashFilter}\n          </label>\n          <select onChange={this.changeGender.bind(this)} value={this.selectedGender} className=\"gender-select\">\n            <option value=\"\">{localized.genderFilter}</option>\n            <option value=\"0\">{localized.male}</option>\n            <option value=\"1\">{localized.female}</option>\n            <option value=\"2\">{localized.universal}</option>\n          </select>\n        </div>\n        <div className='item-listing-content'>\n          <div className='item-listing-categories'>\n          <ul>\n          {\n            _.map((categoryNamesKeys || []).filter(categoryName => applicableCategories[selectedType].indexOf(categoryName) !== -1), category => {\n              const subCategories = categoryNames[category];\n              return (<li key={category} onClick={this.selectPrimaryCategory.bind(this, category)}>\n              <span className={'category' + (category === categoryNameSelected ? ' active' : '')}>{category}</span>\n              <ul>\n                {\n                  subCategories.filter(categoryName => blacklistSubcategories.indexOf(categoryName) === -1 && (!applicableSubcategories[selectedType] || applicableSubcategories[selectedType].indexOf(categoryName) !== -1)).map(subCategory => <li\n                    key={subCategory}\n                    className={subCategory === categoryNameSelected ? 'active' : ''}\n                    onClick={this.selectChildCategory.bind(this, category, subCategory)}>\n                      {subCategory}\n                    </li>)\n                }\n              </ul></li>)\n            })\n          }\n          </ul>\n          </div>\n          <div className='item-listing-icons'>\n            { similarItems &&\n              <div className='similar-items' style={{\n                left: similarItems.x - 5,\n                top: similarItems.y - 5,\n                width: (similarItems.item.similar.length * 36)\n              }} onMouseLeave={this.mouseOutSimilar.bind(this)}\n                onWheel={this.onSimilarScroll.bind(this)}\n                >\n                { similarItems.item.similar.map((item) => this.containedItemIcon(item, true)) }\n              </div>\n            }\n            { this._renderAutoSizer({ height: 32 }) }\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  onSimilarScroll(e) {\n    var masonry = document.getElementsByClassName(\"ReactVirtualized__Masonry\")[0]\n    masonry.scrollTop += e.deltaY\n    this.mouseOutSimilar()\n  }\n\n  mouseOutSimilar() {\n    this.setState({ similarItems: null })\n  }\n\n  toggleCashItems (e) {\n    this.setState({ cashItemsOnly: e.target.checked })\n  }\n\n  changeGender (e) {\n    this.setState({ selectedGender: e.target.value })\n  }\n\n  _renderAutoSizer ({ height }) {\n    this._height = height || 32\n\n    return (\n      <AutoSizer\n        onResize={this._onResize.bind(this)}\n      >\n        {this._renderMasonry.bind(this)}\n      </AutoSizer>\n    )\n  }\n\n  _renderMasonry({ height, width }) {\n    this._width = width\n    this._height = height\n\n    this._calculateColumnCount()\n    this._initCellPositioner()\n\n    return <Masonry\n      cellCount={this.showIcons.length - 1}\n      cellMeasurerCache={cellMeasurerCache}\n      cellPositioner={this._cellPositioner}\n      cellRenderer={this.cellRenderer.bind(this)}\n      ref={this._setMasonryRef.bind(this)}\n      width={width}\n      height={this._height}\n      />\n  }\n\n  _calculateColumnCount () {\n    const {\n      columnWidth,\n      gutterSize\n    } = this.state\n\n    this._columnCount = Math.floor(this._width / (columnWidth + gutterSize))\n  }\n\n  _initCellPositioner () {\n    if (typeof this._cellPositioner === 'undefined') {\n      const {\n        columnWidth,\n        gutterSize\n      } = this.state\n\n      this._cellPositioner = createMasonryCellPositioner({\n        cellMeasurerCache: this._cache,\n        columnCount: this._columnCount,\n        columnWidth,\n        spacer: gutterSize\n      })\n    }\n  }\n\n  _onResize ({ height, width }) {\n    this._width = width\n\n    this._columnHeights = {}\n    this._calculateColumnCount()\n    this._resetCellPositioner()\n    this._masonry.recomputeCellPositions()\n  }\n\n  _resetCellPositioner () {\n    const {\n      columnWidth,\n      gutterSize\n    } = this.state\n\n    this._cellPositioner.reset({\n      columnCount: this._columnCount,\n      columnWidth,\n      spacer: gutterSize\n    })\n  }\n\n  _setMasonryRef (ref) {\n    this._masonry = ref\n  }\n\n  cellRenderer ({ index, key, parent, style }) {\n    const item = this.showIcons[index]\n    const { showSimilarTo } = this.state\n\n    if (!item) return\n\n    return (\n      <CellMeasurer\n        cache={cellMeasurerCache}\n        index={index}\n        key={item.id}\n        parent={parent}\n      >\n        <div className=\"item-img-container\" style={{\n          ...style,\n          width: 32,\n          height: 32\n        }}>\n          { this.itemIcon(item, this.state.search) }\n        </div>\n      </CellMeasurer>\n    )\n  }\n\n  containedItemIcon(item, hideSimilar) {\n    return (\n      <div\n        onWheel={!hideSimilar ? this.onSimilarScroll.bind(this) : false}\n        >\n        { this.itemIcon(item, hideSimilar) }\n      </div>\n    )\n  }\n\n  itemIcon(item, hideSimilar) {\n    return (<img\n      src={`https://maplestory.io/api/KMS/328/item/${item.id}/icon`}\n      onClick={this.selectItem.bind(this, item)}\n      alt={item.name}\n      title={item.name}\n      id={item.id}\n      key={item.id}\n      onMouseOver={!hideSimilar && item.similar ? this.showSimilar.bind(this, item) : false} />)\n  }\n\n  showSimilar(item) {\n    const iconImg = document.getElementById(item.id).parentElement\n    const masonryContainer = document.getElementsByClassName(\"ReactVirtualized__Masonry\")[0]\n    this.setState({\n      similarItems: {\n        item,\n        x: iconImg.offsetLeft + masonryContainer.offsetLeft,\n        y: iconImg.offsetTop + masonryContainer.offsetTop - iconImg.parentElement.parentElement.scrollTop\n      }\n    })\n  }\n\n  search(e) {\n    this.setState({\n      search: e.target.value\n    })\n  }\n\n  selectPrimaryCategory(primaryCategory, proxy, e) {\n    const selectedCategory = _.flatMap(_.values(this.state.categories[primaryCategory], a => a))\n    this.selectCategory(selectedCategory, primaryCategory)\n    proxy.preventDefault()\n    proxy.stopPropagation()\n  }\n\n  selectChildCategory(primaryCategory, childCategory, proxy, e) {\n    const selectedCategory = this.state.categories[primaryCategory][childCategory]\n    this.selectCategory(selectedCategory, childCategory)\n    proxy.preventDefault()\n    proxy.stopPropagation()\n  }\n\n  selectCategory(selectedCategory, categoryNameSelected) {\n    console.log(`Selected category: ${categoryNameSelected}`)\n    this.setState({\n      selectedCategory,\n      categoryNameSelected,\n      search: ''\n    })\n  }\n\n  selectItem(item){\n    this.props.onItemSelected(item)\n  }\n}\n\nexport default ItemListing\n"]},"metadata":{},"sourceType":"module"}