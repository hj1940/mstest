{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\19065019\\\\react-test\\\\src\\\\components\\\\App\\\\index.js\";\nimport React, { Component } from 'react';\nimport './index.css';\nimport ItemListing from '../ItemListing';\nimport EquippedItems from '../EquippedItems';\nimport _ from 'lodash';\nimport CharacterList from '../CharacterList';\nimport 'react-notifications/lib/notifications.css';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport RenderCanvas from '../RenderCanvas';\nimport axios from 'axios';\nimport VirtualizedSelect from 'react-virtualized-select';\nimport createFilterOptions from 'react-select-fast-filter-options';\nimport Slider from 'rc-slider';\nimport RcTooltip from 'rc-tooltip';\nimport { SketchPicker } from 'react-color';\nimport Localization from '../../const/localize';\nimport Localize from '../../const/localize';\nimport { Tooltip } from 'react-tippy';\nimport FontAwesome from 'react-fontawesome';\nimport 'rc-slider/assets/index.css';\nimport 'rc-tooltip/assets/bootstrap.css';\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle';\nimport Sidebar from \"react-sidebar\";\nconst mql = window.matchMedia(`(min-width: 800px)`);\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS';\n  localStorage['version'] = '328';\n  localStorage['initialized'] = '2';\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr';else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp';else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch';else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl';else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br';else localStorage['language'] = 'en';\n}\n\nvar creatingId = null;\n\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, {\n  leading: true\n});\n\nlet mapsIndexed = null;\nlet versions = {\n  GMS: [{\n    region: \"GMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  KMS: [{\n    region: \"KMS\",\n    MapleVersionId: \"328\",\n    IsReady: true\n  }],\n  TMS: [{\n    region: \"TMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  CMS: [{\n    region: \"CMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  JMS: [{\n    region: \"JMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  SEA: [{\n    region: \"SEA\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }]\n};\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value;\n\n  if (o instanceof Array) {\n    return o.map(function (value) {\n      if (typeof value === \"object\") {\n        value = toCamel(value);\n      }\n\n      return value;\n    });\n  } else {\n    newO = {};\n\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString();\n        value = o[origKey];\n\n        if (value instanceof Array || value !== null && value.constructor === Object) {\n          value = toCamel(value);\n        }\n\n        newO[newKey] = value;\n      }\n    }\n  }\n\n  return newO;\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`).then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return _objectSpread({}, wzEntry, {\n      region: wzEntry.region\n    });\n  });\n\n  versions = _.groupBy(WZs, 'region');\n  let region = localStorage['region'],\n      version = localStorage['version'];\n\n  if (!region || version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1) {\n    localStorage['region'] = 'KMS';\n    localStorage['version'] = '328';\n    window.location.reload();\n  }\n\n  console.log(versions);\n  return versions;\n});\nlet maps = [];\nlet mapsFilter = null;\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n  maps = _.map(response.data, map => {\n    return {\n      label: [map.streetName, map.name].join(' - '),\n      value: map.id\n    };\n  });\n  mapsFilter = createFilterOptions({\n    options: maps\n  });\n});\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    let isOpen = (localStorage || {})['hideModal'] !== 'true';\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined') isOpen = true; // Try to recover any existing state\n\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {\n        x: 0,\n        y: 0\n      },\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\n        \"hsl\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"l\": 0,\n          \"a\": 0\n        },\n        \"hex\": \"transparent\",\n        \"rgb\": {\n          \"r\": 0,\n          \"g\": 0,\n          \"b\": 0,\n          \"a\": 0\n        },\n        \"hsv\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"v\": 0,\n          \"a\": 0\n        },\n        \"oldHue\": 0,\n        \"source\": \"rgb\"\n      },\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarDocked: mql.matches,\n      sidebarOpen: false,\n      sidebarRDocked: mql.matches,\n      sidebarROpen: false,\n      versions\n    };\n    if (versions.KMS.length > 1) this.state.versions = versions;else wzPromise.then(ver => this.setState({\n      versions\n    }));\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex; // If we have a legacy character, upgrade to latest now\n\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      };\n      if (this.state.characters[0] === false) this.state.characters[0] = currentCharacter;else this.state.characters.push(currentCharacter);\n    } // If we have no characters at all, gen a new shell\n\n\n    if (this.state.characters[0] === false) this.state.characters[0] = this.getNewCharacter();\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter']);\n      delete localStorage['currentCharacter'];\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state]);\n      this.state['characters'] = [...this.state.characters, this.state];\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1);\n      character.type = 'character';\n      character.action = character.action || 'stand1';\n      character.frame = character.frame || 0;\n      character.zoom = character.zoom || 1;\n      character.emotion = character.emotion || 'default';\n      character.skin = character.skin || 2000;\n      character.mercEars = character.mercEars || false;\n      character.illiumEars = character.illiumEars || false;\n      character.selectedItems = character.selectedItems || [];\n      character.visible = character.visible || false;\n      character.position = character.position || {\n        x: 0,\n        y: 0\n      };\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground;\n\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region'];\n        if (!item.version) item.version = localStorage['version'];\n        return item;\n      });\n\n      character.selectedItems = _.keyBy(characterItems, item => item.typeInfo.subCategory);\n      delete character.characters;\n      delete character.otherCharacters;\n      delete character.allCharacters;\n    });\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1);\n      pet.type = 'pet';\n      pet.position = pet.position || {\n        x: 0,\n        y: 0\n      };\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`;\n    });\n    if (this.state.selectedIndex + 1 > this.state.characters.length + this.state.pets.length || !this.state.characters.length) this.state.selectedIndex = false;\n    document.addEventListener(\"click\", this.handleClick.bind(this));\n    if (maps.length) this.state.mapsLoaded = true;else mapPromise.then(() => setTimeout(() => this.setState({\n      mapsLoaded: true\n    }), 250));\n    this.mediaQueryChanged = this.mediaQueryChanged.bind(this);\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n    this.onSetRightSidebarOpen = this.onSetRightSidebarOpen.bind(this);\n  }\n\n  componentWillMount() {\n    mql.addListener(this.mediaQueryChanged);\n  }\n\n  componentWillUnmount() {\n    mql.removeListener(this.mediaQueryChanged);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({\n      sidebarOpen: open\n    });\n\n    if (!this.state.sidebarDocked && this.state.sidebarOpen) {\n      this.setState({\n        sidebarOpen: false\n      });\n    }\n  }\n\n  onSetRightSidebarOpen(open) {\n    this.setState({\n      sidebarROpen: open\n    });\n\n    if (!this.state.sidebarRDocked && this.state.sidebarROpen) {\n      this.setState({\n        sidebarROpen: false\n      });\n    }\n  }\n\n  mediaQueryChanged() {\n    this.setState({\n      sidebarDocked: mql.matches,\n      sidebarOpen: false,\n      sidebarRDocked: mql.matches,\n      sidebarROpen: false\n    });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region;\n    localStorage['version'] = version; // Much easier than trying to reload everything here :D\n\n    window.location.reload();\n  }\n\n  handleClick(e) {\n    let element = e.target;\n    let found = false;\n\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;else {\n        found = true;\n        console.log('found bg-color-picker-container');\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({\n      colorPickerOpen: false\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          characters = _this$state.characters,\n          pets = _this$state.pets,\n          selectedIndex = _this$state.selectedIndex,\n          isModalOpen = _this$state.isModalOpen,\n          zoom = _this$state.zoom,\n          summary = _this$state.summary,\n          selectedMap = _this$state.selectedMap,\n          focusRenderable = _this$state.focusRenderable,\n          backgroundColor = _this$state.backgroundColor,\n          colorPickerOpen = _this$state.colorPickerOpen,\n          language = _this$state.language,\n          music = _this$state.music;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    const renderables = characters.concat(pets);\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"App-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"item-span\",\n      onClick: () => this.onSetSidebarOpen(true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, \"\\u2630\")), selectedIndex !== false ? React.createElement(Sidebar, {\n      sidebar: React.createElement(ItemListing, {\n        target: renderables[selectedIndex],\n        onItemSelected: this.userSelectedItem.bind(this),\n        localized: localized,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }),\n      open: this.state.sidebarOpen,\n      docked: this.state.sidebarDocked,\n      onSetOpen: this.onSetSidebarOpen,\n      styles: {\n        overlay: {\n          zIndex: !this.state.sidebarDocked && this.state.sidebarOpen ? 3001 : 2000\n        },\n        sidebar: {\n          width: 300,\n          zIndex: 4000,\n          boxShadow: this.state.sidebarDocked || !this.state.sidebarOpen ? 'none' : 'rgba(0, 0, 0, 0.15) 2px 2px 2px;'\n        },\n        content: {\n          top: 64\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }) : '', React.createElement(RenderCanvas, {\n      backgroundColor: bgColorText,\n      zoom: zoom,\n      mapId: selectedMap,\n      renderables: renderables,\n      selectedRenderable: selectedIndex,\n      focusRenderable: focusRenderable === undefined ? selectedIndex : focusRenderable,\n      onUpdateRenderable: this.updateRenderable.bind(this),\n      onClick: this.clickCanvas.bind(this),\n      localized: localized,\n      onClickRenderable: this.userUpdateSelectedRenderable.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }), React.createElement(CharacterList, {\n      renderables: renderables,\n      selectedIndex: selectedIndex,\n      onAddCharacter: this.addCharacter.bind(this),\n      onAddPet: this.addPet.bind(this),\n      onImportCharacter: this.importCharacter.bind(this),\n      onDeleteCharacter: this.removeCharacter.bind(this),\n      onCloneCharacter: this.cloneCharacter.bind(this),\n      onDeletePet: this.removePet.bind(this),\n      localized: localized,\n      onUpdateSelectedCharacter: function (renderable) {\n        this.userUpdateSelectedRenderable(renderable, () => {\n          this.setState({\n            focusRenderable: this.state.selectedIndex\n          });\n        });\n      }.bind(this),\n      onUpdateCharacter: this.userUpdateCharacter.bind(this),\n      onUpdatePet: this.userUpdatePet.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }), selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ? React.createElement(Sidebar, {\n      sidebar: React.createElement(EquippedItems, {\n        equippedItems: renderables[selectedIndex].selectedItems,\n        onRemoveItem: this.userRemovedItem.bind(this),\n        name: renderables[selectedIndex].name,\n        skinId: renderables[selectedIndex].skin,\n        onUpdateItem: this.updateItem.bind(this),\n        localized: localized,\n        onRemoveItems: this.userRemovedItems.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361\n        },\n        __self: this\n      }),\n      open: this.state.sidebarROpen,\n      docked: this.state.sidebarRDocked,\n      onSetOpen: this.onSetRightSidebarOpen,\n      pullRight: true,\n      shadow: false,\n      styles: {\n        root: {\n          left: 800\n        },\n        overlay: {\n          zIndex: !this.state.sidebarRDocked && this.state.sidebarROpen ? 3001 : 2000\n        },\n        sidebar: {\n          width: 300,\n          zIndex: 4001,\n          boxShadow: this.state.sidebarRDocked || !this.state.sidebarROpen ? 'none' : 'rgba(0, 0, 0, 0.15) 2px 2px 2px;'\n        },\n        content: {\n          top: 64,\n          WebkitOverflowScrolling: \"\"\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }) : '', React.createElement(NotificationContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }), music ? React.createElement(\"audio\", {\n      src: `//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`,\n      autoPlay: true,\n      loop: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    }) : '');\n  }\n\n  renderSettings() {\n    const _this$state2 = this.state,\n          characters = _this$state2.characters,\n          pets = _this$state2.pets,\n          selectedIndex = _this$state2.selectedIndex,\n          isModalOpen = _this$state2.isModalOpen,\n          zoom = _this$state2.zoom,\n          summary = _this$state2.summary,\n          selectedMap = _this$state2.selectedMap,\n          focusRenderable = _this$state2.focusRenderable,\n          backgroundColor = _this$state2.backgroundColor,\n          colorPickerOpen = _this$state2.colorPickerOpen,\n          language = _this$state2.language;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    return React.createElement(\"div\", {\n      className: \"settings-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"bg-color-picker-container\",\n      onClick: this.openColorPicker.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420\n      },\n      __self: this\n    }, \"Background color\", React.createElement(\"div\", {\n      className: \"bg-color-picker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"bg-color-grid\",\n      style: {\n        backgroundColor: bgColorText\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    })), colorPickerOpen ? React.createElement(SketchPicker, {\n      color: bgColorText,\n      onChange: this.onChangeColor.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425\n      },\n      __self: this\n    }) : ''), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428\n      },\n      __self: this\n    }, localized.zoom), React.createElement(Slider, {\n      value: zoom || 1,\n      min: 0.25,\n      max: 2,\n      step: 0.25,\n      handle: handle,\n      onChange: this.changeZoom.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438\n      },\n      __self: this\n    }, localized.language), React.createElement(\"select\", {\n      value: this.state.language,\n      onChange: this.changeLanguage.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"en\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440\n      },\n      __self: this\n    }, \"English\"), React.createElement(\"option\", {\n      value: \"jp\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441\n      },\n      __self: this\n    }, \"Japanese\"), React.createElement(\"option\", {\n      value: \"kr\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442\n      },\n      __self: this\n    }, \"Korean\"), React.createElement(\"option\", {\n      value: \"ch\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443\n      },\n      __self: this\n    }, \"Chinese (Traditional)\"), React.createElement(\"option\", {\n      value: \"nl\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444\n      },\n      __self: this\n    }, \"Dutch\"), React.createElement(\"option\", {\n      value: \"br\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445\n      },\n      __self: this\n    }, \"Portuguese (Brazil)\"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"map-select-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449\n      },\n      __self: this\n    }, React.createElement(VirtualizedSelect, {\n      filterOptions: mapsFilter,\n      isLoading: maps.length === 0,\n      name: \"map-selection\",\n      searchable: true,\n      clearable: true,\n      simpleValue: true,\n      value: selectedMap,\n      onChange: this.selectMap.bind(this),\n      options: maps,\n      maxHeight: 400,\n      styles: {\n        menuList: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        },\n        menu: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450\n      },\n      __self: this\n    }))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 478\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479\n      },\n      __self: this\n    }, localized.region), React.createElement(\"select\", {\n      value: this.state.region,\n      onChange: e => this.changeRegionVersion(e.target.value, \"328\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 480\n      },\n      __self: this\n    }, _.keys(this.state.versions).map(versionName => React.createElement(\"option\", {\n      value: versionName,\n      key: versionName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 481\n      },\n      __self: this\n    }, versionName)))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 484\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 485\n      },\n      __self: this\n    }, localized.version), React.createElement(\"select\", {\n      value: this.state.version,\n      onChange: e => this.changeRegionVersion(this.state.region, e.target.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486\n      },\n      __self: this\n    }, this.state.versions[this.state.region].map(({\n      mapleVersionId\n    }) => React.createElement(\"option\", {\n      value: mapleVersionId,\n      key: mapleVersionId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 487\n      },\n      __self: this\n    }, mapleVersionId)), React.createElement(\"option\", {\n      value: \"328\",\n      key: \"328\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488\n      },\n      __self: this\n    }, \"328\"))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 491\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 492\n      },\n      __self: this\n    }, localized.playMusic), React.createElement(Toggle, {\n      onChange: this.toggleMusic.bind(this),\n      checked: this.state.music,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 493\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      onClick: this.exportAllCharacters.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498\n      },\n      __self: this\n    }, \"Export All Characters\")));\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    });\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a');\n      a.style = 'display: none;';\n      document.body.appendChild(a);\n      const payload = JSON.stringify(character, null, 2),\n            blob = new Blob([payload], {\n        type: 'octet/stream'\n      }),\n            url = window.URL.createObjectURL(blob);\n      a.href = url;\n      if (character.name) a.download = character.name + '-data.json';else a.download = 'character-data.json';\n      a.click();\n      window.URL.revokeObjectURL(url);\n      a.remove();\n    });\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    });\n    localStorage['language'] = e.target.value;\n  }\n\n  changeZoom(newZoom) {\n    this.setState({\n      zoom: newZoom\n    });\n    localStorage['zoom'] = newZoom;\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    });\n    localStorage['selectedMap'] = mapId;\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps);\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps);\n  }\n\n  clickCanvas(e) {\n    this.onSetRightSidebarOpen(true);\n\n    if (e.target === e.currentTarget && this.state.characters.length + this.state.pets.length > 1) {\n      this.setState({\n        selectedIndex: false\n      });\n      localStorage['selectedIndex'] = 'false';\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()];\n    this.setState({\n      pets,\n      selectedIndex: this.state.characters.length + this.state.pets.length\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet);\n    this.setState({\n      pets,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any pet in case we delete the last pet\n\n    localStorage['pets'] = JSON.stringify(pets);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005];\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)];\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: {\n        x: 0,\n        y: 0\n      }\n    };\n  }\n\n  importCharacter(e) {\n    let target = e.target;\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase();\n\n        if (extension != 'json') {\n          console.warn('Not valid JSON file');\n          return;\n        }\n\n        let reader = new FileReader();\n\n        reader.onload = function (ev) {\n          let payload = ev.target.result;\n          let data = JSON.parse(payload);\n          res();\n          if (!data.id || data.type != 'character' || !data.selectedItems) return;\n          data.id = Date.now();\n          let characters = [...this.state.characters, data];\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          });\n          localStorage['characters'] = JSON.stringify(characters);\n        }.bind(this);\n\n        reader.readAsText(file, 'UTF8');\n      });\n    });\n    Promise.all(importAll).then(() => {\n      target.value = '';\n    });\n  }\n\n  addCharacter() {\n    var characters = [...this.state.characters, this.getNewCharacter()];\n    this.setState({\n      characters,\n      selectedIndex: this.state.characters.length\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character);\n    this.setState({\n      characters,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any character in case we delete the last character\n\n    localStorage['characters'] = JSON.stringify(characters);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  cloneCharacter(character) {\n    let characters = [...this.state.characters];\n    let indexOfCharacter = characters.indexOf(character);\n    characters.splice(indexOfCharacter + 1, 0, _objectSpread({}, character, {\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    }));\n    let newCharacterIndex = indexOfCharacter + 1;\n    this.setState({\n      characters,\n      selectedIndex: newCharacterIndex,\n      focusRenderable: newCharacterIndex + 1\n    });\n    localStorage['selectedIndex'] = newCharacterIndex;\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable);\n\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable);\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length;\n    }\n\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback);\n    localStorage['selectedIndex'] = selectedIndex;\n    localStorage['zoom'] = 1;\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const pets = [...this.state.pets];\n    const petIndex = pets.indexOf(pet);\n\n    const currentPet = pets[petIndex] = _objectSpread({}, pet, {}, newProps);\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`;\n    this.setState({\n      pets: pets\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const characters = [...this.state.characters];\n    const characterIndex = characters.indexOf(character);\n\n    const currentCharacter = characters[characterIndex] = _objectSpread({}, character, {}, newProps);\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n      var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id;\n      if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n      return itemEntry;\n    });\n\n    const backgroundColor = this.state.backgroundColor;\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    this.setState({\n      characters: characters\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {\n        x: 0,\n        y: 0\n      },\n      fhSnap: true\n    };\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex + 1 > this.state.characters.length) this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props);else this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props);\n  }\n\n  setModalOpen(isModalOpen) {\n    this.setState({\n      isModalOpen\n    });\n  }\n\n  userSelectedItem(item) {\n    let selectedRenderable = null;\n    if (this.state.selectedIndex + 1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length];else selectedRenderable = this.state.characters[this.state.selectedIndex];\n    item.region = localStorage['region'];\n    item.version = localStorage['version'];\n\n    let selectedItems = _objectSpread({}, selectedRenderable.selectedItems);\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top'];\n        delete selectedItems['Bottom'];\n      }\n    }\n\n    if (item.similar) {\n      item = _objectSpread({}, item);\n      delete item['similar'];\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item;\n    }\n\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItem(item) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    delete selectedItems[item.typeInfo.subCategory];\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems() {\n    let selectedItems = {};\n    this.updateItems(selectedItems);\n  }\n\n  updateItem(item, newProps) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    selectedItems[item.typeInfo.subCategory] = _objectSpread({}, item, {}, newProps);\n    this.updateItems(selectedItems);\n  }\n\n  updateItems(selectedItems) {\n    console.log('New Items: ', selectedItems);\n    this.updateSelectedRenderable({\n      selectedItems\n    });\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id;\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n        return itemEntry;\n      });\n\n      return _objectSpread({}, character);\n    });\n    this.setState({\n      backgroundColor,\n      characters\n    });\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor);\n  }\n\n  openColorPicker() {\n    this.setState({\n      colorPickerOpen: true\n    });\n  }\n\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = props => {\n  const value = props.value,\n        dragging = props.dragging,\n        index = props.index,\n        restProps = _objectWithoutProperties(props, [\"value\", \"dragging\", \"index\"]);\n\n  return React.createElement(RcTooltip, {\n    prefixCls: \"rc-slider-tooltip\",\n    overlay: value,\n    visible: dragging,\n    placement: \"top\",\n    style: {\n      border: \"solid 2px hsl(\" + value + \", 53%, 53%)\"\n    },\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 860\n    },\n    __self: this\n  }, React.createElement(Handle, Object.assign({\n    value: value\n  }, restProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 868\n    },\n    __self: this\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/19065019/react-test/src/components/App/index.js"],"names":["React","Component","ItemListing","EquippedItems","_","CharacterList","NotificationContainer","NotificationManager","RenderCanvas","axios","VirtualizedSelect","createFilterOptions","Slider","RcTooltip","SketchPicker","Localization","Localize","Tooltip","FontAwesome","Toggle","Sidebar","mql","window","matchMedia","localStorage","navigator","language","startsWith","creatingId","throttledErrorNotification","throttle","error","bind","leading","mapsIndexed","versions","GMS","region","MapleVersionId","IsReady","KMS","TMS","CMS","JMS","SEA","toCamel","o","newO","origKey","newKey","value","Array","map","hasOwnProperty","charAt","toLowerCase","slice","toString","constructor","Object","wzPromise","get","then","response","WZs","data","filter","wzEntry","isReady","groupBy","version","findIndex","ver","mapleVersionId","location","reload","console","log","maps","mapsFilter","mapPromise","label","streetName","name","join","id","options","App","props","isOpen","undefined","state","isModalOpen","characters","JSON","parse","pets","selectedIndex","selectedMap","zoom","mapPosition","x","y","backgroundColor","colorPickerOpen","music","sidebarDocked","matches","sidebarOpen","sidebarRDocked","sidebarROpen","length","setState","focusRenderable","isEmpty","selectedItems","currentCharacter","skin","push","getNewCharacter","stringify","forEach","character","index","Date","now","type","action","frame","emotion","mercEars","illiumEars","visible","position","flipX","includeBackground","characterItems","values","item","keyBy","typeInfo","subCategory","otherCharacters","allCharacters","pet","summary","petId","animation","document","addEventListener","handleClick","mapsLoaded","setTimeout","mediaQueryChanged","onSetSidebarOpen","onSetRightSidebarOpen","componentWillMount","addListener","componentWillUnmount","removeListener","open","changeRegionVersion","e","element","target","found","parentElement","className","render","localized","getLocalized","bgColorText","rgb","r","g","b","a","renderables","concat","userSelectedItem","overlay","zIndex","sidebar","width","boxShadow","content","top","updateRenderable","clickCanvas","userUpdateSelectedRenderable","addCharacter","addPet","importCharacter","removeCharacter","cloneCharacter","removePet","renderable","userUpdateCharacter","userUpdatePet","userRemovedItem","updateItem","userRemovedItems","root","left","WebkitOverflowScrolling","renderSettings","openColorPicker","onChangeColor","handle","changeZoom","changeLanguage","selectMap","menuList","styles","height","menu","keys","versionName","playMusic","toggleMusic","exportAllCharacters","createElement","style","body","appendChild","payload","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","remove","newZoom","mapId","newProps","currentTarget","getNewPet","c","andysFavePetIds","Math","floor","random","fhSnap","importAll","prototype","call","files","file","Promise","res","rej","extension","substr","lastIndexOf","warn","reader","FileReader","onload","ev","result","readAsText","all","indexOfCharacter","indexOf","splice","newCharacterIndex","callback","locked","petIndex","currentPet","characterIndex","itemsWithEmotion","itemEntry","hue","updateSelectedRenderable","setModalOpen","selectedRenderable","similar","updateItems","event","createSliderWithTooltip","Range","Handle","dragging","restProps","border"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport './index.css'\nimport ItemListing from '../ItemListing'\nimport EquippedItems from '../EquippedItems'\nimport _ from 'lodash'\nimport CharacterList from '../CharacterList'\nimport 'react-notifications/lib/notifications.css'\nimport {NotificationContainer, NotificationManager} from 'react-notifications'\nimport RenderCanvas from '../RenderCanvas'\nimport axios from 'axios'\nimport VirtualizedSelect from 'react-virtualized-select'\n\nimport createFilterOptions from 'react-select-fast-filter-options'\nimport Slider from 'rc-slider'\nimport RcTooltip from 'rc-tooltip'\nimport { SketchPicker } from 'react-color'\nimport Localization from '../../const/localize'\nimport Localize from '../../const/localize'\nimport { Tooltip } from 'react-tippy'\nimport FontAwesome from 'react-fontawesome'\nimport 'rc-slider/assets/index.css'\nimport 'rc-tooltip/assets/bootstrap.css'\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle'\nimport Sidebar from \"react-sidebar\";\nconst mql = window.matchMedia(`(min-width: 800px)`);\n\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS'\n  localStorage['version'] = '328'\n  localStorage['initialized'] = '2'\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr'\n  else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp'\n  else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch'\n  else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl'\n  else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br'\n  else localStorage['language'] = 'en'\n}\n\nvar creatingId = null\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, { leading:true })\nlet mapsIndexed = null\nlet versions = {\n  GMS: [{region: \"GMS\", MapleVersionId: \"latest\", IsReady: true}],\n  KMS: [{region: \"KMS\", MapleVersionId: \"328\", IsReady: true}],\n  TMS: [{region: \"TMS\", MapleVersionId: \"latest\", IsReady: true}],\n  CMS: [{region: \"CMS\", MapleVersionId: \"latest\", IsReady: true}],\n  JMS: [{region: \"JMS\", MapleVersionId: \"latest\", IsReady: true}],\n  SEA: [{region: \"SEA\", MapleVersionId: \"latest\", IsReady: true}]\n}\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value\n  if (o instanceof Array) {\n    return o.map(function(value) {\n        if (typeof value === \"object\") {\n          value = toCamel(value)\n        }\n        return value\n    })\n  } else {\n    newO = {}\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString()\n        value = o[origKey]\n        if (value instanceof Array || (value !== null && value.constructor === Object)) {\n          value = toCamel(value)\n        }\n        newO[newKey] = value\n      }\n    }\n  }\n  return newO\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`)\n.then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return {\n      ...wzEntry,\n      region: wzEntry.region\n    }\n  })\n  versions = _.groupBy(WZs, 'region')\n\n  let region = localStorage['region'], version = localStorage['version']\n\n  if (!region || (version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1)) {\n    localStorage['region'] = 'KMS'\n    localStorage['version'] = '328'\n    window.location.reload()\n  }\n\n  console.log(versions);\n  return versions;\n})\n\nlet maps = []\nlet mapsFilter = null\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n      maps = _.map(response.data, map => {\n        return {\n          label: [map.streetName, map.name].join(' - '),\n          value: map.id\n        }\n      });\n      mapsFilter = createFilterOptions({options: maps})\n    });\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    let isOpen = (localStorage || {})['hideModal'] !== 'true'\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined')\n      isOpen = true\n\n    // Try to recover any existing state\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {x: 0, y: 0},\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\"hsl\":{\"h\":0,\"s\":0,\"l\":0,\"a\":0},\"hex\":\"transparent\",\"rgb\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0},\"hsv\":{\"h\":0,\"s\":0,\"v\":0,\"a\":0},\"oldHue\":0,\"source\":\"rgb\"},\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarDocked: mql.matches,\n      sidebarOpen: false,\n      sidebarRDocked: mql.matches,\n      sidebarROpen: false,\n      versions\n    }\n\n    if (versions.KMS.length > 1)\n      this.state.versions = versions\n    else\n      wzPromise.then(ver => this.setState({versions}))\n\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex\n\n    // If we have a legacy character, upgrade to latest now\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      }\n      if (this.state.characters[0] === false)\n        this.state.characters[0] = currentCharacter;\n      else\n        this.state.characters.push(currentCharacter)\n    }\n\n    // If we have no characters at all, gen a new shell\n    if (this.state.characters[0] === false)\n      this.state.characters[0] = this.getNewCharacter()\n\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter'])\n      delete localStorage['currentCharacter']\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state])\n      this.state['characters'] = [...this.state.characters, this.state]\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1)\n      character.type = 'character'\n      character.action = character.action || 'stand1'\n      character.frame = character.frame || 0\n      character.zoom = character.zoom || 1\n      character.emotion = character.emotion || 'default'\n      character.skin = character.skin || 2000\n      character.mercEars = character.mercEars || false\n      character.illiumEars = character.illiumEars || false\n      character.selectedItems = character.selectedItems || []\n      character.visible = character.visible || false\n      character.position = character.position || {x:0,y:0}\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region']\n        if (!item.version) item.version = localStorage['version']\n        return item\n      })\n      character.selectedItems = _.keyBy(characterItems, (item) => item.typeInfo.subCategory)\n      delete character.characters\n      delete character.otherCharacters\n      delete character.allCharacters\n    })\n\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1)\n      pet.type = 'pet'\n      pet.position = pet.position || { x: 0, y: 0}\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`\n    })\n\n    if ((this.state.selectedIndex + 1) > (this.state.characters.length + this.state.pets.length) || !this.state.characters.length)\n      this.state.selectedIndex = false;\n\n\n    document.addEventListener(\"click\", this.handleClick.bind(this))\n\n    if (maps.length) this.state.mapsLoaded = true\n    else mapPromise.then(() => setTimeout(() => this.setState({mapsLoaded : true}), 250))\n    this.mediaQueryChanged = this.mediaQueryChanged.bind(this);\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n    this.onSetRightSidebarOpen = this.onSetRightSidebarOpen.bind(this);\n  }\n\n  componentWillMount() {\n    mql.addListener(this.mediaQueryChanged);\n  }\n\n  componentWillUnmount() {\n    mql.removeListener(this.mediaQueryChanged);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({ sidebarOpen: open });\n    if(!this.state.sidebarDocked && this.state.sidebarOpen){\n      this.setState({ sidebarOpen: false });\n    }\n  }\n\n  onSetRightSidebarOpen(open) {\n    this.setState({ sidebarROpen: open });\n    if(!this.state.sidebarRDocked && this.state.sidebarROpen){\n      this.setState({ sidebarROpen: false });\n    }\n  }\n\n  mediaQueryChanged() {\n    this.setState({ sidebarDocked: mql.matches, sidebarOpen: false, sidebarRDocked: mql.matches, sidebarROpen: false });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region\n    localStorage['version'] = version\n\n    // Much easier than trying to reload everything here :D\n    window.location.reload()\n  }\n\n  handleClick(e) {\n    let element = e.target\n    let found = false\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;\n      else {\n        found = true;\n        console.log('found bg-color-picker-container')\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({ colorPickerOpen: false })\n  }\n\n\n  render() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language,\n      music\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n\n    const renderables = characters.concat(pets)\n\n    return (\n      <div className={\"App\"}>\n      <div className=\"App-header\">\n          <span className='item-span' onClick={() => this.onSetSidebarOpen(true)}>&#9776;</span>\n        </div>\n      { (selectedIndex !== false) ?\n        <Sidebar\n          sidebar={<ItemListing\n            target={renderables[selectedIndex]}\n            onItemSelected={this.userSelectedItem.bind(this)}\n            localized={localized} />}\n            open={this.state.sidebarOpen}\n          docked={this.state.sidebarDocked}\n          onSetOpen={this.onSetSidebarOpen}\n          styles={{\n           overlay: {\n             zIndex: !this.state.sidebarDocked && this.state.sidebarOpen ? 3001 : 2000,\n           },\n           sidebar: {\n             width: 300,\n             zIndex: 4000,\n             boxShadow: (this.state.sidebarDocked || !this.state.sidebarOpen) ? 'none' : 'rgba(0, 0, 0, 0.15) 2px 2px 2px;',\n           },\n           content: {\n             top: 64,\n           },\n         }}></Sidebar> : '' }\n        <RenderCanvas\n          backgroundColor={bgColorText}\n          zoom={zoom}\n          mapId={selectedMap}\n          renderables={renderables}\n          selectedRenderable={selectedIndex}\n          focusRenderable={focusRenderable === undefined ? selectedIndex : focusRenderable}\n          onUpdateRenderable={this.updateRenderable.bind(this)}\n          onClick={this.clickCanvas.bind(this)}\n          localized={localized}\n          onClickRenderable={this.userUpdateSelectedRenderable.bind(this)}/>\n\n        <CharacterList\n          renderables={renderables}\n          selectedIndex={selectedIndex}\n          onAddCharacter={this.addCharacter.bind(this)}\n          onAddPet={this.addPet.bind(this)}\n          onImportCharacter={this.importCharacter.bind(this)}\n          onDeleteCharacter={this.removeCharacter.bind(this)}\n          onCloneCharacter={this.cloneCharacter.bind(this)}\n          onDeletePet={this.removePet.bind(this)}\n          localized={localized}\n          onUpdateSelectedCharacter={function (renderable) {\n            this.userUpdateSelectedRenderable(renderable, () => {\n              this.setState({\n                focusRenderable: this.state.selectedIndex\n              })\n            })\n          }.bind(this)}\n          onUpdateCharacter={this.userUpdateCharacter.bind(this)}\n          onUpdatePet={this.userUpdatePet.bind(this) }/>\n        {\n          (selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ?\n          <Sidebar\n            sidebar={<EquippedItems\n              equippedItems={renderables[selectedIndex].selectedItems}\n              onRemoveItem={this.userRemovedItem.bind(this)}\n              name={renderables[selectedIndex].name}\n              skinId={renderables[selectedIndex].skin}\n              onUpdateItem={this.updateItem.bind(this)}\n              localized={localized}\n              onRemoveItems={this.userRemovedItems.bind(this)} />}\n              open={this.state.sidebarROpen}\n            docked={this.state.sidebarRDocked}\n            onSetOpen={this.onSetRightSidebarOpen}\n            pullRight={true}\n            shadow={false}\n            styles={{\n            root: {\n               left: 800\n             },\n             overlay: {\n               zIndex: !this.state.sidebarRDocked && this.state.sidebarROpen ? 3001 : 2000,\n             },\n             sidebar: {\n               width: 300,\n               zIndex: 4001,\n               boxShadow: (this.state.sidebarRDocked || !this.state.sidebarROpen) ? 'none' : 'rgba(0, 0, 0, 0.15) 2px 2px 2px;',\n             },\n             content: {\n               top: 64,\n               WebkitOverflowScrolling: \"\"\n             },\n           }}></Sidebar> : '')\n        }\n\n\n        <NotificationContainer />\n        { music ? <audio src={`//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`} autoPlay={true} loop={true} /> : '' }\n      </div>\n    )\n  }\n\n  renderSettings() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n    return (\n      <div className='settings-container'>\n        <label className='bg-color-picker-container' onClick={this.openColorPicker.bind(this)}>\n        Background color\n          <div className='bg-color-picker'>\n            <div className='bg-color-grid' style={{ backgroundColor: bgColorText }}></div>\n          </div>\n          { colorPickerOpen ? <SketchPicker color={bgColorText} onChange={this.onChangeColor.bind(this)} /> : '' }\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.zoom}</span>\n          <Slider\n            value={zoom || 1}\n            min={0.25}\n            max={2}\n            step={0.25}\n            handle={handle}\n            onChange={this.changeZoom.bind(this)} />\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.language}</span>\n          <select value={this.state.language} onChange={this.changeLanguage.bind(this)}>\n            <option value='en'>English</option>\n            <option value='jp'>Japanese</option>\n            <option value='kr'>Korean</option>\n            <option value='ch'>Chinese (Traditional)</option>\n            <option value='nl'>Dutch</option>\n            <option value='br'>Portuguese (Brazil)</option>\n          </select>\n        </label>\n        <div>\n          <div className='map-select-container'>\n            <VirtualizedSelect\n              filterOptions={mapsFilter}\n              isLoading={maps.length === 0}\n              name='map-selection'\n              searchable\n              clearable\n              simpleValue\n              value={selectedMap}\n              onChange={this.selectMap.bind(this)}\n              options={maps}\n              maxHeight={400}\n              styles={{\n                menuList: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                },\n                menu: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                }\n              }}\n              />\n          </div>\n        </div>\n        <label>\n          <span>{localized.region}</span>\n          <select value={this.state.region} onChange={(e) => this.changeRegionVersion(e.target.value, \"328\")}>\n            { _.keys(this.state.versions).map(versionName => <option value={versionName} key={versionName}>{versionName}</option>) }\n          </select>\n        </label>\n        <label>\n          <span>{localized.version}</span>\n          <select value={this.state.version} onChange={(e) => this.changeRegionVersion(this.state.region, e.target.value)}>\n            { this.state.versions[this.state.region].map(({mapleVersionId}) => <option value={mapleVersionId} key={mapleVersionId}>{mapleVersionId}</option>) }\n            <option value='328' key='328'>328</option>\n          </select>\n        </label>\n        <label>\n          <span>{localized.playMusic}</span>\n          <Toggle\n            onChange={this.toggleMusic.bind(this)}\n            checked={this.state.music} />\n        </label>\n        <label>\n          <a href='#' onClick={this.exportAllCharacters.bind(this)}>Export All Characters</a>\n        </label>\n      </div>\n    )\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    })\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a')\n      a.style = 'display: none;'\n      document.body.appendChild(a)\n\n      const payload = JSON.stringify(character, null, 2),\n        blob = new Blob([payload], {type: 'octet/stream'}),\n        url = window.URL.createObjectURL(blob)\n      a.href = url\n      if (character.name)\n        a.download = character.name + '-data.json'\n      else\n        a.download = 'character-data.json'\n      a.click()\n\n      window.URL.revokeObjectURL(url)\n      a.remove()\n    })\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    })\n    localStorage['language'] = e.target.value\n  }\n\n  changeZoom(newZoom) {\n    this.setState({ zoom: newZoom })\n    localStorage['zoom'] = newZoom\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    })\n    localStorage['selectedMap'] = mapId\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps)\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps)\n  }\n\n  clickCanvas(e) {\n    this.onSetRightSidebarOpen(true)\n    if (e.target === e.currentTarget && (this.state.characters.length + this.state.pets.length) > 1) {\n      this.setState({ selectedIndex: false })\n      localStorage['selectedIndex'] = 'false'\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()]\n    this.setState({pets, selectedIndex: this.state.characters.length + this.state.pets.length})\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet)\n    this.setState({ pets, selectedIndex: false, zoom: 1 }) // Unselect any pet in case we delete the last pet\n    localStorage['pets'] = JSON.stringify(pets)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005]\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)]\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: { x:0, y:0 }\n    }\n  }\n\n  importCharacter(e) {\n    let target = e.target\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase()\n        if (extension != 'json') {\n          console.warn('Not valid JSON file')\n          return\n        }\n\n        let reader = new FileReader()\n        reader.onload = function (ev) {\n          let payload = ev.target.result\n          let data = JSON.parse(payload)\n\n          res()\n          if (!data.id || data.type != 'character' || !data.selectedItems) return\n\n          data.id = Date.now()\n\n          let characters = [\n            ...this.state.characters,\n            data\n          ]\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          })\n          localStorage['characters'] = JSON.stringify(characters)\n        }.bind(this)\n\n        reader.readAsText(file, 'UTF8')\n      })\n    })\n\n    Promise.all(importAll).then(() => {\n      target.value = ''\n    })\n  }\n\n  addCharacter() {\n    var characters = [ ...this.state.characters, this.getNewCharacter() ]\n    this.setState({ characters, selectedIndex: this.state.characters.length })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character)\n    this.setState({ characters, selectedIndex: false, zoom: 1 }) // Unselect any character in case we delete the last character\n    localStorage['characters'] = JSON.stringify(characters)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  cloneCharacter(character) {\n    let characters = [\n      ...this.state.characters\n    ]\n\n    let indexOfCharacter = characters.indexOf(character)\n    characters.splice(indexOfCharacter + 1, 0, {\n      ...character,\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    })\n    let newCharacterIndex = indexOfCharacter + 1\n\n    this.setState({ characters, selectedIndex: newCharacterIndex, focusRenderable: newCharacterIndex + 1 })\n    localStorage['selectedIndex'] = newCharacterIndex\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable)\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable)\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length\n    }\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback)\n    localStorage['selectedIndex'] = selectedIndex\n    localStorage['zoom'] = 1\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const pets = [...this.state.pets]\n    const petIndex = pets.indexOf(pet)\n\n    const currentPet = pets[petIndex] = {\n      ...pet,\n      ...newProps\n    }\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`\n\n    this.setState({\n        pets: pets\n    })\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const characters = [...this.state.characters]\n    const characterIndex = characters.indexOf(character)\n\n    const currentCharacter = characters[characterIndex] = {\n      ...character,\n      ...newProps\n    }\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n    const { backgroundColor } = this.state\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    this.setState({\n        characters: characters\n    })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {x: 0, y: 0},\n      fhSnap: true\n    }\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex+1 > this.state.characters.length)\n      this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props)\n    else\n      this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props)\n  }\n\n  setModalOpen (isModalOpen) {\n    this.setState({ isModalOpen })\n  }\n\n  userSelectedItem (item) {\n    let selectedRenderable = null\n    if (this.state.selectedIndex+1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length]\n    else selectedRenderable = this.state.characters[this.state.selectedIndex]\n\n    item.region = localStorage['region']\n    item.version = localStorage['version']\n\n    let selectedItems = {\n      ...selectedRenderable.selectedItems,\n    }\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top']\n        delete selectedItems['Bottom']\n      }\n    }\n\n    if (item.similar) {\n      item = { ...item }\n      delete item['similar']\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item\n    }\n    this.updateItems(selectedItems)\n  }\n\n  userRemovedItem (item) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    delete selectedItems[item.typeInfo.subCategory]\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems () {\n    let selectedItems = {}\n    this.updateItems(selectedItems);\n  }\n\n  updateItem (item, newProps) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    selectedItems[item.typeInfo.subCategory] = {\n      ...item,\n      ...newProps\n    }\n    this.updateItems(selectedItems);\n  }\n\n  updateItems (selectedItems) {\n    console.log('New Items: ', selectedItems)\n    this.updateSelectedRenderable({\n      selectedItems\n    })\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n      return {\n        ...character\n      }\n    });\n\n    this.setState({ backgroundColor, characters })\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor)\n  }\n\n  openColorPicker() {\n    this.setState({ colorPickerOpen: true })\n  }\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = (props) => {\n  const { value, dragging, index, ...restProps } = props;\n  return (\n    <RcTooltip\n      prefixCls=\"rc-slider-tooltip\"\n      overlay={value}\n      visible={dragging}\n      placement=\"top\"\n      style={{border: \"solid 2px hsl(\"+value+\", 53%, 53%)\"}}\n      key={index}\n    >\n      <Handle value={value} {...restProps} />\n    </RcTooltip>\n  );\n};\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}