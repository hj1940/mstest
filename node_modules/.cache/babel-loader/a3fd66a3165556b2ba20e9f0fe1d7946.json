{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"C:\\\\Users\\\\19065019\\\\react-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\19065019\\\\react-test\\\\src\\\\components\\\\App\\\\index.js\";\nimport React, { Component } from 'react';\nimport './index.css';\nimport ItemListing from '../ItemListing';\nimport EquippedItems from '../EquippedItems';\nimport _ from 'lodash';\nimport CharacterList from '../CharacterList';\nimport 'react-notifications/lib/notifications.css';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport RenderCanvas from '../RenderCanvas';\nimport axios from 'axios';\nimport VirtualizedSelect from 'react-virtualized-select';\nimport createFilterOptions from 'react-select-fast-filter-options';\nimport Slider from 'rc-slider';\nimport RcTooltip from 'rc-tooltip';\nimport { SketchPicker } from 'react-color';\nimport Localization from '../../const/localize';\nimport Localize from '../../const/localize';\nimport { Tooltip } from 'react-tippy';\nimport FontAwesome from 'react-fontawesome';\nimport 'rc-slider/assets/index.css';\nimport 'rc-tooltip/assets/bootstrap.css';\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle';\nimport Sidebar from \"react-sidebar\";\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS';\n  localStorage['version'] = '328';\n  localStorage['initialized'] = '2';\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr';else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp';else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch';else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl';else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br';else localStorage['language'] = 'en';\n}\n\nvar creatingId = null;\n\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, {\n  leading: true\n});\n\nlet mapsIndexed = null;\nlet versions = {\n  GMS: [{\n    region: \"GMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  KMS: [{\n    region: \"KMS\",\n    MapleVersionId: \"328\",\n    IsReady: true\n  }],\n  TMS: [{\n    region: \"TMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  CMS: [{\n    region: \"CMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  JMS: [{\n    region: \"JMS\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }],\n  SEA: [{\n    region: \"SEA\",\n    MapleVersionId: \"latest\",\n    IsReady: true\n  }]\n};\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value;\n\n  if (o instanceof Array) {\n    return o.map(function (value) {\n      if (typeof value === \"object\") {\n        value = toCamel(value);\n      }\n\n      return value;\n    });\n  } else {\n    newO = {};\n\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString();\n        value = o[origKey];\n\n        if (value instanceof Array || value !== null && value.constructor === Object) {\n          value = toCamel(value);\n        }\n\n        newO[newKey] = value;\n      }\n    }\n  }\n\n  return newO;\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`).then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return _objectSpread({}, wzEntry, {\n      region: wzEntry.region\n    });\n  });\n\n  versions = _.groupBy(WZs, 'region');\n  let region = localStorage['region'],\n      version = localStorage['version'];\n\n  if (!region || version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1) {\n    localStorage['region'] = 'KMS';\n    localStorage['version'] = '328';\n    window.location.reload();\n  }\n\n  console.log(versions);\n  return versions;\n});\nlet maps = [];\nlet mapsFilter = null;\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n  maps = _.map(response.data, map => {\n    return {\n      label: [map.streetName, map.name].join(' - '),\n      value: map.id\n    };\n  });\n  mapsFilter = createFilterOptions({\n    options: maps\n  });\n});\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    let isOpen = (localStorage || {})['hideModal'] !== 'true';\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined') isOpen = true; // Try to recover any existing state\n\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {\n        x: 0,\n        y: 0\n      },\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\n        \"hsl\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"l\": 0,\n          \"a\": 0\n        },\n        \"hex\": \"transparent\",\n        \"rgb\": {\n          \"r\": 0,\n          \"g\": 0,\n          \"b\": 0,\n          \"a\": 0\n        },\n        \"hsv\": {\n          \"h\": 0,\n          \"s\": 0,\n          \"v\": 0,\n          \"a\": 0\n        },\n        \"oldHue\": 0,\n        \"source\": \"rgb\"\n      },\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarOpen: true,\n      versions\n    };\n    if (versions.KMS.length > 1) this.state.versions = versions;else wzPromise.then(ver => this.setState({\n      versions\n    }));\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex; // If we have a legacy character, upgrade to latest now\n\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      };\n      if (this.state.characters[0] === false) this.state.characters[0] = currentCharacter;else this.state.characters.push(currentCharacter);\n    } // If we have no characters at all, gen a new shell\n\n\n    if (this.state.characters[0] === false) this.state.characters[0] = this.getNewCharacter();\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter']);\n      delete localStorage['currentCharacter'];\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state]);\n      this.state['characters'] = [...this.state.characters, this.state];\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1);\n      character.type = 'character';\n      character.action = character.action || 'stand1';\n      character.frame = character.frame || 0;\n      character.zoom = character.zoom || 1;\n      character.emotion = character.emotion || 'default';\n      character.skin = character.skin || 2000;\n      character.mercEars = character.mercEars || false;\n      character.illiumEars = character.illiumEars || false;\n      character.selectedItems = character.selectedItems || [];\n      character.visible = character.visible || false;\n      character.position = character.position || {\n        x: 0,\n        y: 0\n      };\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground;\n\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region'];\n        if (!item.version) item.version = localStorage['version'];\n        return item;\n      });\n\n      character.selectedItems = _.keyBy(characterItems, item => item.typeInfo.subCategory);\n      delete character.characters;\n      delete character.otherCharacters;\n      delete character.allCharacters;\n    });\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1);\n      pet.type = 'pet';\n      pet.position = pet.position || {\n        x: 0,\n        y: 0\n      };\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`;\n    });\n    if (this.state.selectedIndex + 1 > this.state.characters.length + this.state.pets.length || !this.state.characters.length) this.state.selectedIndex = false;\n    document.addEventListener(\"click\", this.handleClick.bind(this));\n    if (maps.length) this.state.mapsLoaded = true;else mapPromise.then(() => setTimeout(() => this.setState({\n      mapsLoaded: true\n    }), 250));\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({\n      sidebarOpen: open\n    });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region;\n    localStorage['version'] = version; // Much easier than trying to reload everything here :D\n\n    window.location.reload();\n  }\n\n  handleClick(e) {\n    let element = e.target;\n    let found = false;\n\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;else {\n        found = true;\n        console.log('found bg-color-picker-container');\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({\n      colorPickerOpen: false\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          characters = _this$state.characters,\n          pets = _this$state.pets,\n          selectedIndex = _this$state.selectedIndex,\n          isModalOpen = _this$state.isModalOpen,\n          zoom = _this$state.zoom,\n          summary = _this$state.summary,\n          selectedMap = _this$state.selectedMap,\n          focusRenderable = _this$state.focusRenderable,\n          backgroundColor = _this$state.backgroundColor,\n          colorPickerOpen = _this$state.colorPickerOpen,\n          language = _this$state.language,\n          music = _this$state.music;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    const renderables = characters.concat(pets);\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"App-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"logo\",\n      onClick: () => this.onSetSidebarOpen(true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, \"\\u261A\")), React.createElement(RenderCanvas, {\n      backgroundColor: bgColorText,\n      zoom: zoom,\n      mapId: selectedMap,\n      renderables: renderables,\n      selectedRenderable: selectedIndex,\n      focusRenderable: focusRenderable === undefined ? selectedIndex : focusRenderable,\n      onUpdateRenderable: this.updateRenderable.bind(this),\n      onClick: this.clickCanvas.bind(this),\n      localized: localized,\n      onClickRenderable: this.userUpdateSelectedRenderable.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }), selectedIndex !== false ? React.createElement(Sidebar, {\n      sidebar: React.createElement(ItemListing, {\n        target: renderables[selectedIndex],\n        onItemSelected: this.userSelectedItem.bind(this),\n        localized: localized,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }),\n      open: this.state.sidebarOpen,\n      onSetOpen: this.onSetSidebarOpen,\n      styles: {\n        content: {\n          overflowY: 'auto'\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }) : '', React.createElement(CharacterList, {\n      renderables: renderables,\n      selectedIndex: selectedIndex,\n      onAddCharacter: this.addCharacter.bind(this),\n      onAddPet: this.addPet.bind(this),\n      onImportCharacter: this.importCharacter.bind(this),\n      onDeleteCharacter: this.removeCharacter.bind(this),\n      onCloneCharacter: this.cloneCharacter.bind(this),\n      onDeletePet: this.removePet.bind(this),\n      localized: localized,\n      onUpdateSelectedCharacter: function (renderable) {\n        this.userUpdateSelectedRenderable(renderable, () => {\n          this.setState({\n            focusRenderable: this.state.selectedIndex\n          });\n        });\n      }.bind(this),\n      onUpdateCharacter: this.userUpdateCharacter.bind(this),\n      onUpdatePet: this.userUpdatePet.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }), selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ? React.createElement(EquippedItems, {\n      equippedItems: renderables[selectedIndex].selectedItems,\n      onRemoveItem: this.userRemovedItem.bind(this),\n      name: renderables[selectedIndex].name,\n      skinId: renderables[selectedIndex].skin,\n      onUpdateItem: this.updateItem.bind(this),\n      localized: localized,\n      onRemoveItems: this.userRemovedItems.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }) : '', React.createElement(\"div\", {\n      className: \"disclaimer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, localized.prototype)), React.createElement(NotificationContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }), music ? React.createElement(\"audio\", {\n      src: `//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`,\n      autoPlay: true,\n      loop: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }) : '');\n  }\n\n  renderSettings() {\n    const _this$state2 = this.state,\n          characters = _this$state2.characters,\n          pets = _this$state2.pets,\n          selectedIndex = _this$state2.selectedIndex,\n          isModalOpen = _this$state2.isModalOpen,\n          zoom = _this$state2.zoom,\n          summary = _this$state2.summary,\n          selectedMap = _this$state2.selectedMap,\n          focusRenderable = _this$state2.focusRenderable,\n          backgroundColor = _this$state2.backgroundColor,\n          colorPickerOpen = _this$state2.colorPickerOpen,\n          language = _this$state2.language;\n    const localized = Localize.getLocalized(language);\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`;\n    return React.createElement(\"div\", {\n      className: \"settings-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"bg-color-picker-container\",\n      onClick: this.openColorPicker.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, \"Background color\", React.createElement(\"div\", {\n      className: \"bg-color-picker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"bg-color-grid\",\n      style: {\n        backgroundColor: bgColorText\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    })), colorPickerOpen ? React.createElement(SketchPicker, {\n      color: bgColorText,\n      onChange: this.onChangeColor.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363\n      },\n      __self: this\n    }) : ''), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366\n      },\n      __self: this\n    }, localized.zoom), React.createElement(Slider, {\n      value: zoom || 1,\n      min: 0.25,\n      max: 2,\n      step: 0.25,\n      handle: handle,\n      onChange: this.changeZoom.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"canvas-zoom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376\n      },\n      __self: this\n    }, localized.language), React.createElement(\"select\", {\n      value: this.state.language,\n      onChange: this.changeLanguage.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"en\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    }, \"English\"), React.createElement(\"option\", {\n      value: \"jp\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 379\n      },\n      __self: this\n    }, \"Japanese\"), React.createElement(\"option\", {\n      value: \"kr\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380\n      },\n      __self: this\n    }, \"Korean\"), React.createElement(\"option\", {\n      value: \"ch\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381\n      },\n      __self: this\n    }, \"Chinese (Traditional)\"), React.createElement(\"option\", {\n      value: \"nl\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382\n      },\n      __self: this\n    }, \"Dutch\"), React.createElement(\"option\", {\n      value: \"br\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, \"Portuguese (Brazil)\"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"map-select-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, React.createElement(VirtualizedSelect, {\n      filterOptions: mapsFilter,\n      isLoading: maps.length === 0,\n      name: \"map-selection\",\n      searchable: true,\n      clearable: true,\n      simpleValue: true,\n      value: selectedMap,\n      onChange: this.selectMap.bind(this),\n      options: maps,\n      maxHeight: 400,\n      styles: {\n        menuList: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        },\n        menu: (styles, {\n          data\n        }) => {\n          return _objectSpread({}, styles, {\n            height: '400px'\n          });\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417\n      },\n      __self: this\n    }, localized.region), React.createElement(\"select\", {\n      value: this.state.region,\n      onChange: e => this.changeRegionVersion(e.target.value, \"328\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418\n      },\n      __self: this\n    }, _.keys(this.state.versions).map(versionName => React.createElement(\"option\", {\n      value: versionName,\n      key: versionName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419\n      },\n      __self: this\n    }, versionName)))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    }, localized.version), React.createElement(\"select\", {\n      value: this.state.version,\n      onChange: e => this.changeRegionVersion(this.state.region, e.target.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424\n      },\n      __self: this\n    }, this.state.versions[this.state.region].map(({\n      mapleVersionId\n    }) => React.createElement(\"option\", {\n      value: mapleVersionId,\n      key: mapleVersionId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425\n      },\n      __self: this\n    }, mapleVersionId)), React.createElement(\"option\", {\n      value: \"328\",\n      key: \"328\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426\n      },\n      __self: this\n    }, \"328\"))), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430\n      },\n      __self: this\n    }, localized.playMusic), React.createElement(Toggle, {\n      onChange: this.toggleMusic.bind(this),\n      checked: this.state.music,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      onClick: this.exportAllCharacters.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436\n      },\n      __self: this\n    }, \"Export All Characters\")));\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    });\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a');\n      a.style = 'display: none;';\n      document.body.appendChild(a);\n      const payload = JSON.stringify(character, null, 2),\n            blob = new Blob([payload], {\n        type: 'octet/stream'\n      }),\n            url = window.URL.createObjectURL(blob);\n      a.href = url;\n      if (character.name) a.download = character.name + '-data.json';else a.download = 'character-data.json';\n      a.click();\n      window.URL.revokeObjectURL(url);\n      a.remove();\n    });\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    });\n    localStorage['language'] = e.target.value;\n  }\n\n  changeZoom(newZoom) {\n    this.setState({\n      zoom: newZoom\n    });\n    localStorage['zoom'] = newZoom;\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    });\n    localStorage['selectedMap'] = mapId;\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps);\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps);\n  }\n\n  clickCanvas(e) {\n    if (e.target === e.currentTarget && this.state.characters.length + this.state.pets.length > 1) {\n      this.setState({\n        selectedIndex: false\n      });\n      localStorage['selectedIndex'] = 'false';\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()];\n    this.setState({\n      pets,\n      selectedIndex: this.state.characters.length + this.state.pets.length\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet);\n    this.setState({\n      pets,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any pet in case we delete the last pet\n\n    localStorage['pets'] = JSON.stringify(pets);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005];\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)];\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: {\n        x: 0,\n        y: 0\n      }\n    };\n  }\n\n  importCharacter(e) {\n    let target = e.target;\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase();\n\n        if (extension != 'json') {\n          console.warn('Not valid JSON file');\n          return;\n        }\n\n        let reader = new FileReader();\n\n        reader.onload = function (ev) {\n          let payload = ev.target.result;\n          let data = JSON.parse(payload);\n          res();\n          if (!data.id || data.type != 'character' || !data.selectedItems) return;\n          data.id = Date.now();\n          let characters = [...this.state.characters, data];\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          });\n          localStorage['characters'] = JSON.stringify(characters);\n        }.bind(this);\n\n        reader.readAsText(file, 'UTF8');\n      });\n    });\n    Promise.all(importAll).then(() => {\n      target.value = '';\n    });\n  }\n\n  addCharacter() {\n    var characters = [...this.state.characters, this.getNewCharacter()];\n    this.setState({\n      characters,\n      selectedIndex: this.state.characters.length\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character);\n    this.setState({\n      characters,\n      selectedIndex: false,\n      zoom: 1\n    }); // Unselect any character in case we delete the last character\n\n    localStorage['characters'] = JSON.stringify(characters);\n    localStorage['selectedIndex'] = false;\n    localStorage['zoom'] = 1;\n  }\n\n  cloneCharacter(character) {\n    let characters = [...this.state.characters];\n    let indexOfCharacter = characters.indexOf(character);\n    characters.splice(indexOfCharacter + 1, 0, _objectSpread({}, character, {\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    }));\n    let newCharacterIndex = indexOfCharacter + 1;\n    this.setState({\n      characters,\n      selectedIndex: newCharacterIndex,\n      focusRenderable: newCharacterIndex + 1\n    });\n    localStorage['selectedIndex'] = newCharacterIndex;\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable);\n\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable);\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length;\n    }\n\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback);\n    localStorage['selectedIndex'] = selectedIndex;\n    localStorage['zoom'] = 1;\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const pets = [...this.state.pets];\n    const petIndex = pets.indexOf(pet);\n\n    const currentPet = pets[petIndex] = _objectSpread({}, pet, {}, newProps);\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`;\n    this.setState({\n      pets: pets\n    });\n    localStorage['pets'] = JSON.stringify(pets);\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000);\n      return;\n    }\n\n    const characters = [...this.state.characters];\n    const characterIndex = characters.indexOf(character);\n\n    const currentCharacter = characters[characterIndex] = _objectSpread({}, character, {}, newProps);\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n      var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id;\n      if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n      return itemEntry;\n    });\n\n    const backgroundColor = this.state.backgroundColor;\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    this.setState({\n      characters: characters\n    });\n    localStorage['characters'] = JSON.stringify(characters);\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {\n        x: 0,\n        y: 0\n      },\n      fhSnap: true\n    };\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex + 1 > this.state.characters.length) this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props);else this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props);\n  }\n\n  setModalOpen(isModalOpen) {\n    this.setState({\n      isModalOpen\n    });\n  }\n\n  userSelectedItem(item) {\n    let selectedRenderable = null;\n    if (this.state.selectedIndex + 1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length];else selectedRenderable = this.state.characters[this.state.selectedIndex];\n    item.region = localStorage['region'];\n    item.version = localStorage['version'];\n\n    let selectedItems = _objectSpread({}, selectedRenderable.selectedItems);\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top'];\n        delete selectedItems['Bottom'];\n      }\n    }\n\n    if (item.similar) {\n      item = _objectSpread({}, item);\n      delete item['similar'];\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item;\n    }\n\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItem(item) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    delete selectedItems[item.typeInfo.subCategory];\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems() {\n    let selectedItems = {};\n    this.updateItems(selectedItems);\n  }\n\n  updateItem(item, newProps) {\n    let selectedItems = _objectSpread({}, this.state.characters[this.state.selectedIndex].selectedItems);\n\n    selectedItems[item.typeInfo.subCategory] = _objectSpread({}, item, {}, newProps);\n    this.updateItems(selectedItems);\n  }\n\n  updateItems(selectedItems) {\n    console.log('New Items: ', selectedItems);\n    this.updateSelectedRenderable({\n      selectedItems\n    });\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`;\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems).filter(item => item.id && (item.visible === undefined || item.visible)).map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id;\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue;\n        return itemEntry;\n      });\n\n      return _objectSpread({}, character);\n    });\n    this.setState({\n      backgroundColor,\n      characters\n    });\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor);\n  }\n\n  openColorPicker() {\n    this.setState({\n      colorPickerOpen: true\n    });\n  }\n\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = props => {\n  const value = props.value,\n        dragging = props.dragging,\n        index = props.index,\n        restProps = _objectWithoutProperties(props, [\"value\", \"dragging\", \"index\"]);\n\n  return React.createElement(RcTooltip, {\n    prefixCls: \"rc-slider-tooltip\",\n    overlay: value,\n    visible: dragging,\n    placement: \"top\",\n    style: {\n      border: \"solid 2px hsl(\" + value + \", 53%, 53%)\"\n    },\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 797\n    },\n    __self: this\n  }, React.createElement(Handle, Object.assign({\n    value: value\n  }, restProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 805\n    },\n    __self: this\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/19065019/react-test/src/components/App/index.js"],"names":["React","Component","ItemListing","EquippedItems","_","CharacterList","NotificationContainer","NotificationManager","RenderCanvas","axios","VirtualizedSelect","createFilterOptions","Slider","RcTooltip","SketchPicker","Localization","Localize","Tooltip","FontAwesome","Toggle","Sidebar","localStorage","navigator","language","startsWith","creatingId","throttledErrorNotification","throttle","error","bind","leading","mapsIndexed","versions","GMS","region","MapleVersionId","IsReady","KMS","TMS","CMS","JMS","SEA","toCamel","o","newO","origKey","newKey","value","Array","map","hasOwnProperty","charAt","toLowerCase","slice","toString","constructor","Object","wzPromise","get","then","response","WZs","data","filter","wzEntry","isReady","groupBy","version","findIndex","ver","mapleVersionId","window","location","reload","console","log","maps","mapsFilter","mapPromise","label","streetName","name","join","id","options","App","props","isOpen","undefined","state","isModalOpen","characters","JSON","parse","pets","selectedIndex","selectedMap","zoom","mapPosition","x","y","backgroundColor","colorPickerOpen","music","sidebarOpen","length","setState","focusRenderable","isEmpty","selectedItems","currentCharacter","skin","push","getNewCharacter","stringify","forEach","character","index","Date","now","type","action","frame","emotion","mercEars","illiumEars","visible","position","flipX","includeBackground","characterItems","values","item","keyBy","typeInfo","subCategory","otherCharacters","allCharacters","pet","summary","petId","animation","document","addEventListener","handleClick","mapsLoaded","setTimeout","onSetSidebarOpen","open","changeRegionVersion","e","element","target","found","parentElement","className","render","localized","getLocalized","bgColorText","rgb","r","g","b","a","renderables","concat","updateRenderable","clickCanvas","userUpdateSelectedRenderable","userSelectedItem","content","overflowY","addCharacter","addPet","importCharacter","removeCharacter","cloneCharacter","removePet","renderable","userUpdateCharacter","userUpdatePet","userRemovedItem","updateItem","userRemovedItems","prototype","renderSettings","openColorPicker","onChangeColor","handle","changeZoom","changeLanguage","selectMap","menuList","styles","height","menu","keys","versionName","playMusic","toggleMusic","exportAllCharacters","createElement","style","body","appendChild","payload","blob","Blob","url","URL","createObjectURL","href","download","click","revokeObjectURL","remove","newZoom","mapId","newProps","currentTarget","getNewPet","c","andysFavePetIds","Math","floor","random","fhSnap","importAll","call","files","file","Promise","res","rej","extension","substr","lastIndexOf","warn","reader","FileReader","onload","ev","result","readAsText","all","indexOfCharacter","indexOf","splice","newCharacterIndex","callback","locked","petIndex","currentPet","characterIndex","itemsWithEmotion","itemEntry","hue","updateSelectedRenderable","setModalOpen","selectedRenderable","similar","updateItems","event","createSliderWithTooltip","Range","Handle","dragging","restProps","border"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,aAAP;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAO,2CAAP;AACA,SAAQC,qBAAR,EAA+BC,mBAA/B,QAAyD,qBAAzD;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,iBAAP,MAA8B,0BAA9B;AAEA,OAAOC,mBAAP,MAAgC,kCAAhC;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,YAAT,QAA6B,aAA7B;AACA,OAAOC,YAAP,MAAyB,sBAAzB;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAO,4BAAP;AACA,OAAO,iCAAP;AACA,OAAO,4BAAP;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,OAAP,MAAoB,eAApB;;AAEA,IAAIC,YAAY,CAAC,aAAD,CAAZ,IAA+B,GAAnC,EAAwC;AACtCA,EAAAA,YAAY,CAAC,QAAD,CAAZ,GAAyB,KAAzB;AACAA,EAAAA,YAAY,CAAC,SAAD,CAAZ,GAA0B,KAA1B;AACAA,EAAAA,YAAY,CAAC,aAAD,CAAZ,GAA8B,GAA9B;AACD;;AAED,IAAI,CAACA,YAAY,CAAC,UAAD,CAAjB,EAA+B;AAC7B,MAAIC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8B,IAA9B,CAAJ,EAAyCH,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B,CAAzC,KACK,IAAIC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8B,IAA9B,CAAJ,EAAyCH,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B,CAAzC,KACA,IAAIC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8B,IAA9B,CAAJ,EAAyCH,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B,CAAzC,KACA,IAAIC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8B,IAA9B,CAAJ,EAAyCH,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B,CAAzC,KACA,IAAIC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8B,IAA9B,CAAJ,EAAyCH,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B,CAAzC,KACAA,YAAY,CAAC,UAAD,CAAZ,GAA2B,IAA3B;AACN;;AAED,IAAII,UAAU,GAAG,IAAjB;;AACA,MAAMC,0BAA0B,GAAGtB,CAAC,CAACuB,QAAF,CAAWpB,mBAAmB,CAACqB,KAApB,CAA0BC,IAA1B,CAA+BtB,mBAA/B,CAAX,EAAgE,IAAhE,EAAsE;AAAEuB,EAAAA,OAAO,EAAC;AAAV,CAAtE,CAAnC;;AACA,IAAIC,WAAW,GAAG,IAAlB;AACA,IAAIC,QAAQ,GAAG;AACbC,EAAAA,GAAG,EAAE,CAAC;AAACC,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,QAAhC;AAA0CC,IAAAA,OAAO,EAAE;AAAnD,GAAD,CADQ;AAEbC,EAAAA,GAAG,EAAE,CAAC;AAACH,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,KAAhC;AAAuCC,IAAAA,OAAO,EAAE;AAAhD,GAAD,CAFQ;AAGbE,EAAAA,GAAG,EAAE,CAAC;AAACJ,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,QAAhC;AAA0CC,IAAAA,OAAO,EAAE;AAAnD,GAAD,CAHQ;AAIbG,EAAAA,GAAG,EAAE,CAAC;AAACL,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,QAAhC;AAA0CC,IAAAA,OAAO,EAAE;AAAnD,GAAD,CAJQ;AAKbI,EAAAA,GAAG,EAAE,CAAC;AAACN,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,QAAhC;AAA0CC,IAAAA,OAAO,EAAE;AAAnD,GAAD,CALQ;AAMbK,EAAAA,GAAG,EAAE,CAAC;AAACP,IAAAA,MAAM,EAAE,KAAT;AAAgBC,IAAAA,cAAc,EAAE,QAAhC;AAA0CC,IAAAA,OAAO,EAAE;AAAnD,GAAD;AANQ,CAAf;;AASA,SAASM,OAAT,CAAiBC,CAAjB,EAAoB;AAClB,MAAIC,IAAJ,EAAUC,OAAV,EAAmBC,MAAnB,EAA2BC,KAA3B;;AACA,MAAIJ,CAAC,YAAYK,KAAjB,EAAwB;AACtB,WAAOL,CAAC,CAACM,GAAF,CAAM,UAASF,KAAT,EAAgB;AACzB,UAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,QAAAA,KAAK,GAAGL,OAAO,CAACK,KAAD,CAAf;AACD;;AACD,aAAOA,KAAP;AACH,KALM,CAAP;AAMD,GAPD,MAOO;AACLH,IAAAA,IAAI,GAAG,EAAP;;AACA,SAAKC,OAAL,IAAgBF,CAAhB,EAAmB;AACjB,UAAIA,CAAC,CAACO,cAAF,CAAiBL,OAAjB,CAAJ,EAA+B;AAC7BC,QAAAA,MAAM,GAAG,CAACD,OAAO,CAACM,MAAR,CAAe,CAAf,EAAkBC,WAAlB,KAAkCP,OAAO,CAACQ,KAAR,CAAc,CAAd,CAAlC,IAAsDR,OAAvD,EAAgES,QAAhE,EAAT;AACAP,QAAAA,KAAK,GAAGJ,CAAC,CAACE,OAAD,CAAT;;AACA,YAAIE,KAAK,YAAYC,KAAjB,IAA2BD,KAAK,KAAK,IAAV,IAAkBA,KAAK,CAACQ,WAAN,KAAsBC,MAAvE,EAAgF;AAC9ET,UAAAA,KAAK,GAAGL,OAAO,CAACK,KAAD,CAAf;AACD;;AACDH,QAAAA,IAAI,CAACE,MAAD,CAAJ,GAAeC,KAAf;AACD;AACF;AACF;;AACD,SAAOH,IAAP;AACD;;AAED,IAAIa,SAAS,GAAGhD,KAAK,CAACiD,GAAN,CAAW,0CAAX,EACfC,IADe,CACVC,QAAQ,IAAI;AAChB,MAAIC,GAAG,GAAGzD,CAAC,CAAC6C,GAAF,CAAMW,QAAQ,CAACE,IAAT,CAAcC,MAAd,CAAqBC,OAAO,IAAIA,OAAO,CAACC,OAAxC,CAAN,EAAwDD,OAAO,IAAI;AAC3E,6BACKA,OADL;AAEE9B,MAAAA,MAAM,EAAE8B,OAAO,CAAC9B;AAFlB;AAID,GALS,CAAV;;AAMAF,EAAAA,QAAQ,GAAG5B,CAAC,CAAC8D,OAAF,CAAUL,GAAV,EAAe,QAAf,CAAX;AAEA,MAAI3B,MAAM,GAAGb,YAAY,CAAC,QAAD,CAAzB;AAAA,MAAqC8C,OAAO,GAAG9C,YAAY,CAAC,SAAD,CAA3D;;AAEA,MAAI,CAACa,MAAD,IAAYiC,OAAO,IAAI,KAAX,IAAoB/D,CAAC,CAACgE,SAAF,CAAYpC,QAAQ,CAACE,MAAD,CAApB,EAA8BmC,GAAG,IAAIA,GAAG,CAACC,cAAJ,IAAsBH,OAA3D,KAAuE,CAAC,CAA5G,EAAgH;AAC9G9C,IAAAA,YAAY,CAAC,QAAD,CAAZ,GAAyB,KAAzB;AACAA,IAAAA,YAAY,CAAC,SAAD,CAAZ,GAA0B,KAA1B;AACAkD,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD;;AAEDC,EAAAA,OAAO,CAACC,GAAR,CAAY3C,QAAZ;AACA,SAAOA,QAAP;AACD,CApBe,CAAhB;AAsBA,IAAI4C,IAAI,GAAG,EAAX;AACA,IAAIC,UAAU,GAAG,IAAjB;AACA,IAAIC,UAAU,GAAGrE,KAAK,CAACiD,GAAN,CAAW,uCAAX,EAAmDC,IAAnD,CAAwDC,QAAQ,IAAI;AAC/EgB,EAAAA,IAAI,GAAGxE,CAAC,CAAC6C,GAAF,CAAMW,QAAQ,CAACE,IAAf,EAAqBb,GAAG,IAAI;AACjC,WAAO;AACL8B,MAAAA,KAAK,EAAE,CAAC9B,GAAG,CAAC+B,UAAL,EAAiB/B,GAAG,CAACgC,IAArB,EAA2BC,IAA3B,CAAgC,KAAhC,CADF;AAELnC,MAAAA,KAAK,EAAEE,GAAG,CAACkC;AAFN,KAAP;AAID,GALM,CAAP;AAMAN,EAAAA,UAAU,GAAGlE,mBAAmB,CAAC;AAACyE,IAAAA,OAAO,EAAER;AAAV,GAAD,CAAhC;AACD,CARY,CAAjB;;AAUA,MAAMS,GAAN,SAAkBpF,SAAlB,CAA4B;AAC1BsD,EAAAA,WAAW,CAAC+B,KAAD,EAAQ;AACjB,UAAMA,KAAN;AAEA,QAAIC,MAAM,GAAG,CAAClE,YAAY,IAAI,EAAjB,EAAqB,WAArB,MAAsC,MAAnD;AACA,QAAIkE,MAAM,KAAK,EAAX,IAAiBA,MAAM,KAAKC,SAA5B,IAAyCD,MAAM,KAAK,WAAxD,EACEA,MAAM,GAAG,IAAT,CALe,CAOjB;;AACA,SAAKE,KAAL,GAAa;AACXC,MAAAA,WAAW,EAAEH,MADF;AAEXI,MAAAA,UAAU,EAAEC,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,YAAD,CAAZ,IAA8B,OAAzC,KAAqD,CAAC,KAAD,CAFtD;AAGXyE,MAAAA,IAAI,EAAEF,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,MAAD,CAAZ,IAAwB,OAAnC,KAA+C,EAH1C;AAIX0E,MAAAA,aAAa,EAAEH,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,eAAD,CAAZ,IAAiC,OAA5C,KAAwD,CAJ5D;AAKX2E,MAAAA,WAAW,EAAEJ,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,aAAD,CAAZ,IAA+B,OAA1C,KAAsD,IALxD;AAMX4E,MAAAA,IAAI,EAAEL,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,MAAD,CAAZ,IAAwB,OAAnC,KAA+C,CAN1C;AAOX6E,MAAAA,WAAW,EAAE;AAACC,QAAAA,CAAC,EAAE,CAAJ;AAAOC,QAAAA,CAAC,EAAE;AAAV,OAPF;AAQXC,MAAAA,eAAe,EAAET,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,iBAAD,CAAZ,IAAmC,KAA9C,KAAwD;AAAC,eAAM;AAAC,eAAI,CAAL;AAAO,eAAI,CAAX;AAAa,eAAI,CAAjB;AAAmB,eAAI;AAAvB,SAAP;AAAiC,eAAM,aAAvC;AAAqD,eAAM;AAAC,eAAI,CAAL;AAAO,eAAI,CAAX;AAAa,eAAI,CAAjB;AAAmB,eAAI;AAAvB,SAA3D;AAAqF,eAAM;AAAC,eAAI,CAAL;AAAO,eAAI,CAAX;AAAa,eAAI,CAAjB;AAAmB,eAAI;AAAvB,SAA3F;AAAqH,kBAAS,CAA9H;AAAgI,kBAAS;AAAzI,OAR9D;AASXiF,MAAAA,eAAe,EAAE,KATN;AAUX/E,MAAAA,QAAQ,EAAEF,YAAY,CAAC,UAAD,CAAZ,IAA4B,WAA5B,GAA0C,IAA1C,GAAiDA,YAAY,CAAC,UAAD,CAV5D;AAWXkF,MAAAA,KAAK,EAAE,KAXI;AAYXrE,MAAAA,MAAM,EAAEb,YAAY,CAAC,QAAD,CAAZ,GAAyBA,YAAY,CAAC,QAAD,CAArC,GAAkD,KAZ/C;AAaX8C,MAAAA,OAAO,EAAE9C,YAAY,CAAC,SAAD,CAAZ,GAA0BA,YAAY,CAAC,SAAD,CAAtC,GAAoD,KAblD;AAcXmF,MAAAA,WAAW,EAAE,IAdF;AAeXxE,MAAAA;AAfW,KAAb;AAkBA,QAAIA,QAAQ,CAACK,GAAT,CAAaoE,MAAb,GAAsB,CAA1B,EACE,KAAKhB,KAAL,CAAWzD,QAAX,GAAsBA,QAAtB,CADF,KAGEyB,SAAS,CAACE,IAAV,CAAeU,GAAG,IAAI,KAAKqC,QAAL,CAAc;AAAC1E,MAAAA;AAAD,KAAd,CAAtB;AAEF,QAAI,KAAKyD,KAAL,CAAWM,aAAX,GAA2B,CAA/B,EAAkC,KAAKN,KAAL,CAAWM,aAAX,GAA2B,KAA3B;AAClC,SAAKN,KAAL,CAAWkB,eAAX,GAA6B,KAAKlB,KAAL,CAAWM,aAAxC,CAhCiB,CAkCjB;;AACA,QAAI,CAAC3F,CAAC,CAACwG,OAAF,CAAU,KAAKnB,KAAL,CAAWoB,aAAX,IAA4B,EAAtC,CAAL,EAAgD;AAC9C,YAAMC,gBAAgB,GAAG;AACvBD,QAAAA,aAAa,EAAE,KAAKpB,KAAL,CAAWoB,aADH;AAEvBE,QAAAA,IAAI,EAAE,KAAKtB,KAAL,CAAWsB,IAAX,IAAmB;AAFF,OAAzB;AAIA,UAAI,KAAKtB,KAAL,CAAWE,UAAX,CAAsB,CAAtB,MAA6B,KAAjC,EACE,KAAKF,KAAL,CAAWE,UAAX,CAAsB,CAAtB,IAA2BmB,gBAA3B,CADF,KAGE,KAAKrB,KAAL,CAAWE,UAAX,CAAsBqB,IAAtB,CAA2BF,gBAA3B;AACH,KA5CgB,CA8CjB;;;AACA,QAAI,KAAKrB,KAAL,CAAWE,UAAX,CAAsB,CAAtB,MAA6B,KAAjC,EACE,KAAKF,KAAL,CAAWE,UAAX,CAAsB,CAAtB,IAA2B,KAAKsB,eAAL,EAA3B;AAEF,WAAO5F,YAAY,CAAC,eAAD,CAAnB;AACA,WAAOA,YAAY,CAAC,MAAD,CAAnB;AACA,WAAOA,YAAY,CAAC,OAAD,CAAnB;AACA,WAAOA,YAAY,CAAC,UAAD,CAAnB;AACA,WAAOA,YAAY,CAAC,YAAD,CAAnB;;AAEA,QAAIA,YAAY,CAAC,kBAAD,CAAhB,EAAsC;AACpC,WAAKoE,KAAL,GAAaG,IAAI,CAACC,KAAL,CAAWxE,YAAY,CAAC,kBAAD,CAAvB,CAAb;AACA,aAAOA,YAAY,CAAC,kBAAD,CAAnB;AACAA,MAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAe,CAAC,GAAG,KAAKzB,KAAL,CAAWE,UAAf,EAA2B,KAAKF,KAAhC,CAAf,CAA7B;AACA,WAAKA,KAAL,CAAW,YAAX,IAA2B,CAAC,GAAG,KAAKA,KAAL,CAAWE,UAAf,EAA2B,KAAKF,KAAhC,CAA3B;AACD;;AAED,SAAKA,KAAL,CAAWE,UAAX,CAAsBwB,OAAtB,CAA8B,CAACC,SAAD,EAAYC,KAAZ,KAAsB;AAClD,UAAI,CAACD,SAAS,CAACjC,EAAf,EAAmBiC,SAAS,CAACjC,EAAV,GAAemC,IAAI,CAACC,GAAL,MAAcF,KAAK,GAAG,CAAtB,CAAf;AACnBD,MAAAA,SAAS,CAACI,IAAV,GAAiB,WAAjB;AACAJ,MAAAA,SAAS,CAACK,MAAV,GAAmBL,SAAS,CAACK,MAAV,IAAoB,QAAvC;AACAL,MAAAA,SAAS,CAACM,KAAV,GAAkBN,SAAS,CAACM,KAAV,IAAmB,CAArC;AACAN,MAAAA,SAAS,CAACnB,IAAV,GAAiBmB,SAAS,CAACnB,IAAV,IAAkB,CAAnC;AACAmB,MAAAA,SAAS,CAACO,OAAV,GAAoBP,SAAS,CAACO,OAAV,IAAqB,SAAzC;AACAP,MAAAA,SAAS,CAACL,IAAV,GAAiBK,SAAS,CAACL,IAAV,IAAkB,IAAnC;AACAK,MAAAA,SAAS,CAACQ,QAAV,GAAqBR,SAAS,CAACQ,QAAV,IAAsB,KAA3C;AACAR,MAAAA,SAAS,CAACS,UAAV,GAAuBT,SAAS,CAACS,UAAV,IAAwB,KAA/C;AACAT,MAAAA,SAAS,CAACP,aAAV,GAA0BO,SAAS,CAACP,aAAV,IAA2B,EAArD;AACAO,MAAAA,SAAS,CAACU,OAAV,GAAoBV,SAAS,CAACU,OAAV,IAAqB,KAAzC;AACAV,MAAAA,SAAS,CAACW,QAAV,GAAqBX,SAAS,CAACW,QAAV,IAAsB;AAAC5B,QAAAA,CAAC,EAAC,CAAH;AAAKC,QAAAA,CAAC,EAAC;AAAP,OAA3C;AACAgB,MAAAA,SAAS,CAACY,KAAV,GAAkBZ,SAAS,CAACY,KAAV,IAAmB,KAArC;AACAZ,MAAAA,SAAS,CAACnC,IAAV,GAAiBmC,SAAS,CAACnC,IAAV,IAAkB,EAAnC;AACAmC,MAAAA,SAAS,CAACa,iBAAV,GAA8Bb,SAAS,CAACa,iBAAV,KAAgCzC,SAAhC,GAA4C,IAA5C,GAAmD4B,SAAS,CAACa,iBAA3F;;AACA,UAAIC,cAAc,GAAG9H,CAAC,CAAC+H,MAAF,CAASzF,OAAO,CAAC0E,SAAS,CAACP,aAAX,CAAhB,EAA2C5D,GAA3C,CAA+CmF,IAAI,IAAI;AAC1E,YAAI,CAACA,IAAI,CAAClG,MAAV,EAAkBkG,IAAI,CAAClG,MAAL,GAAcb,YAAY,CAAC,QAAD,CAA1B;AAClB,YAAI,CAAC+G,IAAI,CAACjE,OAAV,EAAmBiE,IAAI,CAACjE,OAAL,GAAe9C,YAAY,CAAC,SAAD,CAA3B;AACnB,eAAO+G,IAAP;AACD,OAJoB,CAArB;;AAKAhB,MAAAA,SAAS,CAACP,aAAV,GAA0BzG,CAAC,CAACiI,KAAF,CAAQH,cAAR,EAAyBE,IAAD,IAAUA,IAAI,CAACE,QAAL,CAAcC,WAAhD,CAA1B;AACA,aAAOnB,SAAS,CAACzB,UAAjB;AACA,aAAOyB,SAAS,CAACoB,eAAjB;AACA,aAAOpB,SAAS,CAACqB,aAAjB;AACD,KAzBD;AA2BA,SAAKhD,KAAL,CAAWK,IAAX,CAAgBqB,OAAhB,CAAwB,CAACuB,GAAD,EAAMrB,KAAN,KAAgB;AACtC,UAAI,CAACqB,GAAG,CAACvD,EAAT,EAAauD,GAAG,CAACvD,EAAJ,GAASmC,IAAI,CAACC,GAAL,MAAcF,KAAK,GAAG,CAAtB,CAAT;AACbqB,MAAAA,GAAG,CAAClB,IAAJ,GAAW,KAAX;AACAkB,MAAAA,GAAG,CAACX,QAAJ,GAAeW,GAAG,CAACX,QAAJ,IAAgB;AAAE5B,QAAAA,CAAC,EAAE,CAAL;AAAQC,QAAAA,CAAC,EAAE;AAAX,OAA/B;AACAsC,MAAAA,GAAG,CAACC,OAAJ,GAAe,yCAAwCD,GAAG,CAACE,KAAM,IAAGF,GAAG,CAACG,SAAJ,IAAiB,QAAS,IAAGH,GAAG,CAAChB,KAAJ,IAAa,CAAE,IAAGtH,CAAC,CAAC+H,MAAF,CAASO,GAAG,CAAC7B,aAAb,EAA4B5D,GAA5B,CAAgCmF,IAAI,IAAIA,IAAI,CAACjD,EAA7C,EAAiDD,IAAjD,CAAsD,GAAtD,CAA2D,WAAUwD,GAAG,CAACzC,IAAJ,IAAY,CAAE,EAAtM;AACD,KALD;AAOA,QAAK,KAAKR,KAAL,CAAWM,aAAX,GAA2B,CAA5B,GAAkC,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAtB,GAA+B,KAAKhB,KAAL,CAAWK,IAAX,CAAgBW,MAAjF,IAA4F,CAAC,KAAKhB,KAAL,CAAWE,UAAX,CAAsBc,MAAvH,EACE,KAAKhB,KAAL,CAAWM,aAAX,GAA2B,KAA3B;AAGF+C,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmC,KAAKC,WAAL,CAAiBnH,IAAjB,CAAsB,IAAtB,CAAnC;AAEA,QAAI+C,IAAI,CAAC6B,MAAT,EAAiB,KAAKhB,KAAL,CAAWwD,UAAX,GAAwB,IAAxB,CAAjB,KACKnE,UAAU,CAACnB,IAAX,CAAgB,MAAMuF,UAAU,CAAC,MAAM,KAAKxC,QAAL,CAAc;AAACuC,MAAAA,UAAU,EAAG;AAAd,KAAd,CAAP,EAA2C,GAA3C,CAAhC;AACL,SAAKE,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBtH,IAAtB,CAA2B,IAA3B,CAAxB;AACD;;AAEDsH,EAAAA,gBAAgB,CAACC,IAAD,EAAO;AACrB,SAAK1C,QAAL,CAAc;AAAEF,MAAAA,WAAW,EAAE4C;AAAf,KAAd;AACD;;AAEDC,EAAAA,mBAAmB,CAACnH,MAAD,EAASiC,OAAT,EAAkB;AACnC9C,IAAAA,YAAY,CAAC,QAAD,CAAZ,GAAyBa,MAAzB;AACAb,IAAAA,YAAY,CAAC,SAAD,CAAZ,GAA0B8C,OAA1B,CAFmC,CAInC;;AACAI,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD;;AAEDuE,EAAAA,WAAW,CAACM,CAAD,EAAI;AACb,QAAIC,OAAO,GAAGD,CAAC,CAACE,MAAhB;AACA,QAAIC,KAAK,GAAG,KAAZ;;AACA,WAAO,KAAKhE,KAAL,CAAWa,eAAX,IAA8B,CAACmD,KAA/B,IAAwC,CAACF,OAAO,GAAGA,OAAO,CAACG,aAAnB,KAAqC,IAApF,EAA0F;AACxF,UAAIH,OAAO,CAACI,SAAR,IAAqB,2BAAzB,EAAsD,SAAtD,KACK;AACHF,QAAAA,KAAK,GAAG,IAAR;AACA/E,QAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AACD;AACF;;AAED,QAAI,CAAC8E,KAAD,IAAU,KAAKhE,KAAL,CAAWa,eAAzB,EAA0C,KAAKI,QAAL,CAAc;AAAEJ,MAAAA,eAAe,EAAE;AAAnB,KAAd;AAC3C;;AAGDsD,EAAAA,MAAM,GAAG;AAAA,wBAcH,KAAKnE,KAdF;AAAA,UAELE,UAFK,eAELA,UAFK;AAAA,UAGLG,IAHK,eAGLA,IAHK;AAAA,UAILC,aAJK,eAILA,aAJK;AAAA,UAKLL,WALK,eAKLA,WALK;AAAA,UAMLO,IANK,eAMLA,IANK;AAAA,UAOL0C,OAPK,eAOLA,OAPK;AAAA,UAQL3C,WARK,eAQLA,WARK;AAAA,UASLW,eATK,eASLA,eATK;AAAA,UAULN,eAVK,eAULA,eAVK;AAAA,UAWLC,eAXK,eAWLA,eAXK;AAAA,UAYL/E,QAZK,eAYLA,QAZK;AAAA,UAaLgF,KAbK,eAaLA,KAbK;AAgBP,UAAMsD,SAAS,GAAG7I,QAAQ,CAAC8I,YAAT,CAAsBvI,QAAtB,CAAlB;AAEA,UAAMwI,WAAW,GAAI,QAAO1D,eAAe,CAAC2D,GAAhB,CAAoBC,CAAE,KAAI5D,eAAe,CAAC2D,GAAhB,CAAoBE,CAAE,KAAI7D,eAAe,CAAC2D,GAAhB,CAAoBG,CAAE,KAAI9D,eAAe,CAAC2D,GAAhB,CAAoBI,CAAE,GAAhI;AAEA,UAAMC,WAAW,GAAG1E,UAAU,CAAC2E,MAAX,CAAkBxE,IAAlB,CAApB;AAEA,WACE;AAAK,MAAA,SAAS,EAAE,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAM,MAAA,SAAS,EAAC,MAAhB;AAAuB,MAAA,OAAO,EAAE,MAAM,KAAKqD,gBAAL,CAAsB,IAAtB,CAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,CADA,EAME,oBAAC,YAAD;AACE,MAAA,eAAe,EAAEY,WADnB;AAEE,MAAA,IAAI,EAAE9D,IAFR;AAGE,MAAA,KAAK,EAAED,WAHT;AAIE,MAAA,WAAW,EAAEqE,WAJf;AAKE,MAAA,kBAAkB,EAAEtE,aALtB;AAME,MAAA,eAAe,EAAEY,eAAe,KAAKnB,SAApB,GAAgCO,aAAhC,GAAgDY,eANnE;AAOE,MAAA,kBAAkB,EAAE,KAAK4D,gBAAL,CAAsB1I,IAAtB,CAA2B,IAA3B,CAPtB;AAQE,MAAA,OAAO,EAAE,KAAK2I,WAAL,CAAiB3I,IAAjB,CAAsB,IAAtB,CARX;AASE,MAAA,SAAS,EAAEgI,SATb;AAUE,MAAA,iBAAiB,EAAE,KAAKY,4BAAL,CAAkC5I,IAAlC,CAAuC,IAAvC,CAVrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,EAiBKkE,aAAa,KAAK,KAAnB,GACA,oBAAC,OAAD;AACE,MAAA,OAAO,EAAE,oBAAC,WAAD;AACP,QAAA,MAAM,EAAEsE,WAAW,CAACtE,aAAD,CADZ;AAEP,QAAA,cAAc,EAAE,KAAK2E,gBAAL,CAAsB7I,IAAtB,CAA2B,IAA3B,CAFT;AAGP,QAAA,SAAS,EAAEgI,SAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADX;AAKE,MAAA,IAAI,EAAE,KAAKpE,KAAL,CAAWe,WALnB;AAME,MAAA,SAAS,EAAE,KAAK2C,gBANlB;AAOE,MAAA,MAAM,EAAE;AAAGwB,QAAAA,OAAO,EAAE;AACpBC,UAAAA,SAAS,EAAE;AADS;AAAZ,OAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,GAWc,EA5BlB,EA6BE,oBAAC,aAAD;AACE,MAAA,WAAW,EAAEP,WADf;AAEE,MAAA,aAAa,EAAEtE,aAFjB;AAGE,MAAA,cAAc,EAAE,KAAK8E,YAAL,CAAkBhJ,IAAlB,CAAuB,IAAvB,CAHlB;AAIE,MAAA,QAAQ,EAAE,KAAKiJ,MAAL,CAAYjJ,IAAZ,CAAiB,IAAjB,CAJZ;AAKE,MAAA,iBAAiB,EAAE,KAAKkJ,eAAL,CAAqBlJ,IAArB,CAA0B,IAA1B,CALrB;AAME,MAAA,iBAAiB,EAAE,KAAKmJ,eAAL,CAAqBnJ,IAArB,CAA0B,IAA1B,CANrB;AAOE,MAAA,gBAAgB,EAAE,KAAKoJ,cAAL,CAAoBpJ,IAApB,CAAyB,IAAzB,CAPpB;AAQE,MAAA,WAAW,EAAE,KAAKqJ,SAAL,CAAerJ,IAAf,CAAoB,IAApB,CARf;AASE,MAAA,SAAS,EAAEgI,SATb;AAUE,MAAA,yBAAyB,EAAE,UAAUsB,UAAV,EAAsB;AAC/C,aAAKV,4BAAL,CAAkCU,UAAlC,EAA8C,MAAM;AAClD,eAAKzE,QAAL,CAAc;AACZC,YAAAA,eAAe,EAAE,KAAKlB,KAAL,CAAWM;AADhB,WAAd;AAGD,SAJD;AAKD,OAN0B,CAMzBlE,IANyB,CAMpB,IANoB,CAV7B;AAiBE,MAAA,iBAAiB,EAAE,KAAKuJ,mBAAL,CAAyBvJ,IAAzB,CAA8B,IAA9B,CAjBrB;AAkBE,MAAA,WAAW,EAAE,KAAKwJ,aAAL,CAAmBxJ,IAAnB,CAAwB,IAAxB,CAlBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA7BF,EAiDKkE,aAAa,KAAK,KAAlB,IAA2B,CAAC3F,CAAC,CAACwG,OAAF,CAAUyD,WAAW,CAACtE,aAAD,CAAX,CAA2Bc,aAArC,CAA5B,GAAkF,oBAAC,aAAD;AACjF,MAAA,aAAa,EAAEwD,WAAW,CAACtE,aAAD,CAAX,CAA2Bc,aADuC;AAEjF,MAAA,YAAY,EAAE,KAAKyE,eAAL,CAAqBzJ,IAArB,CAA0B,IAA1B,CAFmE;AAGjF,MAAA,IAAI,EAAEwI,WAAW,CAACtE,aAAD,CAAX,CAA2Bd,IAHgD;AAIjF,MAAA,MAAM,EAAEoF,WAAW,CAACtE,aAAD,CAAX,CAA2BgB,IAJ8C;AAKjF,MAAA,YAAY,EAAE,KAAKwE,UAAL,CAAgB1J,IAAhB,CAAqB,IAArB,CALmE;AAMjF,MAAA,SAAS,EAAEgI,SANsE;AAOjF,MAAA,aAAa,EAAE,KAAK2B,gBAAL,CAAsB3J,IAAtB,CAA2B,IAA3B,CAPkE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAlF,GAOuD,EAxD5D,EA0DE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAMgI,SAAS,CAAC4B,SAAhB,CAA5B,CA1DF,EA4DE,oBAAC,qBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA5DF,EA6DIlF,KAAK,GAAG;AAAO,MAAA,GAAG,EAAG,mCAAkCP,WAAY,MAA3D;AAAkE,MAAA,QAAQ,EAAE,IAA5E;AAAkF,MAAA,IAAI,EAAE,IAAxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAH,GAAsG,EA7D/G,CADF;AAiED;;AAED0F,EAAAA,cAAc,GAAG;AAAA,yBAaX,KAAKjG,KAbM;AAAA,UAEbE,UAFa,gBAEbA,UAFa;AAAA,UAGbG,IAHa,gBAGbA,IAHa;AAAA,UAIbC,aAJa,gBAIbA,aAJa;AAAA,UAKbL,WALa,gBAKbA,WALa;AAAA,UAMbO,IANa,gBAMbA,IANa;AAAA,UAOb0C,OAPa,gBAObA,OAPa;AAAA,UAQb3C,WARa,gBAQbA,WARa;AAAA,UASbW,eATa,gBASbA,eATa;AAAA,UAUbN,eAVa,gBAUbA,eAVa;AAAA,UAWbC,eAXa,gBAWbA,eAXa;AAAA,UAYb/E,QAZa,gBAYbA,QAZa;AAef,UAAMsI,SAAS,GAAG7I,QAAQ,CAAC8I,YAAT,CAAsBvI,QAAtB,CAAlB;AAEA,UAAMwI,WAAW,GAAI,QAAO1D,eAAe,CAAC2D,GAAhB,CAAoBC,CAAE,KAAI5D,eAAe,CAAC2D,GAAhB,CAAoBE,CAAE,KAAI7D,eAAe,CAAC2D,GAAhB,CAAoBG,CAAE,KAAI9D,eAAe,CAAC2D,GAAhB,CAAoBI,CAAE,GAAhI;AACA,WACE;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAO,MAAA,SAAS,EAAC,2BAAjB;AAA6C,MAAA,OAAO,EAAE,KAAKuB,eAAL,CAAqB9J,IAArB,CAA0B,IAA1B,CAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAEE;AAAK,MAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,eAAf;AAA+B,MAAA,KAAK,EAAE;AAAEwE,QAAAA,eAAe,EAAE0D;AAAnB,OAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFF,EAKIzD,eAAe,GAAG,oBAAC,YAAD;AAAc,MAAA,KAAK,EAAEyD,WAArB;AAAkC,MAAA,QAAQ,EAAE,KAAK6B,aAAL,CAAmB/J,IAAnB,CAAwB,IAAxB,CAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAH,GAAmF,EALtG,CADF,EAQE;AAAO,MAAA,SAAS,EAAC,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOgI,SAAS,CAAC5D,IAAjB,CADF,EAEE,oBAAC,MAAD;AACE,MAAA,KAAK,EAAEA,IAAI,IAAI,CADjB;AAEE,MAAA,GAAG,EAAE,IAFP;AAGE,MAAA,GAAG,EAAE,CAHP;AAIE,MAAA,IAAI,EAAE,IAJR;AAKE,MAAA,MAAM,EAAE4F,MALV;AAME,MAAA,QAAQ,EAAE,KAAKC,UAAL,CAAgBjK,IAAhB,CAAqB,IAArB,CANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CARF,EAkBE;AAAO,MAAA,SAAS,EAAC,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOgI,SAAS,CAACtI,QAAjB,CADF,EAEE;AAAQ,MAAA,KAAK,EAAE,KAAKkE,KAAL,CAAWlE,QAA1B;AAAoC,MAAA,QAAQ,EAAE,KAAKwK,cAAL,CAAoBlK,IAApB,CAAyB,IAAzB,CAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,EAGE;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHF,EAIE;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAJF,EAKE;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eALF,EAME;AAAQ,MAAA,KAAK,EAAC,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BANF,CAFF,CAlBF,EA6BE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,iBAAD;AACE,MAAA,aAAa,EAAEgD,UADjB;AAEE,MAAA,SAAS,EAAED,IAAI,CAAC6B,MAAL,KAAgB,CAF7B;AAGE,MAAA,IAAI,EAAC,eAHP;AAIE,MAAA,UAAU,MAJZ;AAKE,MAAA,SAAS,MALX;AAME,MAAA,WAAW,MANb;AAOE,MAAA,KAAK,EAAET,WAPT;AAQE,MAAA,QAAQ,EAAE,KAAKgG,SAAL,CAAenK,IAAf,CAAoB,IAApB,CARZ;AASE,MAAA,OAAO,EAAE+C,IATX;AAUE,MAAA,SAAS,EAAE,GAVb;AAWE,MAAA,MAAM,EAAE;AACNqH,QAAAA,QAAQ,EAAE,CAACC,MAAD,EAAS;AAACpI,UAAAA;AAAD,SAAT,KAAoB;AAC5B,mCACKoI,MADL;AAEEC,YAAAA,MAAM,EAAE;AAFV;AAID,SANK;AAONC,QAAAA,IAAI,EAAE,CAACF,MAAD,EAAS;AAACpI,UAAAA;AAAD,SAAT,KAAoB;AACxB,mCACKoI,MADL;AAEEC,YAAAA,MAAM,EAAE;AAFV;AAID;AAZK,OAXV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CA7BF,EA2DE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOtC,SAAS,CAAC3H,MAAjB,CADF,EAEE;AAAQ,MAAA,KAAK,EAAE,KAAKuD,KAAL,CAAWvD,MAA1B;AAAkC,MAAA,QAAQ,EAAGoH,CAAD,IAAO,KAAKD,mBAAL,CAAyBC,CAAC,CAACE,MAAF,CAASzG,KAAlC,EAAyC,KAAzC,CAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI3C,CAAC,CAACiM,IAAF,CAAO,KAAK5G,KAAL,CAAWzD,QAAlB,EAA4BiB,GAA5B,CAAgCqJ,WAAW,IAAI;AAAQ,MAAA,KAAK,EAAEA,WAAf;AAA4B,MAAA,GAAG,EAAEA,WAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+CA,WAA/C,CAA/C,CADJ,CAFF,CA3DF,EAiEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOzC,SAAS,CAAC1F,OAAjB,CADF,EAEE;AAAQ,MAAA,KAAK,EAAE,KAAKsB,KAAL,CAAWtB,OAA1B;AAAmC,MAAA,QAAQ,EAAGmF,CAAD,IAAO,KAAKD,mBAAL,CAAyB,KAAK5D,KAAL,CAAWvD,MAApC,EAA4CoH,CAAC,CAACE,MAAF,CAASzG,KAArD,CAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,KAAK0C,KAAL,CAAWzD,QAAX,CAAoB,KAAKyD,KAAL,CAAWvD,MAA/B,EAAuCe,GAAvC,CAA2C,CAAC;AAACqB,MAAAA;AAAD,KAAD,KAAsB;AAAQ,MAAA,KAAK,EAAEA,cAAf;AAA+B,MAAA,GAAG,EAAEA,cAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAqDA,cAArD,CAAjE,CADJ,EAEE;AAAQ,MAAA,KAAK,EAAC,KAAd;AAAoB,MAAA,GAAG,EAAC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAFF,CAFF,CAjEF,EAwEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOuF,SAAS,CAAC0C,SAAjB,CADF,EAEE,oBAAC,MAAD;AACE,MAAA,QAAQ,EAAE,KAAKC,WAAL,CAAiB3K,IAAjB,CAAsB,IAAtB,CADZ;AAEE,MAAA,OAAO,EAAE,KAAK4D,KAAL,CAAWc,KAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAxEF,EA8EE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAG,MAAA,IAAI,EAAC,GAAR;AAAY,MAAA,OAAO,EAAE,KAAKkG,mBAAL,CAAyB5K,IAAzB,CAA8B,IAA9B,CAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADF,CA9EF,CADF;AAoFD;;AAED2K,EAAAA,WAAW,CAAClD,CAAD,EAAI;AACb,SAAK5C,QAAL,CAAc;AACZH,MAAAA,KAAK,EAAE,CAAC,KAAKd,KAAL,CAAWc;AADP,KAAd;AAGD;;AAEDkG,EAAAA,mBAAmB,GAAG;AACpB,SAAKhH,KAAL,CAAWE,UAAX,CAAsBwB,OAAtB,CAA8BC,SAAS,IAAI;AACzC,YAAMgD,CAAC,GAAGtB,QAAQ,CAAC4D,aAAT,CAAuB,GAAvB,CAAV;AACAtC,MAAAA,CAAC,CAACuC,KAAF,GAAU,gBAAV;AACA7D,MAAAA,QAAQ,CAAC8D,IAAT,CAAcC,WAAd,CAA0BzC,CAA1B;AAEA,YAAM0C,OAAO,GAAGlH,IAAI,CAACsB,SAAL,CAAeE,SAAf,EAA0B,IAA1B,EAAgC,CAAhC,CAAhB;AAAA,YACE2F,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,EAAoB;AAACtF,QAAAA,IAAI,EAAE;AAAP,OAApB,CADT;AAAA,YAEEyF,GAAG,GAAG1I,MAAM,CAAC2I,GAAP,CAAWC,eAAX,CAA2BJ,IAA3B,CAFR;AAGA3C,MAAAA,CAAC,CAACgD,IAAF,GAASH,GAAT;AACA,UAAI7F,SAAS,CAACnC,IAAd,EACEmF,CAAC,CAACiD,QAAF,GAAajG,SAAS,CAACnC,IAAV,GAAiB,YAA9B,CADF,KAGEmF,CAAC,CAACiD,QAAF,GAAa,qBAAb;AACFjD,MAAAA,CAAC,CAACkD,KAAF;AAEA/I,MAAAA,MAAM,CAAC2I,GAAP,CAAWK,eAAX,CAA2BN,GAA3B;AACA7C,MAAAA,CAAC,CAACoD,MAAF;AACD,KAjBD;AAkBD;;AAEDzB,EAAAA,cAAc,CAACzC,CAAD,EAAI;AAChB,SAAK5C,QAAL,CAAc;AACZnF,MAAAA,QAAQ,EAAE+H,CAAC,CAACE,MAAF,CAASzG;AADP,KAAd;AAGA1B,IAAAA,YAAY,CAAC,UAAD,CAAZ,GAA2BiI,CAAC,CAACE,MAAF,CAASzG,KAApC;AACD;;AAED+I,EAAAA,UAAU,CAAC2B,OAAD,EAAU;AAClB,SAAK/G,QAAL,CAAc;AAAET,MAAAA,IAAI,EAAEwH;AAAR,KAAd;AACApM,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuBoM,OAAvB;AACD;;AAEDzB,EAAAA,SAAS,CAAC0B,KAAD,EAAQ;AACf,SAAKhH,QAAL,CAAc;AACZV,MAAAA,WAAW,EAAE0H;AADD,KAAd;AAGArM,IAAAA,YAAY,CAAC,aAAD,CAAZ,GAA8BqM,KAA9B;AACD;;AAEDnD,EAAAA,gBAAgB,CAACY,UAAD,EAAawC,QAAb,EAAuB;AACrC,QAAIxC,UAAU,CAAC3D,IAAX,IAAmB,KAAvB,EAA8B,KAAK6D,aAAL,CAAmBF,UAAnB,EAA+BwC,QAA/B;AAC9B,QAAIxC,UAAU,CAAC3D,IAAX,IAAmB,WAAnB,IAAkC2D,UAAU,CAAC3D,IAAX,KAAoBhC,SAA1D,EAAqE,KAAK4F,mBAAL,CAAyBD,UAAzB,EAAqCwC,QAArC;AACtE;;AAEDnD,EAAAA,WAAW,CAAClB,CAAD,EAAI;AACb,QAAIA,CAAC,CAACE,MAAF,KAAaF,CAAC,CAACsE,aAAf,IAAiC,KAAKnI,KAAL,CAAWE,UAAX,CAAsBc,MAAtB,GAA+B,KAAKhB,KAAL,CAAWK,IAAX,CAAgBW,MAAhD,GAA0D,CAA9F,EAAiG;AAC/F,WAAKC,QAAL,CAAc;AAAEX,QAAAA,aAAa,EAAE;AAAjB,OAAd;AACA1E,MAAAA,YAAY,CAAC,eAAD,CAAZ,GAAgC,OAAhC;AACD;AACF;;AAEDyJ,EAAAA,MAAM,GAAG;AACP,QAAIhF,IAAI,GAAG,CAAC,IAAI,KAAKL,KAAL,CAAWK,IAAX,IAAmB,EAAvB,CAAD,EAA6B,KAAK+H,SAAL,EAA7B,CAAX;AACA,SAAKnH,QAAL,CAAc;AAACZ,MAAAA,IAAD;AAAOC,MAAAA,aAAa,EAAE,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAtB,GAA+B,KAAKhB,KAAL,CAAWK,IAAX,CAAgBW;AAArE,KAAd;AACApF,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuBuE,IAAI,CAACsB,SAAL,CAAepB,IAAf,CAAvB;AACD;;AAEDoF,EAAAA,SAAS,CAACxC,GAAD,EAAM;AACb,QAAI5C,IAAI,GAAG,KAAKL,KAAL,CAAWK,IAAX,CAAgB/B,MAAhB,CAAuB+J,CAAC,IAAIA,CAAC,IAAIpF,GAAjC,CAAX;AACA,SAAKhC,QAAL,CAAc;AAAEZ,MAAAA,IAAF;AAAQC,MAAAA,aAAa,EAAE,KAAvB;AAA8BE,MAAAA,IAAI,EAAE;AAApC,KAAd,EAFa,CAE0C;;AACvD5E,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuBuE,IAAI,CAACsB,SAAL,CAAepB,IAAf,CAAvB;AACAzE,IAAAA,YAAY,CAAC,eAAD,CAAZ,GAAgC,KAAhC;AACAA,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuB,CAAvB;AACD;;AAEDwM,EAAAA,SAAS,GAAG;AACV,UAAME,eAAe,GAAG,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,EAA4B,OAA5B,EAAqC,OAArC,EAA8C,OAA9C,CAAxB;AACA,UAAMnF,KAAK,GAAGmF,eAAe,CAACC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBH,eAAe,CAACtH,MAA3C,CAAD,CAA7B;AACA,WAAO;AACLmC,MAAAA,KADK;AAEL/B,MAAAA,aAAa,EAAE,EAFV;AAGL1B,MAAAA,EAAE,EAAEmC,IAAI,CAACC,GAAL,EAHC;AAILC,MAAAA,IAAI,EAAE,KAJD;AAKLmB,MAAAA,OAAO,EAAG,yCAAwCC,KAAM,SALnD;AAMLC,MAAAA,SAAS,EAAE,QANN;AAOLf,MAAAA,OAAO,EAAE,IAPJ;AAQLJ,MAAAA,KAAK,EAAE,CARF;AASLzB,MAAAA,IAAI,EAAE,CATD;AAULkI,MAAAA,MAAM,EAAE,IAVH;AAWLpG,MAAAA,QAAQ,EAAE;AAAE5B,QAAAA,CAAC,EAAC,CAAJ;AAAOC,QAAAA,CAAC,EAAC;AAAT;AAXL,KAAP;AAaD;;AAED2E,EAAAA,eAAe,CAACzB,CAAD,EAAI;AACjB,QAAIE,MAAM,GAAGF,CAAC,CAACE,MAAf;AACA,QAAI4E,SAAS,GAAGpL,KAAK,CAACyI,SAAN,CAAgBxI,GAAhB,CAAoBoL,IAApB,CAAyB7E,MAAM,CAAC8E,KAAhC,EAAuCC,IAAI,IAAI;AAC7D,aAAO,IAAIC,OAAJ,CAAY,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC/B,YAAIC,SAAS,GAAGJ,IAAI,CAACtJ,IAAL,CAAU2J,MAAV,CAAiBL,IAAI,CAACtJ,IAAL,CAAU4J,WAAV,CAAsB,GAAtB,IAA6B,CAA9C,EAAiDzL,WAAjD,EAAhB;;AACA,YAAIuL,SAAS,IAAI,MAAjB,EAAyB;AACvBjK,UAAAA,OAAO,CAACoK,IAAR,CAAa,qBAAb;AACA;AACD;;AAED,YAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,QAAAA,MAAM,CAACE,MAAP,GAAgB,UAAUC,EAAV,EAAc;AAC5B,cAAIpC,OAAO,GAAGoC,EAAE,CAAC1F,MAAH,CAAU2F,MAAxB;AACA,cAAIrL,IAAI,GAAG8B,IAAI,CAACC,KAAL,CAAWiH,OAAX,CAAX;AAEA2B,UAAAA,GAAG;AACH,cAAI,CAAC3K,IAAI,CAACqB,EAAN,IAAYrB,IAAI,CAAC0D,IAAL,IAAa,WAAzB,IAAwC,CAAC1D,IAAI,CAAC+C,aAAlD,EAAiE;AAEjE/C,UAAAA,IAAI,CAACqB,EAAL,GAAUmC,IAAI,CAACC,GAAL,EAAV;AAEA,cAAI5B,UAAU,GAAG,CACf,GAAG,KAAKF,KAAL,CAAWE,UADC,EAEf7B,IAFe,CAAjB;AAIA,eAAK4C,QAAL,CAAc;AACZf,YAAAA,UADY;AAEZI,YAAAA,aAAa,EAAE,KAAKN,KAAL,CAAWE,UAAX,CAAsBc;AAFzB,WAAd;AAIApF,UAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAevB,UAAf,CAA7B;AACD,SAlBe,CAkBd9D,IAlBc,CAkBT,IAlBS,CAAhB;;AAoBAkN,QAAAA,MAAM,CAACK,UAAP,CAAkBb,IAAlB,EAAwB,MAAxB;AACD,OA7BM,CAAP;AA8BD,KA/Be,CAAhB;AAiCAC,IAAAA,OAAO,CAACa,GAAR,CAAYjB,SAAZ,EAAuBzK,IAAvB,CAA4B,MAAM;AAChC6F,MAAAA,MAAM,CAACzG,KAAP,GAAe,EAAf;AACD,KAFD;AAGD;;AAED8H,EAAAA,YAAY,GAAG;AACb,QAAIlF,UAAU,GAAG,CAAE,GAAG,KAAKF,KAAL,CAAWE,UAAhB,EAA4B,KAAKsB,eAAL,EAA5B,CAAjB;AACA,SAAKP,QAAL,CAAc;AAAEf,MAAAA,UAAF;AAAcI,MAAAA,aAAa,EAAE,KAAKN,KAAL,CAAWE,UAAX,CAAsBc;AAAnD,KAAd;AACApF,IAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAevB,UAAf,CAA7B;AACD;;AAEDqF,EAAAA,eAAe,CAAC5D,SAAD,EAAY;AACzB,QAAIzB,UAAU,GAAG,KAAKF,KAAL,CAAWE,UAAX,CAAsB5B,MAAtB,CAA6B+J,CAAC,IAAIA,CAAC,IAAI1G,SAAvC,CAAjB;AACA,SAAKV,QAAL,CAAc;AAAEf,MAAAA,UAAF;AAAcI,MAAAA,aAAa,EAAE,KAA7B;AAAoCE,MAAAA,IAAI,EAAE;AAA1C,KAAd,EAFyB,CAEoC;;AAC7D5E,IAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAevB,UAAf,CAA7B;AACAtE,IAAAA,YAAY,CAAC,eAAD,CAAZ,GAAgC,KAAhC;AACAA,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuB,CAAvB;AACD;;AAED4J,EAAAA,cAAc,CAAC7D,SAAD,EAAY;AACxB,QAAIzB,UAAU,GAAG,CACf,GAAG,KAAKF,KAAL,CAAWE,UADC,CAAjB;AAIA,QAAI2J,gBAAgB,GAAG3J,UAAU,CAAC4J,OAAX,CAAmBnI,SAAnB,CAAvB;AACAzB,IAAAA,UAAU,CAAC6J,MAAX,CAAkBF,gBAAgB,GAAG,CAArC,EAAwC,CAAxC,oBACKlI,SADL;AAEEjC,MAAAA,EAAE,EAAEmC,IAAI,CAACC,GAAL,EAFN;AAGEQ,MAAAA,QAAQ,EAAE;AACR5B,QAAAA,CAAC,EAAEiB,SAAS,CAACW,QAAV,CAAmB5B,CAAnB,GAAuB,GADlB;AAERC,QAAAA,CAAC,EAAEgB,SAAS,CAACW,QAAV,CAAmB3B;AAFd;AAHZ;AAQA,QAAIqJ,iBAAiB,GAAGH,gBAAgB,GAAG,CAA3C;AAEA,SAAK5I,QAAL,CAAc;AAAEf,MAAAA,UAAF;AAAcI,MAAAA,aAAa,EAAE0J,iBAA7B;AAAgD9I,MAAAA,eAAe,EAAE8I,iBAAiB,GAAG;AAArF,KAAd;AACApO,IAAAA,YAAY,CAAC,eAAD,CAAZ,GAAgCoO,iBAAhC;AACApO,IAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAevB,UAAf,CAA7B;AACD;;AAED8E,EAAAA,4BAA4B,CAACU,UAAD,EAAauE,QAAb,EAAuB;AACjD,QAAI3J,aAAa,GAAG,KAAKN,KAAL,CAAWE,UAAX,CAAsB4J,OAAtB,CAA8BpE,UAA9B,CAApB;;AACA,QAAIpF,aAAa,IAAI,CAAC,CAAtB,EAAyB;AACvBA,MAAAA,aAAa,GAAG,KAAKN,KAAL,CAAWK,IAAX,CAAgByJ,OAAhB,CAAwBpE,UAAxB,CAAhB;AACA,UAAIpF,aAAa,IAAI,CAAC,CAAtB,EAAyBA,aAAa,IAAI,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAvC;AAC1B;;AACD,SAAKC,QAAL,CAAc;AACZX,MAAAA,aADY;AAEZE,MAAAA,IAAI,EAAE;AAFM,KAAd,EAGGyJ,QAHH;AAIArO,IAAAA,YAAY,CAAC,eAAD,CAAZ,GAAgC0E,aAAhC;AACA1E,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuB,CAAvB;AACD;;AAEDgK,EAAAA,aAAa,CAAC3C,GAAD,EAAMiF,QAAN,EAAgB;AAC3B,QAAIjF,GAAG,CAACiH,MAAJ,KAAe,IAAf,IAAuBhC,QAAQ,CAACgC,MAAT,KAAoBnK,SAA/C,EAA0D;AACxD9D,MAAAA,0BAA0B,CAAC,uCAAD,EAA0C,EAA1C,EAA8C,IAA9C,CAA1B;AACA;AACD;;AAED,UAAMoE,IAAI,GAAG,CAAC,GAAG,KAAKL,KAAL,CAAWK,IAAf,CAAb;AACA,UAAM8J,QAAQ,GAAG9J,IAAI,CAACyJ,OAAL,CAAa7G,GAAb,CAAjB;;AAEA,UAAMmH,UAAU,GAAG/J,IAAI,CAAC8J,QAAD,CAAJ,qBACdlH,GADc,MAEdiF,QAFc,CAAnB;;AAKAkC,IAAAA,UAAU,CAAClH,OAAX,GAAsB,yCAAwCkH,UAAU,CAACjH,KAAM,IAAGiH,UAAU,CAAChH,SAAX,IAAwB,QAAS,IAAGgH,UAAU,CAACnI,KAAX,IAAoB,CAAE,IAAGtH,CAAC,CAAC+H,MAAF,CAAS0H,UAAU,CAAChJ,aAApB,EAAmC5D,GAAnC,CAAuCmF,IAAI,IAAIA,IAAI,CAACjD,EAApD,EAAwDD,IAAxD,CAA6D,GAA7D,CAAkE,WAAU2K,UAAU,CAAC5J,IAAX,IAAmB,CAAE,EAAhP;AAEA,SAAKS,QAAL,CAAc;AACVZ,MAAAA,IAAI,EAAEA;AADI,KAAd;AAGAzE,IAAAA,YAAY,CAAC,MAAD,CAAZ,GAAuBuE,IAAI,CAACsB,SAAL,CAAepB,IAAf,CAAvB;AACD;;AAEDsF,EAAAA,mBAAmB,CAAChE,SAAD,EAAYuG,QAAZ,EAAsB;AACvC,QAAIvG,SAAS,CAACuI,MAAV,KAAqB,IAArB,IAA6BhC,QAAQ,CAACgC,MAAT,KAAoBnK,SAArD,EAAgE;AAC9D9D,MAAAA,0BAA0B,CAAC,6CAAD,EAAgD,EAAhD,EAAoD,IAApD,CAA1B;AACA;AACD;;AAED,UAAMiE,UAAU,GAAG,CAAC,GAAG,KAAKF,KAAL,CAAWE,UAAf,CAAnB;AACA,UAAMmK,cAAc,GAAGnK,UAAU,CAAC4J,OAAX,CAAmBnI,SAAnB,CAAvB;;AAEA,UAAMN,gBAAgB,GAAGnB,UAAU,CAACmK,cAAD,CAAV,qBACpB1I,SADoB,MAEpBuG,QAFoB,CAAzB;;AAKA,UAAMoC,gBAAgB,GAAG3P,CAAC,CAAC+H,MAAF,CAASrB,gBAAgB,CAACD,aAA1B,EACtB9C,MADsB,CACfqE,IAAI,IAAIA,IAAI,CAACjD,EAAL,KAAYiD,IAAI,CAACN,OAAL,KAAiBtC,SAAjB,IAA8B4C,IAAI,CAACN,OAA/C,CADO,EAEtB7E,GAFsB,CAElBmF,IAAI,IAAI;AACX,UAAI4H,SAAS,GAAG5H,IAAI,CAACjD,EAAL,IAAW,KAAX,IAAoBiD,IAAI,CAACjD,EAAL,IAAW,KAA/B,GAAwC,GAAEiD,IAAI,CAACjD,EAAG,IAAG2B,gBAAgB,CAACa,OAAQ,EAA9E,GAAkFS,IAAI,CAACjD,EAAvG;AACA,UAAIiD,IAAI,CAAC6H,GAAT,EAAcD,SAAS,GAAGA,SAAS,GAAG,GAAZ,GAAkB5H,IAAI,CAAC6H,GAAnC;AACd,aAAOD,SAAP;AACD,KANsB,CAAzB;;AAduC,UAsB/B3J,eAtB+B,GAsBX,KAAKZ,KAtBM,CAsB/BY,eAtB+B;AAuBvC,UAAM0D,WAAW,GAAI,GAAE1D,eAAe,CAAC2D,GAAhB,CAAoBC,CAAE,IAAG5D,eAAe,CAAC2D,GAAhB,CAAoBE,CAAE,IAAG7D,eAAe,CAAC2D,GAAhB,CAAoBG,CAAE,IAAG9D,eAAe,CAAC2D,GAAhB,CAAoBI,CAAE,EAAxH;AAEA,SAAK1D,QAAL,CAAc;AACVf,MAAAA,UAAU,EAAEA;AADF,KAAd;AAGAtE,IAAAA,YAAY,CAAC,YAAD,CAAZ,GAA6BuE,IAAI,CAACsB,SAAL,CAAevB,UAAf,CAA7B;AACD;;AAEDsB,EAAAA,eAAe,GAAG;AAChB,WAAO;AACL9B,MAAAA,EAAE,EAAEmC,IAAI,CAACC,GAAL,EADC;AAELC,MAAAA,IAAI,EAAE,WAFD;AAGLC,MAAAA,MAAM,EAAE,QAHH;AAILE,MAAAA,OAAO,EAAE,SAJJ;AAKLZ,MAAAA,IAAI,EAAE,IALD;AAMLd,MAAAA,IAAI,EAAE,CAND;AAOLyB,MAAAA,KAAK,EAAE,CAPF;AAQLE,MAAAA,QAAQ,EAAE,KARL;AASLC,MAAAA,UAAU,EAAE,KATP;AAULhB,MAAAA,aAAa,EAAE,EAVV;AAWLiB,MAAAA,OAAO,EAAE,IAXJ;AAYLC,MAAAA,QAAQ,EAAE;AAAC5B,QAAAA,CAAC,EAAE,CAAJ;AAAOC,QAAAA,CAAC,EAAE;AAAV,OAZL;AAaL+H,MAAAA,MAAM,EAAE;AAbH,KAAP;AAeD;;AAED+B,EAAAA,wBAAwB,CAAC5K,KAAD,EAAQ;AAC9B,QAAI,KAAKG,KAAL,CAAWM,aAAX,GAAyB,CAAzB,GAA6B,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAvD,EACE,KAAK4E,aAAL,CAAmB,KAAK5F,KAAL,CAAWK,IAAX,CAAgB,KAAKL,KAAL,CAAWM,aAAX,GAA2B,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAjE,CAAnB,EAA6FnB,KAA7F,EADF,KAGE,KAAK8F,mBAAL,CAAyB,KAAK3F,KAAL,CAAWE,UAAX,CAAsB,KAAKF,KAAL,CAAWM,aAAjC,CAAzB,EAA0ET,KAA1E;AACH;;AAED6K,EAAAA,YAAY,CAAEzK,WAAF,EAAe;AACzB,SAAKgB,QAAL,CAAc;AAAEhB,MAAAA;AAAF,KAAd;AACD;;AAEDgF,EAAAA,gBAAgB,CAAEtC,IAAF,EAAQ;AACtB,QAAIgI,kBAAkB,GAAG,IAAzB;AACA,QAAI,KAAK3K,KAAL,CAAWM,aAAX,GAAyB,CAAzB,GAA6B,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAvD,EAA+D2J,kBAAkB,GAAG,KAAK3K,KAAL,CAAWK,IAAX,CAAgB,KAAKL,KAAL,CAAWM,aAAX,GAA2B,KAAKN,KAAL,CAAWE,UAAX,CAAsBc,MAAjE,CAArB,CAA/D,KACK2J,kBAAkB,GAAG,KAAK3K,KAAL,CAAWE,UAAX,CAAsB,KAAKF,KAAL,CAAWM,aAAjC,CAArB;AAELqC,IAAAA,IAAI,CAAClG,MAAL,GAAcb,YAAY,CAAC,QAAD,CAA1B;AACA+G,IAAAA,IAAI,CAACjE,OAAL,GAAe9C,YAAY,CAAC,SAAD,CAA3B;;AAEA,QAAIwF,aAAa,qBACZuJ,kBAAkB,CAACvJ,aADP,CAAjB;;AAIA,QAAIuB,IAAI,CAACE,QAAT,EAAmB;AACjB,UAAIF,IAAI,CAACE,QAAL,CAAcC,WAAd,KAA8B,SAAlC,EAA6C;AAC3C,eAAO1B,aAAa,CAAC,KAAD,CAApB;AACA,eAAOA,aAAa,CAAC,QAAD,CAApB;AACD;AACF;;AAED,QAAIuB,IAAI,CAACiI,OAAT,EAAkB;AAChBjI,MAAAA,IAAI,qBAAQA,IAAR,CAAJ;AACA,aAAOA,IAAI,CAAC,SAAD,CAAX;AACD;;AAED,QAAIA,IAAI,CAACE,QAAT,EAAmB;AACjBzB,MAAAA,aAAa,CAACuB,IAAI,CAACE,QAAL,CAAcC,WAAf,CAAb,GAA2CH,IAA3C;AACD;;AACD,SAAKkI,WAAL,CAAiBzJ,aAAjB;AACD;;AAEDyE,EAAAA,eAAe,CAAElD,IAAF,EAAQ;AACrB,QAAIvB,aAAa,qBACZ,KAAKpB,KAAL,CAAWE,UAAX,CAAsB,KAAKF,KAAL,CAAWM,aAAjC,EAAgDc,aADpC,CAAjB;;AAGA,WAAOA,aAAa,CAACuB,IAAI,CAACE,QAAL,CAAcC,WAAf,CAApB;AACA,SAAK+H,WAAL,CAAiBzJ,aAAjB;AACD;;AAED2E,EAAAA,gBAAgB,GAAI;AAClB,QAAI3E,aAAa,GAAG,EAApB;AACA,SAAKyJ,WAAL,CAAiBzJ,aAAjB;AACD;;AAED0E,EAAAA,UAAU,CAAEnD,IAAF,EAAQuF,QAAR,EAAkB;AAC1B,QAAI9G,aAAa,qBACZ,KAAKpB,KAAL,CAAWE,UAAX,CAAsB,KAAKF,KAAL,CAAWM,aAAjC,EAAgDc,aADpC,CAAjB;;AAGAA,IAAAA,aAAa,CAACuB,IAAI,CAACE,QAAL,CAAcC,WAAf,CAAb,qBACKH,IADL,MAEKuF,QAFL;AAIA,SAAK2C,WAAL,CAAiBzJ,aAAjB;AACD;;AAEDyJ,EAAAA,WAAW,CAAEzJ,aAAF,EAAiB;AAC1BnC,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BkC,aAA3B;AACA,SAAKqJ,wBAAL,CAA8B;AAC5BrJ,MAAAA;AAD4B,KAA9B;AAGD;;AAED+E,EAAAA,aAAa,CAACvF,eAAD,EAAkBkK,KAAlB,EAAyB;AACpC,UAAMxG,WAAW,GAAI,GAAE1D,eAAe,CAAC2D,GAAhB,CAAoBC,CAAE,IAAG5D,eAAe,CAAC2D,GAAhB,CAAoBE,CAAE,IAAG7D,eAAe,CAAC2D,GAAhB,CAAoBG,CAAE,IAAG9D,eAAe,CAAC2D,GAAhB,CAAoBI,CAAE,EAAxH;AAEA,UAAMzE,UAAU,GAAG,KAAKF,KAAL,CAAWE,UAAX,CAAsB1C,GAAtB,CAA0B,CAACmE,SAAD,EAAYC,KAAZ,KAAsB;AACjE,YAAM0I,gBAAgB,GAAG3P,CAAC,CAAC+H,MAAF,CAASf,SAAS,CAACP,aAAnB,EACxB9C,MADwB,CACjBqE,IAAI,IAAIA,IAAI,CAACjD,EAAL,KAAYiD,IAAI,CAACN,OAAL,KAAiBtC,SAAjB,IAA8B4C,IAAI,CAACN,OAA/C,CADS,EAExB7E,GAFwB,CAEpBmF,IAAI,IAAI;AACX,YAAI4H,SAAS,GAAG5H,IAAI,CAACjD,EAAL,IAAW,KAAX,IAAoBiD,IAAI,CAACjD,EAAL,IAAW,KAA/B,GAAwC,GAAEiD,IAAI,CAACjD,EAAG,IAAGiC,SAAS,CAACO,OAAQ,EAAvE,GAA2ES,IAAI,CAACjD,EAAhG;AACA,YAAIiD,IAAI,CAAC6H,GAAT,EAAcD,SAAS,GAAGA,SAAS,GAAG,GAAZ,GAAkB5H,IAAI,CAAC6H,GAAnC;AACd,eAAOD,SAAP;AACD,OANwB,CAAzB;;AAQA,+BACK5I,SADL;AAGD,KAZkB,CAAnB;AAcA,SAAKV,QAAL,CAAc;AAAEL,MAAAA,eAAF;AAAmBV,MAAAA;AAAnB,KAAd;AACAtE,IAAAA,YAAY,CAAC,iBAAD,CAAZ,GAAkCuE,IAAI,CAACsB,SAAL,CAAeb,eAAf,CAAlC;AACD;;AAEDsF,EAAAA,eAAe,GAAG;AAChB,SAAKjF,QAAL,CAAc;AAAEJ,MAAAA,eAAe,EAAE;AAAnB,KAAd;AACD;;AAlqByB;;AAqqB5B,MAAMkK,uBAAuB,GAAG5P,MAAM,CAAC4P,uBAAvC;AACA,MAAMC,KAAK,GAAGD,uBAAuB,CAAC5P,MAAM,CAAC6P,KAAR,CAArC;AACA,MAAMC,MAAM,GAAG9P,MAAM,CAAC8P,MAAtB;;AAEA,MAAM7E,MAAM,GAAIvG,KAAD,IAAW;AAAA,QAChBvC,KADgB,GACyBuC,KADzB,CAChBvC,KADgB;AAAA,QACT4N,QADS,GACyBrL,KADzB,CACTqL,QADS;AAAA,QACCtJ,KADD,GACyB/B,KADzB,CACC+B,KADD;AAAA,QACWuJ,SADX,4BACyBtL,KADzB;;AAExB,SACE,oBAAC,SAAD;AACE,IAAA,SAAS,EAAC,mBADZ;AAEE,IAAA,OAAO,EAAEvC,KAFX;AAGE,IAAA,OAAO,EAAE4N,QAHX;AAIE,IAAA,SAAS,EAAC,KAJZ;AAKE,IAAA,KAAK,EAAE;AAACE,MAAAA,MAAM,EAAE,mBAAiB9N,KAAjB,GAAuB;AAAhC,KALT;AAME,IAAA,GAAG,EAAEsE,KANP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQE,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAEtE;AAAf,KAA0B6N,SAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KARF,CADF;AAYD,CAdD;;AAgBA,eAAevL,GAAf","sourcesContent":["import React, { Component } from 'react'\nimport './index.css'\nimport ItemListing from '../ItemListing'\nimport EquippedItems from '../EquippedItems'\nimport _ from 'lodash'\nimport CharacterList from '../CharacterList'\nimport 'react-notifications/lib/notifications.css'\nimport {NotificationContainer, NotificationManager} from 'react-notifications'\nimport RenderCanvas from '../RenderCanvas'\nimport axios from 'axios'\nimport VirtualizedSelect from 'react-virtualized-select'\n\nimport createFilterOptions from 'react-select-fast-filter-options'\nimport Slider from 'rc-slider'\nimport RcTooltip from 'rc-tooltip'\nimport { SketchPicker } from 'react-color'\nimport Localization from '../../const/localize'\nimport Localize from '../../const/localize'\nimport { Tooltip } from 'react-tippy'\nimport FontAwesome from 'react-fontawesome'\nimport 'rc-slider/assets/index.css'\nimport 'rc-tooltip/assets/bootstrap.css'\nimport 'react-tippy/dist/tippy.css';\nimport Toggle from 'react-toggle'\nimport Sidebar from \"react-sidebar\";\n\nif (localStorage['initialized'] != '2') {\n  localStorage['region'] = 'KMS'\n  localStorage['version'] = '328'\n  localStorage['initialized'] = '2'\n}\n\nif (!localStorage['language']) {\n  if (navigator.language.startsWith('ko')) localStorage['language'] = 'kr'\n  else if (navigator.language.startsWith('ja')) localStorage['language'] = 'jp'\n  else if (navigator.language.startsWith('zh')) localStorage['language'] = 'ch'\n  else if (navigator.language.startsWith('nl')) localStorage['language'] = 'nl'\n  else if (navigator.language.startsWith('pt')) localStorage['language'] = 'br'\n  else localStorage['language'] = 'en'\n}\n\nvar creatingId = null\nconst throttledErrorNotification = _.throttle(NotificationManager.error.bind(NotificationManager), 1500, { leading:true })\nlet mapsIndexed = null\nlet versions = {\n  GMS: [{region: \"GMS\", MapleVersionId: \"latest\", IsReady: true}],\n  KMS: [{region: \"KMS\", MapleVersionId: \"328\", IsReady: true}],\n  TMS: [{region: \"TMS\", MapleVersionId: \"latest\", IsReady: true}],\n  CMS: [{region: \"CMS\", MapleVersionId: \"latest\", IsReady: true}],\n  JMS: [{region: \"JMS\", MapleVersionId: \"latest\", IsReady: true}],\n  SEA: [{region: \"SEA\", MapleVersionId: \"latest\", IsReady: true}]\n}\n\nfunction toCamel(o) {\n  var newO, origKey, newKey, value\n  if (o instanceof Array) {\n    return o.map(function(value) {\n        if (typeof value === \"object\") {\n          value = toCamel(value)\n        }\n        return value\n    })\n  } else {\n    newO = {}\n    for (origKey in o) {\n      if (o.hasOwnProperty(origKey)) {\n        newKey = (origKey.charAt(0).toLowerCase() + origKey.slice(1) || origKey).toString()\n        value = o[origKey]\n        if (value instanceof Array || (value !== null && value.constructor === Object)) {\n          value = toCamel(value)\n        }\n        newO[newKey] = value\n      }\n    }\n  }\n  return newO\n}\n\nlet wzPromise = axios.get(`https://maplestory.io/api/wz?cache=false`)\n.then(response => {\n  let WZs = _.map(response.data.filter(wzEntry => wzEntry.isReady), wzEntry => {\n    return {\n      ...wzEntry,\n      region: wzEntry.region\n    }\n  })\n  versions = _.groupBy(WZs, 'region')\n\n  let region = localStorage['region'], version = localStorage['version']\n\n  if (!region || (version != '328' && _.findIndex(versions[region], ver => ver.mapleVersionId == version) == -1)) {\n    localStorage['region'] = 'KMS'\n    localStorage['version'] = '328'\n    window.location.reload()\n  }\n\n  console.log(versions);\n  return versions;\n})\n\nlet maps = []\nlet mapsFilter = null\nlet mapPromise = axios.get(`https://maplestory.io/api/KMS/328/map`).then(response => {\n      maps = _.map(response.data, map => {\n        return {\n          label: [map.streetName, map.name].join(' - '),\n          value: map.id\n        }\n      });\n      mapsFilter = createFilterOptions({options: maps})\n    });\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    let isOpen = (localStorage || {})['hideModal'] !== 'true'\n    if (isOpen === '' || isOpen === undefined || isOpen === 'undefined')\n      isOpen = true\n\n    // Try to recover any existing state\n    this.state = {\n      isModalOpen: isOpen,\n      characters: JSON.parse(localStorage['characters'] || 'false') || [false],\n      pets: JSON.parse(localStorage['pets'] || 'false') || [],\n      selectedIndex: JSON.parse(localStorage['selectedIndex'] || 'false') || 0,\n      selectedMap: JSON.parse(localStorage['selectedMap'] || 'false') || null,\n      zoom: JSON.parse(localStorage['zoom'] || 'false') || 1,\n      mapPosition: {x: 0, y: 0},\n      backgroundColor: JSON.parse(localStorage['backgroundColor'] || false) || {\"hsl\":{\"h\":0,\"s\":0,\"l\":0,\"a\":0},\"hex\":\"transparent\",\"rgb\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0},\"hsv\":{\"h\":0,\"s\":0,\"v\":0,\"a\":0},\"oldHue\":0,\"source\":\"rgb\"},\n      colorPickerOpen: false,\n      language: localStorage['language'] == 'undefined' ? 'en' : localStorage['language'],\n      music: false,\n      region: localStorage['region'] ? localStorage['region'] : 'KMS',\n      version: localStorage['version'] ? localStorage['version'] : '328',\n      sidebarOpen: true,\n      versions\n    }\n\n    if (versions.KMS.length > 1)\n      this.state.versions = versions\n    else\n      wzPromise.then(ver => this.setState({versions}))\n\n    if (this.state.selectedIndex < 0) this.state.selectedIndex = false;\n    this.state.focusRenderable = this.state.selectedIndex\n\n    // If we have a legacy character, upgrade to latest now\n    if (!_.isEmpty(this.state.selectedItems || {})) {\n      const currentCharacter = {\n        selectedItems: this.state.selectedItems,\n        skin: this.state.skin || 2000\n      }\n      if (this.state.characters[0] === false)\n        this.state.characters[0] = currentCharacter;\n      else\n        this.state.characters.push(currentCharacter)\n    }\n\n    // If we have no characters at all, gen a new shell\n    if (this.state.characters[0] === false)\n      this.state.characters[0] = this.getNewCharacter()\n\n    delete localStorage['selectedItems'];\n    delete localStorage['skin'];\n    delete localStorage['frame'];\n    delete localStorage['mercEars'];\n    delete localStorage['illiumEars'];\n\n    if (localStorage['currentCharacter']) {\n      this.state = JSON.parse(localStorage['currentCharacter'])\n      delete localStorage['currentCharacter']\n      localStorage['characters'] = JSON.stringify([...this.state.characters, this.state])\n      this.state['characters'] = [...this.state.characters, this.state]\n    }\n\n    this.state.characters.forEach((character, index) => {\n      if (!character.id) character.id = Date.now() + (index + 1)\n      character.type = 'character'\n      character.action = character.action || 'stand1'\n      character.frame = character.frame || 0\n      character.zoom = character.zoom || 1\n      character.emotion = character.emotion || 'default'\n      character.skin = character.skin || 2000\n      character.mercEars = character.mercEars || false\n      character.illiumEars = character.illiumEars || false\n      character.selectedItems = character.selectedItems || []\n      character.visible = character.visible || false\n      character.position = character.position || {x:0,y:0}\n      character.flipX = character.flipX || false;\n      character.name = character.name || '';\n      character.includeBackground = character.includeBackground === undefined ? true : character.includeBackground\n      let characterItems = _.values(toCamel(character.selectedItems)).map(item => {\n        if (!item.region) item.region = localStorage['region']\n        if (!item.version) item.version = localStorage['version']\n        return item\n      })\n      character.selectedItems = _.keyBy(characterItems, (item) => item.typeInfo.subCategory)\n      delete character.characters\n      delete character.otherCharacters\n      delete character.allCharacters\n    })\n\n    this.state.pets.forEach((pet, index) => {\n      if (!pet.id) pet.id = Date.now() + (index + 1)\n      pet.type = 'pet'\n      pet.position = pet.position || { x: 0, y: 0}\n      pet.summary = `https://maplestory.io/api/KMS/328/pet/${pet.petId}/${pet.animation || 'stand0'}/${pet.frame || 0}/${_.values(pet.selectedItems).map(item => item.id).join(',')}?resize=${pet.zoom || 1}`\n    })\n\n    if ((this.state.selectedIndex + 1) > (this.state.characters.length + this.state.pets.length) || !this.state.characters.length)\n      this.state.selectedIndex = false;\n\n\n    document.addEventListener(\"click\", this.handleClick.bind(this))\n\n    if (maps.length) this.state.mapsLoaded = true\n    else mapPromise.then(() => setTimeout(() => this.setState({mapsLoaded : true}), 250))\n    this.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\n  }\n\n  onSetSidebarOpen(open) {\n    this.setState({ sidebarOpen: open });\n  }\n\n  changeRegionVersion(region, version) {\n    localStorage['region'] = region\n    localStorage['version'] = version\n\n    // Much easier than trying to reload everything here :D\n    window.location.reload()\n  }\n\n  handleClick(e) {\n    let element = e.target\n    let found = false\n    while (this.state.colorPickerOpen && !found && (element = element.parentElement) != null) {\n      if (element.className != 'bg-color-picker-container') continue;\n      else {\n        found = true;\n        console.log('found bg-color-picker-container')\n      }\n    }\n\n    if (!found && this.state.colorPickerOpen) this.setState({ colorPickerOpen: false })\n  }\n\n\n  render() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language,\n      music\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n\n    const renderables = characters.concat(pets)\n\n    return (\n      <div className={\"App\"}>\n      <div className=\"App-header\">\n        <span className=\"logo\" onClick={() => this.onSetSidebarOpen(true)}>\n          &#9754;\n        </span>\n      </div>\n        <RenderCanvas\n          backgroundColor={bgColorText}\n          zoom={zoom}\n          mapId={selectedMap}\n          renderables={renderables}\n          selectedRenderable={selectedIndex}\n          focusRenderable={focusRenderable === undefined ? selectedIndex : focusRenderable}\n          onUpdateRenderable={this.updateRenderable.bind(this)}\n          onClick={this.clickCanvas.bind(this)}\n          localized={localized}\n          onClickRenderable={this.userUpdateSelectedRenderable.bind(this)}/>\n        { (selectedIndex !== false) ?\n          <Sidebar\n            sidebar={<ItemListing\n              target={renderables[selectedIndex]}\n              onItemSelected={this.userSelectedItem.bind(this)}\n              localized={localized} />}\n            open={this.state.sidebarOpen}\n            onSetOpen={this.onSetSidebarOpen}\n            styles={{  content: {\n            overflowY: 'auto'\n          } }}\n          ></Sidebar> : '' }\n        <CharacterList\n          renderables={renderables}\n          selectedIndex={selectedIndex}\n          onAddCharacter={this.addCharacter.bind(this)}\n          onAddPet={this.addPet.bind(this)}\n          onImportCharacter={this.importCharacter.bind(this)}\n          onDeleteCharacter={this.removeCharacter.bind(this)}\n          onCloneCharacter={this.cloneCharacter.bind(this)}\n          onDeletePet={this.removePet.bind(this)}\n          localized={localized}\n          onUpdateSelectedCharacter={function (renderable) {\n            this.userUpdateSelectedRenderable(renderable, () => {\n              this.setState({\n                focusRenderable: this.state.selectedIndex\n              })\n            })\n          }.bind(this)}\n          onUpdateCharacter={this.userUpdateCharacter.bind(this)}\n          onUpdatePet={this.userUpdatePet.bind(this) }/>\n        {\n          (selectedIndex !== false && !_.isEmpty(renderables[selectedIndex].selectedItems) ? <EquippedItems\n            equippedItems={renderables[selectedIndex].selectedItems}\n            onRemoveItem={this.userRemovedItem.bind(this)}\n            name={renderables[selectedIndex].name}\n            skinId={renderables[selectedIndex].skin}\n            onUpdateItem={this.updateItem.bind(this)}\n            localized={localized}\n            onRemoveItems={this.userRemovedItems.bind(this)} /> : '')\n        }\n        <div className=\"disclaimer\"><div>{localized.prototype}</div></div>\n\n        <NotificationContainer />\n        { music ? <audio src={`//maplestory.io/api/KMS/328/map/${selectedMap}/bgm`} autoPlay={true} loop={true} /> : '' }\n      </div>\n    )\n  }\n\n  renderSettings() {\n    const {\n      characters,\n      pets,\n      selectedIndex,\n      isModalOpen,\n      zoom,\n      summary,\n      selectedMap,\n      focusRenderable,\n      backgroundColor,\n      colorPickerOpen,\n      language\n    } = this.state\n\n    const localized = Localize.getLocalized(language)\n\n    const bgColorText = `rgba(${backgroundColor.rgb.r}, ${backgroundColor.rgb.g}, ${backgroundColor.rgb.b}, ${backgroundColor.rgb.a})`\n    return (\n      <div className='settings-container'>\n        <label className='bg-color-picker-container' onClick={this.openColorPicker.bind(this)}>\n        Background color\n          <div className='bg-color-picker'>\n            <div className='bg-color-grid' style={{ backgroundColor: bgColorText }}></div>\n          </div>\n          { colorPickerOpen ? <SketchPicker color={bgColorText} onChange={this.onChangeColor.bind(this)} /> : '' }\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.zoom}</span>\n          <Slider\n            value={zoom || 1}\n            min={0.25}\n            max={2}\n            step={0.25}\n            handle={handle}\n            onChange={this.changeZoom.bind(this)} />\n        </label>\n        <label className='canvas-zoom'>\n          <span>{localized.language}</span>\n          <select value={this.state.language} onChange={this.changeLanguage.bind(this)}>\n            <option value='en'>English</option>\n            <option value='jp'>Japanese</option>\n            <option value='kr'>Korean</option>\n            <option value='ch'>Chinese (Traditional)</option>\n            <option value='nl'>Dutch</option>\n            <option value='br'>Portuguese (Brazil)</option>\n          </select>\n        </label>\n        <div>\n          <div className='map-select-container'>\n            <VirtualizedSelect\n              filterOptions={mapsFilter}\n              isLoading={maps.length === 0}\n              name='map-selection'\n              searchable\n              clearable\n              simpleValue\n              value={selectedMap}\n              onChange={this.selectMap.bind(this)}\n              options={maps}\n              maxHeight={400}\n              styles={{\n                menuList: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                },\n                menu: (styles, {data}) => {\n                  return {\n                    ...styles,\n                    height: '400px'\n                  }\n                }\n              }}\n              />\n          </div>\n        </div>\n        <label>\n          <span>{localized.region}</span>\n          <select value={this.state.region} onChange={(e) => this.changeRegionVersion(e.target.value, \"328\")}>\n            { _.keys(this.state.versions).map(versionName => <option value={versionName} key={versionName}>{versionName}</option>) }\n          </select>\n        </label>\n        <label>\n          <span>{localized.version}</span>\n          <select value={this.state.version} onChange={(e) => this.changeRegionVersion(this.state.region, e.target.value)}>\n            { this.state.versions[this.state.region].map(({mapleVersionId}) => <option value={mapleVersionId} key={mapleVersionId}>{mapleVersionId}</option>) }\n            <option value='328' key='328'>328</option>\n          </select>\n        </label>\n        <label>\n          <span>{localized.playMusic}</span>\n          <Toggle\n            onChange={this.toggleMusic.bind(this)}\n            checked={this.state.music} />\n        </label>\n        <label>\n          <a href='#' onClick={this.exportAllCharacters.bind(this)}>Export All Characters</a>\n        </label>\n      </div>\n    )\n  }\n\n  toggleMusic(e) {\n    this.setState({\n      music: !this.state.music\n    })\n  }\n\n  exportAllCharacters() {\n    this.state.characters.forEach(character => {\n      const a = document.createElement('a')\n      a.style = 'display: none;'\n      document.body.appendChild(a)\n\n      const payload = JSON.stringify(character, null, 2),\n        blob = new Blob([payload], {type: 'octet/stream'}),\n        url = window.URL.createObjectURL(blob)\n      a.href = url\n      if (character.name)\n        a.download = character.name + '-data.json'\n      else\n        a.download = 'character-data.json'\n      a.click()\n\n      window.URL.revokeObjectURL(url)\n      a.remove()\n    })\n  }\n\n  changeLanguage(e) {\n    this.setState({\n      language: e.target.value\n    })\n    localStorage['language'] = e.target.value\n  }\n\n  changeZoom(newZoom) {\n    this.setState({ zoom: newZoom })\n    localStorage['zoom'] = newZoom\n  }\n\n  selectMap(mapId) {\n    this.setState({\n      selectedMap: mapId\n    })\n    localStorage['selectedMap'] = mapId\n  }\n\n  updateRenderable(renderable, newProps) {\n    if (renderable.type == 'pet') this.userUpdatePet(renderable, newProps)\n    if (renderable.type == 'character' || renderable.type === undefined) this.userUpdateCharacter(renderable, newProps)\n  }\n\n  clickCanvas(e) {\n    if (e.target === e.currentTarget && (this.state.characters.length + this.state.pets.length) > 1) {\n      this.setState({ selectedIndex: false })\n      localStorage['selectedIndex'] = 'false'\n    }\n  }\n\n  addPet() {\n    var pets = [...(this.state.pets || []), this.getNewPet()]\n    this.setState({pets, selectedIndex: this.state.characters.length + this.state.pets.length})\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  removePet(pet) {\n    var pets = this.state.pets.filter(c => c != pet)\n    this.setState({ pets, selectedIndex: false, zoom: 1 }) // Unselect any pet in case we delete the last pet\n    localStorage['pets'] = JSON.stringify(pets)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  getNewPet() {\n    const andysFavePetIds = [5000000, 5000001, 5000002, 5000003, 5000004, 5000005]\n    const petId = andysFavePetIds[Math.floor(Math.random() * andysFavePetIds.length)]\n    return {\n      petId,\n      selectedItems: [],\n      id: Date.now(),\n      type: 'pet',\n      summary: `https://maplestory.io/api/KMS/328/pet/${petId}/stand0`,\n      animation: 'stand0',\n      visible: true,\n      frame: 0,\n      zoom: 1,\n      fhSnap: true,\n      position: { x:0, y:0 }\n    }\n  }\n\n  importCharacter(e) {\n    let target = e.target\n    let importAll = Array.prototype.map.call(target.files, file => {\n      return new Promise((res, rej) => {\n        let extension = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase()\n        if (extension != 'json') {\n          console.warn('Not valid JSON file')\n          return\n        }\n\n        let reader = new FileReader()\n        reader.onload = function (ev) {\n          let payload = ev.target.result\n          let data = JSON.parse(payload)\n\n          res()\n          if (!data.id || data.type != 'character' || !data.selectedItems) return\n\n          data.id = Date.now()\n\n          let characters = [\n            ...this.state.characters,\n            data\n          ]\n          this.setState({\n            characters,\n            selectedIndex: this.state.characters.length\n          })\n          localStorage['characters'] = JSON.stringify(characters)\n        }.bind(this)\n\n        reader.readAsText(file, 'UTF8')\n      })\n    })\n\n    Promise.all(importAll).then(() => {\n      target.value = ''\n    })\n  }\n\n  addCharacter() {\n    var characters = [ ...this.state.characters, this.getNewCharacter() ]\n    this.setState({ characters, selectedIndex: this.state.characters.length })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  removeCharacter(character) {\n    var characters = this.state.characters.filter(c => c != character)\n    this.setState({ characters, selectedIndex: false, zoom: 1 }) // Unselect any character in case we delete the last character\n    localStorage['characters'] = JSON.stringify(characters)\n    localStorage['selectedIndex'] = false\n    localStorage['zoom'] = 1\n  }\n\n  cloneCharacter(character) {\n    let characters = [\n      ...this.state.characters\n    ]\n\n    let indexOfCharacter = characters.indexOf(character)\n    characters.splice(indexOfCharacter + 1, 0, {\n      ...character,\n      id: Date.now(),\n      position: {\n        x: character.position.x + 100,\n        y: character.position.y\n      }\n    })\n    let newCharacterIndex = indexOfCharacter + 1\n\n    this.setState({ characters, selectedIndex: newCharacterIndex, focusRenderable: newCharacterIndex + 1 })\n    localStorage['selectedIndex'] = newCharacterIndex\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  userUpdateSelectedRenderable(renderable, callback) {\n    let selectedIndex = this.state.characters.indexOf(renderable)\n    if (selectedIndex == -1) {\n      selectedIndex = this.state.pets.indexOf(renderable)\n      if (selectedIndex != -1) selectedIndex += this.state.characters.length\n    }\n    this.setState({\n      selectedIndex,\n      zoom: 1\n    }, callback)\n    localStorage['selectedIndex'] = selectedIndex\n    localStorage['zoom'] = 1\n  }\n\n  userUpdatePet(pet, newProps) {\n    if (pet.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Pet is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const pets = [...this.state.pets]\n    const petIndex = pets.indexOf(pet)\n\n    const currentPet = pets[petIndex] = {\n      ...pet,\n      ...newProps\n    }\n\n    currentPet.summary = `https://maplestory.io/api/KMS/328/pet/${currentPet.petId}/${currentPet.animation || 'stand0'}/${currentPet.frame || 0}/${_.values(currentPet.selectedItems).map(item => item.id).join(',')}?resize=${currentPet.zoom || 1}`\n\n    this.setState({\n        pets: pets\n    })\n    localStorage['pets'] = JSON.stringify(pets)\n  }\n\n  userUpdateCharacter(character, newProps) {\n    if (character.locked === true && newProps.locked === undefined) {\n      throttledErrorNotification('Character is locked and can not be modified', '', 1000)\n      return;\n    }\n\n    const characters = [...this.state.characters]\n    const characterIndex = characters.indexOf(character)\n\n    const currentCharacter = characters[characterIndex] = {\n      ...character,\n      ...newProps\n    }\n\n    const itemsWithEmotion = _.values(currentCharacter.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${currentCharacter.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n    const { backgroundColor } = this.state\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    this.setState({\n        characters: characters\n    })\n    localStorage['characters'] = JSON.stringify(characters)\n  }\n\n  getNewCharacter() {\n    return {\n      id: Date.now(),\n      type: 'character',\n      action: 'stand1',\n      emotion: 'default',\n      skin: 2000,\n      zoom: 1,\n      frame: 0,\n      mercEars: false,\n      illiumEars: false,\n      selectedItems: [],\n      visible: true,\n      position: {x: 0, y: 0},\n      fhSnap: true\n    }\n  }\n\n  updateSelectedRenderable(props) {\n    if (this.state.selectedIndex+1 > this.state.characters.length)\n      this.userUpdatePet(this.state.pets[this.state.selectedIndex - this.state.characters.length], props)\n    else\n      this.userUpdateCharacter(this.state.characters[this.state.selectedIndex], props)\n  }\n\n  setModalOpen (isModalOpen) {\n    this.setState({ isModalOpen })\n  }\n\n  userSelectedItem (item) {\n    let selectedRenderable = null\n    if (this.state.selectedIndex+1 > this.state.characters.length) selectedRenderable = this.state.pets[this.state.selectedIndex - this.state.characters.length]\n    else selectedRenderable = this.state.characters[this.state.selectedIndex]\n\n    item.region = localStorage['region']\n    item.version = localStorage['version']\n\n    let selectedItems = {\n      ...selectedRenderable.selectedItems,\n    }\n\n    if (item.typeInfo) {\n      if (item.typeInfo.subCategory === 'Overall') {\n        delete selectedItems['Top']\n        delete selectedItems['Bottom']\n      }\n    }\n\n    if (item.similar) {\n      item = { ...item }\n      delete item['similar']\n    }\n\n    if (item.typeInfo) {\n      selectedItems[item.typeInfo.subCategory] = item\n    }\n    this.updateItems(selectedItems)\n  }\n\n  userRemovedItem (item) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    delete selectedItems[item.typeInfo.subCategory]\n    this.updateItems(selectedItems);\n  }\n\n  userRemovedItems () {\n    let selectedItems = {}\n    this.updateItems(selectedItems);\n  }\n\n  updateItem (item, newProps) {\n    let selectedItems = {\n      ...this.state.characters[this.state.selectedIndex].selectedItems,\n    }\n    selectedItems[item.typeInfo.subCategory] = {\n      ...item,\n      ...newProps\n    }\n    this.updateItems(selectedItems);\n  }\n\n  updateItems (selectedItems) {\n    console.log('New Items: ', selectedItems)\n    this.updateSelectedRenderable({\n      selectedItems\n    })\n  }\n\n  onChangeColor(backgroundColor, event) {\n    const bgColorText = `${backgroundColor.rgb.r},${backgroundColor.rgb.g},${backgroundColor.rgb.b},${backgroundColor.rgb.a}`\n\n    const characters = this.state.characters.map((character, index) => {\n      const itemsWithEmotion = _.values(character.selectedItems)\n      .filter(item => item.id && (item.visible === undefined || item.visible))\n      .map(item => {\n        var itemEntry = item.id >= 20000 && item.id <= 29999 ? `${item.id}:${character.emotion}` : item.id\n        if (item.hue) itemEntry = itemEntry + ';' + item.hue\n        return itemEntry\n      });\n\n      return {\n        ...character\n      }\n    });\n\n    this.setState({ backgroundColor, characters })\n    localStorage['backgroundColor'] = JSON.stringify(backgroundColor)\n  }\n\n  openColorPicker() {\n    this.setState({ colorPickerOpen: true })\n  }\n}\n\nconst createSliderWithTooltip = Slider.createSliderWithTooltip;\nconst Range = createSliderWithTooltip(Slider.Range);\nconst Handle = Slider.Handle;\n\nconst handle = (props) => {\n  const { value, dragging, index, ...restProps } = props;\n  return (\n    <RcTooltip\n      prefixCls=\"rc-slider-tooltip\"\n      overlay={value}\n      visible={dragging}\n      placement=\"top\"\n      style={{border: \"solid 2px hsl(\"+value+\", 53%, 53%)\"}}\n      key={index}\n    >\n      <Handle value={value} {...restProps} />\n    </RcTooltip>\n  );\n};\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}